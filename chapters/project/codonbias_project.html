<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>22&nbsp; Codon usage â€“ Bioinformatics and Programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/project/hiv_project.html" rel="next">
<link href="../../chapters/project/alignment_project.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/downloadthis-1.9.1/downloadthis.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/project/translation_project.html">Python projects</a></li><li class="breadcrumb-item"><a href="../../chapters/project/codonbias_project.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Codon usage</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Content</a> 
        <div class="sidebar-tools-main">
    <a href="../../Bioinformatics-and-Programming.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../curriculum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Curriculum</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../weekplan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Learning Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/before_you_begin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Before you begin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/appendix_conda_and_pymol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Appendix: Conda environment for BSF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/writing_a_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing a program</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dealing_with_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dealing with values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/the_order_of_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The order of events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/course_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Course tools</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/controlling_behavior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Controlling behavior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/organizing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Organizing code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/python_values_are_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Values are objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Lists of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dictionaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pairs of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/gluing_values_in_sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grouping values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/iteration_over_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Iterating values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/working_with_data_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Structuring data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/unleash_your_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recursion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/testing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Testing your code</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Python projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/translation_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Translating ORFs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/folding_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Primer analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/alignment_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Pairwise alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/codonbias_project.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Codon usage</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/hiv_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">HIV sub-groups</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/seqdist_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Sequence trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/orf_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Finding genes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/assembly_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Genome assembly</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Web exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/gwas_databases/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">GWAS candidates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/ccr5_pwalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">CCR5-delta32</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/mrsa_blast_multalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">MRSA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/aardwark_seqdist/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Aardvark?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/orf_finding/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Plasmid ORFs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/long_reads/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Read mapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/neural_networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Supplementary</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/project_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/recordings2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture recordings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/slides2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/bioinformatics_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Databases and resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exam info</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#read-an-open-reading-frame-and-count-its-codons" id="toc-read-an-open-reading-frame-and-count-its-codons" class="nav-link active" data-scroll-target="#read-an-open-reading-frame-and-count-its-codons">Read an open reading frame and count its codons</a>
  <ul class="collapse">
  <li><a href="#read-orfs-from-a-file" id="toc-read-orfs-from-a-file" class="nav-link" data-scroll-target="#read-orfs-from-a-file">Read ORFs from a file</a></li>
  <li><a href="#split-the-orf-into-codons" id="toc-split-the-orf-into-codons" class="nav-link" data-scroll-target="#split-the-orf-into-codons">Split the ORF into codons</a></li>
  <li><a href="#count-codons-in-an-orf" id="toc-count-codons-in-an-orf" class="nav-link" data-scroll-target="#count-codons-in-an-orf">Count codons in an ORF</a></li>
  </ul></li>
  <li><a href="#group-codon-counts-by-amino-acid" id="toc-group-codon-counts-by-amino-acid" class="nav-link" data-scroll-target="#group-codon-counts-by-amino-acid">Group codon counts by amino acid</a></li>
  <li><a href="#turn-counts-into-frequencies" id="toc-turn-counts-into-frequencies" class="nav-link" data-scroll-target="#turn-counts-into-frequencies">Turn counts into frequencies</a></li>
  <li><a href="#compute-the-codon-usage" id="toc-compute-the-codon-usage" class="nav-link" data-scroll-target="#compute-the-codon-usage">Compute the codon usage</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/project/translation_project.html">Python projects</a></li><li class="breadcrumb-item"><a href="../../chapters/project/codonbias_project.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Codon usage</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-codonbiasproject" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Codon usage</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Codon usage bias refers to differences in the frequency of occurrence of synonymous codons in coding DNA. There are 64 different codons (61 codons encoding for amino acids plus 3 stop codons) but only 20 different translated amino acids. The overabundance in the number of codons allows many amino acids to be encoded by more than one codon. Because of such redundancy, it is said that the genetic code is degenerate. Different organisms often show particular preferences for one of the several codons that encode the same amino acid, that is, a greater frequency of one will be found than expected by chance. How such preferences arise is a much-debated area of molecular evolution.</p>
<p>Given an open reading frame (ORF), you must compute the codon usage. Your goal is to create a data structure where you can look up an amino acid and the frequencies of codons in that encode that amino acid the ORF. Here is a made-up example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'A'</span>: {<span class="st">'GCA'</span>: <span class="fl">0.0</span>, <span class="st">'GCC'</span>: <span class="fl">0.0</span>, <span class="st">'GCT'</span>: <span class="fl">1.0</span>, <span class="st">'GCG'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'C'</span>: {<span class="st">'TGC'</span>: <span class="fl">0.0</span>, <span class="st">'TGT'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'E'</span>: {<span class="st">'GAG'</span>: <span class="fl">0.2</span>, <span class="st">'GAA'</span>: <span class="fl">0.8</span>}, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'D'</span>: {<span class="st">'GAT'</span>: <span class="fl">1.0</span>, <span class="st">'GAC'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'G'</span>: {<span class="st">'GGT'</span>: <span class="fl">0.3</span>, <span class="st">'GGG'</span>: <span class="fl">0.0</span>, <span class="st">'GGA'</span>: <span class="fl">0.7</span>, <span class="st">'GGC'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'F'</span>: {<span class="st">'TTC'</span>: <span class="fl">0.0</span>, <span class="st">'TTT'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'I'</span>: {<span class="st">'ATT'</span>: <span class="fl">1.0</span>, <span class="st">'ATC'</span>: <span class="fl">0.0</span>, <span class="st">'ATA'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'H'</span>: {<span class="st">'CAC'</span>: <span class="fl">0.0</span>, <span class="st">'CAT'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'K'</span>: {<span class="st">'AAG'</span>: <span class="fl">0.2</span>, <span class="st">'AAA'</span>: <span class="fl">0.8</span>}, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'*'</span>: {<span class="st">'TAG'</span>: <span class="fl">0.0</span>, <span class="st">'TGA'</span>: <span class="fl">1.0</span>, <span class="st">'TAA'</span>: <span class="fl">0.0</span>}, <span class="st">'M'</span>: {<span class="st">'ATG'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'L'</span>: {<span class="st">'CTT'</span>: <span class="fl">0.0</span>, <span class="st">'CTG'</span>: <span class="fl">0.6</span>, <span class="st">'CTA'</span>: <span class="fl">0.0</span>, <span class="st">'CTC'</span>:<span class="fl">0.0</span>, <span class="st">'TTA'</span>: <span class="fl">0.4</span>, <span class="st">'TTG'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a> <span class="st">'N'</span>: {<span class="st">'AAT'</span>: <span class="fl">0.5</span>, <span class="st">'AAC'</span>: <span class="fl">0.5</span>}, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> <span class="st">'Q'</span>: {<span class="st">'CAA'</span>: <span class="fl">0.6</span>, <span class="st">'CAG'</span>: <span class="fl">0.4</span>}, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> <span class="st">'P'</span>: {<span class="st">'CCT'</span>: <span class="fl">0.5</span>, <span class="st">'CCG'</span>: <span class="fl">0.0</span>, <span class="st">'CCA'</span>: <span class="fl">0.5</span>, <span class="st">'CCC'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="st">'S'</span>: {<span class="st">'TCT'</span>: <span class="fl">0.0</span>, <span class="st">'AGC'</span>: <span class="fl">0.0</span>, <span class="st">'TCG'</span>: <span class="fl">0.0</span>, <span class="st">'AGT'</span>: <span class="fl">0.5</span>, <span class="st">'TCC'</span>: <span class="fl">0.0</span>, <span class="st">'TCA'</span>: <span class="fl">0.5</span>}, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a> <span class="st">'R'</span>: {<span class="st">'CGA'</span>: <span class="fl">0.5</span>, <span class="st">'CGC'</span>: <span class="fl">0.0</span>, <span class="st">'AGA'</span>: <span class="fl">0.5</span>, <span class="st">'AGG'</span>: <span class="fl">0.0</span>, <span class="st">'CGG'</span>: <span class="fl">0.0</span>, <span class="st">'CGT'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a> <span class="st">'T'</span>: {<span class="st">'ACC'</span>: <span class="fl">0.0</span>, <span class="st">'ACA'</span>: <span class="fl">0.0</span>, <span class="st">'ACG'</span>: <span class="fl">0.0</span>, <span class="st">'ACT'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a> <span class="st">'W'</span>: {<span class="st">'TGG'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a> <span class="st">'V'</span>: {<span class="st">'GTA'</span>: <span class="fl">0.6</span>, <span class="st">'GTC'</span>: <span class="fl">0.0</span>, <span class="st">'GTT'</span>: <span class="fl">0.2</span>, <span class="st">'GTG'</span>: <span class="fl">0.2</span>}, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a> <span class="st">'Y'</span>: {<span class="st">'TAT'</span>: <span class="fl">1.0</span>, <span class="st">'TAC'</span>: <span class="fl">0.0</span>}}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>That data structure is a dictionary with keys corresponding to amino acids (i.e.&nbsp;single letter strings designating an amino acid such as <code>'R'</code> for arginine). The value associated with <em>each</em> amino acid key is also a dictionary, and the keys of <em>this</em> dictionary should be the different codons that encode the amino acid. The value associated with each codon key should be a number, representing the frequency with which that codon is used to encode that amino acid. The final data structure should only include amino acids that are found in the ORF.</p>
<p>Download the files you need for this project:</p>
<p><a href="#dnldts24509" onclick="fetch('data:application/x-python;base64,CmNvZG9uX21hcCA9IHsnVFRUJzogJ0YnLCAnVFRDJzogJ0YnLCAnVFRBJzogJ0wnLCAnVFRHJzogJ0wnLAogICAgICAgICAgICAgJ1RDVCc6ICdTJywgJ1RDQyc6ICdTJywgJ1RDQSc6ICdTJywgJ1RDRyc6ICdTJywgCiAgICAgICAgICAgICAnVEFUJzogJ1knLCAnVEFDJzogJ1knLCAnVEFBJzogJyonLCAnVEFHJzogJyonLCAKICAgICAgICAgICAgICdUR1QnOiAnQycsICdUR0MnOiAnQycsICdUR0EnOiAnKicsICdUR0cnOiAnVycsIAogICAgICAgICAgICAgJ0NUVCc6ICdMJywgJ0NUQyc6ICdMJywgJ0NUQSc6ICdMJywgJ0NURyc6ICdMJywKICAgICAgICAgICAgICdDQ1QnOiAnUCcsICdDQ0MnOiAnUCcsICdDQ0EnOiAnUCcsICdDQ0cnOiAnUCcsIAogICAgICAgICAgICAgJ0NBVCc6ICdIJywgJ0NBQyc6ICdIJywgJ0NBQSc6ICdRJywgJ0NBRyc6ICdRJywgCiAgICAgICAgICAgICAnQ0dUJzogJ1InLCAnQ0dDJzogJ1InLCAnQ0dBJzogJ1InLCAnQ0dHJzogJ1InLCAKICAgICAgICAgICAgICdBVFQnOiAnSScsICdBVEMnOiAnSScsICdBVEEnOiAnSScsICdBVEcnOiAnTScsIAogICAgICAgICAgICAgJ0FDVCc6ICdUJywgJ0FDQyc6ICdUJywgJ0FDQSc6ICdUJywgJ0FDRyc6ICdUJywgCiAgICAgICAgICAgICAnQUFUJzogJ04nLCAnQUFDJzogJ04nLCAnQUFBJzogJ0snLCAnQUFHJzogJ0snLCAKICAgICAgICAgICAgICdBR1QnOiAnUycsICdBR0MnOiAnUycsICdBR0EnOiAnUicsICdBR0cnOiAnUicsIAogICAgICAgICAgICAgJ0dUVCc6ICdWJywgJ0dUQyc6ICdWJywgJ0dUQSc6ICdWJywgJ0dURyc6ICdWJywgCiAgICAgICAgICAgICAnR0NUJzogJ0EnLCAnR0NDJzogJ0EnLCAnR0NBJzogJ0EnLCAnR0NHJzogJ0EnLCAKICAgICAgICAgICAgICdHQVQnOiAnRCcsICdHQUMnOiAnRCcsICdHQUEnOiAnRScsICdHQUcnOiAnRScsIAogICAgICAgICAgICAgJ0dHVCc6ICdHJywgJ0dHQyc6ICdHJywgJ0dHQSc6ICdHJywgJ0dHRyc6ICdHJ30KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBXcml0ZSB5b3VyIGZ1bmN0aW9ucyBkZWZpbml0aW9ucyBiZWxvdy4KIyBEbyBub3Qgd3JpdGUgYW55IG90aGVyIGNvZGUgaGVyZS4KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyBvbmx5IHlvdXIgZnVuY3Rpb24gZGVmaW5pdGlvbnMuLi4KCgoKCgoKCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIENvZGUgZm9yIGNhbGxpbmcgYW5kIHRlc3RpbmcgeW91ciBmdW5jdGlvbnMgc2hvdWxkIGJlIGJlbG93CiMgaGVyZS4gSWYgeW91IHNlcGFyYXRlIGZ1bmN0aW9uIGRlZmluaXRpb25zIGZyb20gdGhlIHJlc3Qgb2YKIyB5b3VyIHNjcmlwdCBpbiB0aGlzIHdheSwgeW91IGFyZSBsZXNzIGxpa2VseSB0byBtYWtlIG1pc3Rha2VzLgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojIGFueSBvdGhlciBjb2RlIC4uLgoKCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'codonbiasproject.py'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-light downloadthis  " id="dnldts24509"><i class="bi bi-download"></i> codonbiasproject.py </button></a> <a href="#dnldts23588" onclick="fetch('data:application/x-python;base64,aW1wb3J0IGluc3BlY3QKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IG9zLnBhdGgKaW1wb3J0IHVuaXR0ZXN0CmZyb20gdW5pdHRlc3QgaW1wb3J0IFRlc3RSZXN1bHQsIFRleHRUZXN0UnVubmVyLCBUZXN0TG9hZGVyCmZyb20gY29udGV4dGxpYiBpbXBvcnQgcmVkaXJlY3Rfc3Rkb3V0CmZyb20gaW8gaW1wb3J0IFN0cmluZ0lPCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHJlCgpHUkFERV9NT0RFID0gb3MuZ2V0ZW52KCdHUkFERV9NT0RFJykKClBST0pFQ1RfTkFNRSA9IG9zLnBhdGguc3BsaXRleHQob3MucGF0aC5iYXNlbmFtZShfX2ZpbGVfXykpWzBdLnJlcGxhY2UoJ3Rlc3RfJywgJycpCgpjbGFzcyBOdWxsRGV2aWNlOgoKICAgIGRlZiB3cml0ZShzZWxmLCBzKToKICAgICAgICBwYXNzCgojIFJlZGlyZWN0IGFsbCBzdGRvdXQgZnJvbSB0aGUgaW1wb3J0ZWQgbW9kdWxlIHRvIGEgbnVsbCBkZXZpY2UgdG8gbm90IGNvbmZ1c2UKIyB0aGUgc3R1ZGVudCB0b28gbXVjaC4uLgp0cnk6CiAgICB3aXRoIHJlZGlyZWN0X3N0ZG91dChOdWxsRGV2aWNlKCkpOgogICAgICAgICMgaW1wb3J0IHByb2dleGFtIGFzIHByb2plY3QKICAgICAgIHByb2plY3QgPSBfX2ltcG9ydF9fKFBST0pFQ1RfTkFNRSkKZXhjZXB0OgogICAgcHJpbnQoIllPVVIgQ09ERSBDQU5OT1QgQkUgUlVOOlxuXG5IZXJlIGlzIHRoZSBlcnJvcjpcbiIpCiAgICB0cmFjZWJhY2sucHJpbnRfZXhjKGZpbGU9c3lzLnN0ZG91dCkKICAgIHByaW50KCJcbkZJWCBUSEFUIEZJUlNUIEJFRk9SRSBZT1UgVVNFIFRIRSBURVNUIFNDUklQVCIpCiAgICBzeXMuZXhpdCg5OSkKCgphc3NlcnRpb25fbXNnID0gIiIiVGhlIGNhbGw6CgogICAge2Z1bmN9KHthcmdzfSkKCnJldHVybmVkOgoKICAgIHthY3R1YWx9CgpIb3dldmVyLCBpdCBzaG91bGQgcmV0dXJuOgoKICAgIHtleHBlY3RlZH0KIiIiCgoKZGVmIHN1aXRlRmFjdG9yeSgqdGVzdGNhc2VzKToKCiAgICBsbiAgICA9IGxhbWJkYSBmOiBnZXRhdHRyKHRjLCBmKS5fX2NvZGVfXy5jb19maXJzdGxpbmVubwogICAgbG5jbXAgPSBsYW1iZGEgYSwgYjogbG4oYSkgLSBsbihiKQoKICAgIHRlc3Rfc3VpdGUgPSB1bml0dGVzdC5UZXN0U3VpdGUoKQogICAgdGVzdF9sb2FkZXIgPSBUZXN0TG9hZGVyKCkKICAgIHRlc3RfbG9hZGVyLnNvcnRUZXN0TWV0aG9kc1VzaW5nID0gbG5jbXAKICAgIGZvciB0YyBpbiB0ZXN0Y2FzZXM6CiAgICAgICAgdGVzdF9zdWl0ZS5hZGRUZXN0KHRlc3RfbG9hZGVyLmxvYWRUZXN0c0Zyb21UZXN0Q2FzZSh0YykpCgogICAgcmV0dXJuIHRlc3Rfc3VpdGUKCgpkZWYgY2FzZUZhY3RvcnkoKToKICAgIGZyb20gaW5zcGVjdCBpbXBvcnQgZmluZHNvdXJjZQogICAgCiAgICBnID0gZ2xvYmFscygpLmNvcHkoKQogICAgY2FzZXMgPSBbZ1tvYmpdIGZvciBvYmogaW4gZyBpZiBvYmouc3RhcnRzd2l0aCgiVGVzdCIpIGFuZCBpc3N1YmNsYXNzKGdbb2JqXSwgdW5pdHRlc3QuVGVzdENhc2UpXQogICAgb3JkZXJlZF9jYXNlcyA9IHNvcnRlZChjYXNlcywga2V5PWxhbWJkYSBmOiBmaW5kc291cmNlKGYpWzFdKQogICAgcmV0dXJuIG9yZGVyZWRfY2FzZXMKCgpkZWYgZnVuY3Rpb25fbm90X2RlZmluZWQobW9kdWxlLCBmdW5jX25hbWUpOgogICAgcmV0dXJuIG5vdCAoaGFzYXR0cihtb2R1bGUsIGZ1bmNfbmFtZSkgYW5kIGNhbGxhYmxlKGdldGF0dHIobW9kdWxlLCBmdW5jX25hbWUpKSkKCgpkZWYgaW5kZW50KHRleHQsIGluZGVudD00KToKICAgIHJldHVybiAnXG4nLmpvaW4oWyhpbmRlbnQgKiAnICcpICsgbGluZSBmb3IgbGluZSBpbiB0ZXh0LnNwbGl0bGluZXMoKV0pCgoKZGVmIHNraXBfaW5pdGlhbF9ub25sb2NhbCh0Yik6CiAgICBpZiB0YiBpcyBOb25lOgogICAgICAgIHJldHVybiB0YgogICAgaWYgdGIudGJfZnJhbWUuZl9jb2RlLmNvX2ZpbGVuYW1lLnN0YXJ0c3dpdGgoJ3Rlc3RfJyk6CiAgICAgICAgcmV0dXJuIHNraXBfaW5pdGlhbF9ub25sb2NhbCh0Yi50Yl9uZXh0KQogICAgaWYgJ3VuaXR0ZXN0JyBpbiB0Yi50Yl9mcmFtZS5mX2NvZGUuY29fZmlsZW5hbWU6CiAgICAgICAgcmV0dXJuIHNraXBfaW5pdGlhbF9ub25sb2NhbCh0Yi50Yl9uZXh0KQoKICAgIHJldHVybiB0YgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpmcm9tIGNvcHkgaW1wb3J0IGRlZXBjb3B5CgpjbGFzcyBOb25TdGFuZGFyZEVsZW1lbnRFcnJvcihFeGNlcHRpb24pOgoKICAgIGRlZiBfX2luaXRfX18oc2VsZiwgZEVyckFyZ3VtZW50cyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsKmFyZ3MsKiprd2FyZ3MpOgogICAgICAgICAgICBFeGNlcHRpb24uX19pbml0X18oc2VsZiwqYXJncywqKmt3YXJncykKICAKCmRlZiByb3VuZF9kYXRhc3RydWN0X3JlY3Vyc2l2ZWx5KGQpOgogICAgaWYgaXNpbnN0YW5jZShkLCBkaWN0KToKICAgICAgICBmb3IgaywgdiBpbiBkLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodiwgbGlzdCkgb3IgaXNpbnN0YW5jZSh2LCBkaWN0KToKICAgICAgICAgICAgICAgIHJvdW5kX2RhdGFzdHJ1Y3RfcmVjdXJzaXZlbHkodikKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHYsIGZsb2F0KToKICAgICAgICAgICAgICAgIGRba10gPSByb3VuZChkW2tdLCA1KQogICAgZWxpZiBpc2luc3RhbmNlKGQsIGxpc3QpOgogICAgICAgIGZvciBpLCB2IGluIGVudW1lcmF0ZShkKToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2LCBsaXN0KSBvciBpc2luc3RhbmNlKHYsIGRpY3QpOgogICAgICAgICAgICAgICAgcm91bmRfZGF0YXN0cnVjdF9yZWN1cnNpdmVseSh2KQogICAgICAgICAgICBlbGlmIGlzaW5zdGFuY2UodiwgZmxvYXQpOgogICAgICAgICAgICAgICAgZFtpXSA9IHJvdW5kKGRbaV0sIDUpCiAgICBlbGlmIG5vdCAoaXNpbnN0YW5jZShkLCBmbG9hdCkgb3IgaXNpbnN0YW5jZShkLCBpbnQpIG9yIGlzaW5zdGFuY2UoZCwgc3RyKSk6CiAgICAgICAgcmFpc2UgTm9uU3RhbmRhcmRFbGVtZW50RXJyb3IoZCkKCmRlZiBjb21wYXJlX2RhdGFzdHJ1Y3RfbmljZShleHAsIGFjdCk6CiAgICAiIiIKICAgIENvbXBhcmVzIGRhdGEgc3RydWN0dXJlcyBpbiBhIHdheSB0aGF0IHJvdW5kcyBmbG9hdCB2YWx1ZXMgaW4gdGhlbQogICAgIiIiCiAgICBleHBfcm91bmRlZCA9IGRlZXBjb3B5KGV4cCkKICAgIGFjdF9yb3VuZGVkID0gZGVlcGNvcHkoYWN0KQogICAgdHJ5OgogICAgICAgIHJvdW5kX2RhdGFzdHJ1Y3RfcmVjdXJzaXZlbHkoZXhwX3JvdW5kZWQpCiAgICAgICAgcm91bmRfZGF0YXN0cnVjdF9yZWN1cnNpdmVseShhY3Rfcm91bmRlZCkKICAgIGV4Y2VwdCBOb25TdGFuZGFyZEVsZW1lbnRFcnJvciBhcyBlcnI6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gZXhwX3JvdW5kZWQgPT0gYWN0X3JvdW5kZWQKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKY2xhc3MgQW52UHJvZ1Rlc3RSZXN1bHQoVGVzdFJlc3VsdCk6CiAgICBzZXBhcmF0b3IgPSAnPScgKiA3MAoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJlYW0sIGRlc2NyaXB0aW9ucywgdmVyYm9zaXR5KToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKHN0cmVhbSwgZGVzY3JpcHRpb25zLCB2ZXJib3NpdHkpCiAgICAgICAgc2VsZi5zdHJlYW0gPSBzdHJlYW0KICAgICAgICBzZWxmLnNob3dBbGwgPSBGYWxzZQogICAgICAgIHNlbGYuZG90cyA9IFRydWUKICAgICAgICBzZWxmLmRlc2NyaXB0aW9ucyA9IGRlc2NyaXB0aW9ucwoKICAgICAgICBzZWxmLnNraXBwZWRfZnVuY3Rpb25zID0gbGlzdCgpCgogICAgICAgIGlmIEdSQURFX01PREU6CiAgICAgICAgICAgIHJlcG9ydF9maWxlID0gb3MucGF0aC5zcGxpdGV4dChvcy5wYXRoLmJhc2VuYW1lKF9fZmlsZV9fKSlbMF0gKyAnLmNzdicKICAgICAgICAgICAgc2VsZi5maWxlID0gb3BlbihyZXBvcnRfZmlsZSwgJ3cnKQoKICAgICAgICAjIG1hdGNoID0gcmUuc2VhcmNoKHInYXNzaWdubWVudF8oYXVcZCspX2F0dGVtcHQnLCBvcy5wYXRoLmJhc2VuYW1lKG9zLmdldGN3ZCgpKSkKICAgICAgICAjIGlmIG1hdGNoOgogICAgICAgICMgICAgIHNlbGYuc3R1ZGVudF9pZCA9IG1hdGNoLmdyb3VwKDEpCiAgICAgICAgIyBlbHNlOgogICAgICAgICMgICAgIHNlbGYuc3R1ZGVudF9pZCA9ICdOQScKCiAgICAgICAgYmxhY2tib2FyZF9tYXRjaCA9IHJlLnNlYXJjaChyJ2Fzc2lnbm1lbnRfKGF1XGQrKV9hdHRlbXB0Jywgb3MucGF0aC5iYXNlbmFtZShvcy5nZXRjd2QoKSkpCiAgICAgICAgZGlnaXRhbGV4YW1fbWF0Y2ggPSByZS5zZWFyY2gocicoW15fXSspX1xkK19cZCtfLisnICsgUFJPSkVDVF9OQU1FLCBvcy5wYXRoLmJhc2VuYW1lKG9zLmdldGN3ZCgpKSkKCiAgICAgICAgaWYgYmxhY2tib2FyZF9tYXRjaDoKICAgICAgICAgICAgc2VsZi5zdHVkZW50X2lkID0gYmxhY2tib2FyZF9tYXRjaC5ncm91cCgxKQogICAgICAgIGVsaWYgZGlnaXRhbGV4YW1fbWF0Y2g6CiAgICAgICAgICAgIHNlbGYuc3R1ZGVudF9pZCA9IGRpZ2l0YWxleGFtX21hdGNoLmdyb3VwKDEpICAgICAgICAgICAgCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zdHVkZW50X2lkID0gJ05BJwoKICAgIGRlZiBhZGRTdWNjZXNzKHNlbGYsIHRlc3QpOgogICAgICAgIHN1cGVyKCkuYWRkU3VjY2Vzcyh0ZXN0KQoKICAgICAgICBpZiBHUkFERV9NT0RFOgogICAgICAgICAgICBzZWxmLmZpbGUud3JpdGUoJ3t9LHt9LHt9LHt9XG4nLmZvcm1hdChzZWxmLnN0dWRlbnRfaWQsIHRlc3QuX19jbGFzc19fLl9fbmFtZV9fLCB0ZXN0Ll90ZXN0TWV0aG9kTmFtZSwgJ29rJykpCiAgICAgICAgICAgIHNlbGYuZmlsZS5mbHVzaCgpCgogICAgZGVmIGFkZEVycm9yKHNlbGYsIHRlc3QsIGVycik6CiAgICAgICAgc3VwZXIoKS5hZGRFcnJvcih0ZXN0LCBlcnIpCiAgICAgICAgZXJyY2xzLCBlcnJvYmosIHRiID0gZXJyCiAgICAgICAgbmV3X3RiID0gc2tpcF9pbml0aWFsX25vbmxvY2FsKHRiKQoKICAgICAgICBpZiBHUkFERV9NT0RFOgogICAgICAgICAgICBzZWxmLmZpbGUud3JpdGUoJ3t9LHt9LHt9LHt9XG4nLmZvcm1hdChzZWxmLnN0dWRlbnRfaWQsIHRlc3QuX19jbGFzc19fLl9fbmFtZV9fLCB0ZXN0Ll90ZXN0TWV0aG9kTmFtZSwgJ2Vycm9yJykpCiAgICAgICAgICAgIHNlbGYuZmlsZS5mbHVzaCgpCgogICAgICAgICMgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAjICAgICAnRVJST1IgRFVSSU5HIFRFU1QgQ0FTRToge30nLmZvcm1hdCh0ZXN0Ll90ZXN0TWV0aG9kTmFtZSkpCiAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAgICAgJ1lPVVIgQ09ERSBGQUlMRUQgV0hJTEUgUlVOTklORyBBIFRFU1QgKHt9KScuZm9ybWF0KHRlc3QuX3Rlc3RNZXRob2ROYW1lKSkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdJdCBtZWFucyB0aGF0IHlvdXIgZnVuY3Rpb24gY291bGQgbm90IGJlIHJ1biB0aGUgd2F5IHNwZWNpZmllZCBpbiB0aGUgYXNzaWdubWVudC4nKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oJ01FU1NBR0U6JykKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKGluZGVudCgne30nLmZvcm1hdChlcnJvYmopKSkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdERVRBSUxFRDonKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgIGluZGVudCgnQmVsb3cgaXMgYSBkZXRhaWxlZCBkZXNjcmlwdGlvbiBvZiB3aGVyZSB0aGUgZXJyb3Igb2NjdXJyZWQnKSkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKGluZGVudCgKICAgICAgICAgICAgJ2FuZCB3aGF0IGNvZGUgd2FzIHJ1biBiZWZvcmUgdGhlIGVycm9yIG9jY3VycmVkLiBJdCBpcyBvZnRlbicpKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oaW5kZW50KAogICAgICAgICAgICAnbW9zdCB1c2VmdWwgdG8gcmVhZCB0aGlzIGRlc2NyaXB0aW9uIGZyb20gdGhlIGJvdHRvbSBhbmQgdXAuJykpCiAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigpCgogICAgICAgICMgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAjICAgICBpbmRlbnQoJ1xuJy5qb2luKHRyYWNlYmFjay5mb3JtYXRfdGIobmV3X3RiKSkpKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgIGluZGVudCgiLi4uU2tpcHBlZCBmcmFtZXMgbm90IHJlbGV2YW50IHRvIHlvdXIgY29kZS4uLiIpKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgIGluZGVudCgnJy5qb2luKHRyYWNlYmFjay5mb3JtYXRfZXhjZXB0aW9uKGVycmNscywgZXJyb2JqLCBuZXdfdGIpKSkpCgogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oc2VsZi5zZXBhcmF0b3IpCiAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBhZGRGYWlsdXJlKHNlbGYsIHRlc3QsIGVycik6CiAgICAgICAgc3VwZXIoKS5hZGRGYWlsdXJlKHRlc3QsIGVycikKICAgICAgICBfLCBlcnJvYmosIHRiID0gZXJyCgogICAgICAgIGlmIEdSQURFX01PREU6CiAgICAgICAgICAgIHNlbGYuZmlsZS53cml0ZSgne30se30se30se31cbicuZm9ybWF0KHNlbGYuc3R1ZGVudF9pZCwgdGVzdC5fX2NsYXNzX18uX19uYW1lX18sIHRlc3QuX3Rlc3RNZXRob2ROYW1lLCAnZmFpbGVkJykpCiAgICAgICAgICAgIHNlbGYuZmlsZS5mbHVzaCgpCgogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgICdGQUlMRUQgVEVTVCBDQVNFOiB7fScuZm9ybWF0KHRlc3QuX3Rlc3RNZXRob2ROYW1lKSkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdNRVNTQUdFOicpCiAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihpbmRlbnQoc3RyKGVycm9iaikpKQogICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQoKICAgICAgICBpZiBpc2luc3RhbmNlKGVycm9iaiwgQXNzZXJ0RXF1YWxBc3NlcnRpb25FcnJvcik6CiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oJ0VYUEVDVEVEOicpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oaW5kZW50KHJlcHIoZXJyb2JqLmV4cGVjdGVkKSkpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdBQ1RVQUw6JykKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihpbmRlbnQocmVwcihlcnJvYmouYWN0dWFsKSkpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oKQoKICAgICAgICAjIGlmIGlzaW5zdGFuY2UoZXJyb2JqLCBBc3NlcnRpb25FcnJvcik6CiAgICAgICAgIyAgICAgbmV3X3RiID0gc2tpcF9pbml0aWFsX25vbmxvY2FsKHRiKQogICAgICAgICMgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgIyAgICAgICAgICdFUlJPUiBEVVJJTkcgVEVTVCBDQVNFOiB7fScuZm9ybWF0KHRlc3QuX3Rlc3RNZXRob2ROYW1lKSkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdNRVNTQUdFOicpCiAgICAgICAgIyAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihpbmRlbnQoJ1lvdXIgZnVuY3Rpb24gY29udGFpbnMgYW4gImFzc2VydCIgc3RhdGVtZW50IHRoYXQgcmFpc2VkIGFuIGVycm9yJykpCiAgICAgICAgIyAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihpbmRlbnQoJ1JlbW92ZSB0aGUgYXNzZXJ0IHN0YXRlbWVudCB0byByZXNvbHZlIHRoaXMgZXJyb3InKSkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCdERVRBSUxFRDonKQogICAgICAgICMgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgIyAgICAgICAgIGluZGVudCgnQmVsb3cgaXMgYSBkZXRhaWxlZCBkZXNjcmlwdGlvbiBvZiB3aGVyZSB0aGUgZXJyb3Igb2NjdXJyZWQnKSkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKGluZGVudCh0cmFjZWJhY2suZm9ybWF0X3RiKG5ld190YilbLTFdKSkKICAgICAgICAjICAgICAjIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgIyAgICAgIyAgICAgaW5kZW50KCdcbicuam9pbih0cmFjZWJhY2suZm9ybWF0X3RiKG5ld190YikpKSkKICAgICAgICAjICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKCiAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbihzZWxmLnNlcGFyYXRvcikKICAgICAgICBzZWxmLnN0cmVhbS5mbHVzaCgpCgogICAgZGVmIGFkZFNraXAoc2VsZiwgdGVzdCwgcmVhc29uKToKICAgICAgICBzdXBlcigpLmFkZFNraXAodGVzdCwgcmVhc29uKQoKICAgICAgICBpZiByZWFzb24gbm90IGluIHNlbGYuc2tpcHBlZF9mdW5jdGlvbnM6CiAgICAgICAgICAgIHNlbGYuc2tpcHBlZF9mdW5jdGlvbnMuYXBwZW5kKHJlYXNvbikKCiAgICAgICAgaWYgR1JBREVfTU9ERToKICAgICAgICAgICAgc2VsZi5maWxlLndyaXRlKCd7fSx7fSx7fSx7fVxuJy5mb3JtYXQoc2VsZi5zdHVkZW50X2lkLCB0ZXN0Ll9fY2xhc3NfXy5fX25hbWVfXywgdGVzdC5fdGVzdE1ldGhvZE5hbWUsICdza2lwcGVkJykpCiAgICAgICAgICAgIHNlbGYuZmlsZS5mbHVzaCgpCgogICAgICAgICMgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAjICAgICAnQVRURU5USU9OISBBIHRlc3Qgb2YgInt9IiB3YXMgc2tpcHBlZCBiZWNhdXNlIHRoaXMgZnVuY3Rpb24gd2FzIG5vdCBkZWZpbmVkLiAnLmZvcm1hdChyZWFzb24pKQogICAgICAgICMgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAjICAgICAnRnVuY3Rpb25zIG5vdCBjb3JyZWN0bHkgZGVmaW5lZCBhcmUgbWFya2VkIGFzIEZBSUxFRC4gUGxlYXNlIG1ha2Ugc3VyZSB0aGlzIGlzIHdoYXQgeW91IGludGVuZGVkIScpCiAgICAgICAgIyBzZWxmLnN0cmVhbS53cml0ZWxuKCcnKQogICAgICAgICMgc2VsZi5zdHJlYW0uZmx1c2goKQoKICAgIGRlZiBhZGRFeHBlY3RlZEZhaWx1cmUoc2VsZiwgdGVzdCwgZXJyKToKICAgICAgICByYWlzZSBOb3RJbXBsZW1lbnRlZEVycm9yKCkKCiAgICBkZWYgYWRkVW5leHBlY3RlZFN1Y2Nlc3Moc2VsZiwgdGVzdCk6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcigpCgogICAgZGVmIHN0b3BUZXN0UnVuKHNlbGYpOgogICAgICAgIHN1cGVyKCkuc3RvcFRlc3RSdW4oKQoKICAgICAgICBpZiBzZWxmLnNraXBwZWRfZnVuY3Rpb25zOgogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbignKicqNTcpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgICAgICAnQVRURU5USU9OISBUaGUgZm9sbG93aW5nIGZ1bmN0aW9ucyBhcmUgbm90IGRlZmluZWQ6JykKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbignJykKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAgICAgICAgICdcbicuam9pbignXHR7fScuZm9ybWF0KHgpIGZvciB4IGluIHNlbGYuc2tpcHBlZF9mdW5jdGlvbnMpKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAgICAgc2VsZi5zdHJlYW0ud3JpdGVsbigKICAgICAgICAgICAgICAgICdUaGVzZSBmdW5jdGlvbnMgYXJlIGVpdGhlciBub3QgY29ycmVjdGx5IG5hbWVkIChzcGVsbGVkKScpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oCiAgICAgICAgICAgICAgICAnb3Igbm90IGRlZmluZWQgYXQgYWxsLiBUaGV5IHdpbGwgYmUgbWFya2VkIGFzIEZBSUxFRC4nKQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKAogICAgICAgICAgICAgICAgJ0NoZWNrIHlvdXIgc3BlbGxpbmcgaWYgdGhpcyBpcyBub3Qgd2hhdCB5b3UgaW50ZW5kLicpCiAgICAgICAgICAgIHNlbGYuc3RyZWFtLndyaXRlbG4oJyonKjU3KQogICAgICAgICAgICBzZWxmLnN0cmVhbS53cml0ZWxuKCkKICAgICAgICAgICAgc2VsZi5zdHJlYW0uZmx1c2goKQoKCmNsYXNzIEFudlByb2dUZXN0UnVubmVyKFRleHRUZXN0UnVubmVyKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCphcmdzLCByZXN1bHRjbGFzcz1BbnZQcm9nVGVzdFJlc3VsdCwgKiprd2FyZ3MpCgoKY2xhc3MgQXNzZXJ0RXF1YWxBc3NlcnRpb25FcnJvcihBc3NlcnRpb25FcnJvcik6CiAgICAiIiIKICAgIEEgc2ltcGxlIGV4dGVuc2lvbiBvZiBBc3NlcnRpb25FcnJvciBhbGxvd2luZyB1cyB0byBzdG9yZSB0aGUgYWN0dWFsIGFuZAogICAgZXhwZWN0ZWQgdmFsdWVzIGZvciBsYXRlciB1c2UuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgYWN0dWFsLCBleHBlY3RlZCwgbXNnKToKICAgICAgICBzdXBlcihBc3NlcnRFcXVhbEFzc2VydGlvbkVycm9yLCBzZWxmKS5fX2luaXRfXyhtc2cpCiAgICAgICAgc2VsZi5hY3R1YWwgPSBhY3R1YWwKICAgICAgICBzZWxmLmV4cGVjdGVkID0gZXhwZWN0ZWQKCgpjbGFzcyBBc3NlcnRFcXVhbE5pY2VBc3NlcnRpb25FcnJvcihBc3NlcnRpb25FcnJvcik6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFjdHVhbCwgZXhwZWN0ZWQsIGZ1bmMsIGFyZ3MsIGt3YXJncyk6CiAgICAgICAgc2VsZi5hY3R1YWwgPSBhY3R1YWwKICAgICAgICBzZWxmLmV4cGVjdGVkID0gZXhwZWN0ZWQKICAgICAgICBzZWxmLmZ1bmMgPSBmdW5jCiAgICAgICAgc2VsZi5hcmdzID0gYXJncwogICAgICAgIHNlbGYua3dhcmdzID0ga3dhcmdzCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgYXJnc19zdHIgPSAnLCAnLmpvaW4obWFwKHJlcHIsIHNlbGYuYXJncykpCiAgICAgICAgaWYgc2VsZi5rd2FyZ3M6CiAgICAgICAgICAgIGt3YXJnc19zdHIgPSAnLCAnLmpvaW4oJ3t9PXshcn0nLmZvcm1hdChrLCB3KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBrLCB3IGluIHNlbGYua3dhcmdzLml0ZW1zKCkpCiAgICAgICAgICAgIGFyZ3Nfc3RyICs9ICcsICcgKyBrd2FyZ3Nfc3RyCiAgICAgICAgcmV0dXJuIGFzc2VydGlvbl9tc2cuZm9ybWF0KAogICAgICAgICAgICBmdW5jPXNlbGYuZnVuYy5fX25hbWVfXywKICAgICAgICAgICAgYXJncz1hcmdzX3N0ciwKICAgICAgICAgICAgYWN0dWFsPXJlcHIoc2VsZi5hY3R1YWwpLAogICAgICAgICAgICBleHBlY3RlZD1yZXByKHNlbGYuZXhwZWN0ZWQpKQoKCmNsYXNzIEFudlByb2dUZXN0Q2FzZSh1bml0dGVzdC5UZXN0Q2FzZSk6CgogICAgZGVmIGFzc2VydEZ1bmN0aW9uRGVmaW5lZChzZWxmLCBtb2R1bGUsIG5hbWUpOgogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShoYXNhdHRyKG1vZHVsZSwgbmFtZSksCiAgICAgICAgICAgICAgICAgICAgICAgIG1zZz0iJ3t9JyBpcyBub3QgZGVmaW5lZCIuZm9ybWF0KG5hbWUpKQogICAgICAgIHNlbGYuYXNzZXJ0VHJ1ZShjYWxsYWJsZShnZXRhdHRyKG1vZHVsZSwgbmFtZSkpLAogICAgICAgICAgICAgICAgICAgICAgICBtc2c9Iid7fScgaXMgbm90IGEgZnVuY3Rpb24iLmZvcm1hdChuYW1lKSkKCiAgICBkZWYgYXNzZXJ0RnVuY3Rpb25Qb3NQYXJhbXMoc2VsZiwgZnVuYywgZXhwZWN0ZWQpOgogICAgICAgIHNpZ25hdHVyZSA9IHN0cihpbnNwZWN0LnNpZ25hdHVyZShmdW5jKSkKICAgICAgICBzZWxmLmFzc2VydFRydWUoZXhwZWN0ZWQgPT0gc2lnbmF0dXJlLAogICAgICAgICAgICAgICAgICAgICAgICBtc2c9Ildyb25nIG5hbWVzIG9mIGZ1bmN0aW9uIHBhcmFtZXRlcnNcblxuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvcnJlY3QgZnVuY3Rpb24gZGVmaW5pdGlvbjpcblxuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgInt9XG5cbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJHb3Q6XG5cbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ7fSIuZm9ybWF0KGZ1bmMuX19uYW1lX18gKyBleHBlY3RlZCwgZnVuYy5fX25hbWVfXyArIHNpZ25hdHVyZSkpCgogICAgZGVmIGFzc2VydEVxdWFsTmljZShzZWxmLCBleHBlY3RlZCwgZnVuYywgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICBhY3R1YWwgPSBmdW5jKCphcmdzLCAqKmt3YXJncykKCiAgICAgICAgaWYgaXNpbnN0YW5jZShleHBlY3RlZCwgZGljdCkgb3IgaXNpbnN0YW5jZShhY3R1YWwsIGRpY3QpIG9yIFwKICAgICAgICAgICAgaXNpbnN0YW5jZShleHBlY3RlZCwgbGlzdCkgb3IgaXNpbnN0YW5jZShhY3R1YWwsIGxpc3QpOgogICAgICAgICAgICBpZiBub3QgY29tcGFyZV9kYXRhc3RydWN0X25pY2UoZXhwZWN0ZWQsIGFjdHVhbCk6CiAgICAgICAgICAgICAgICByYWlzZSBBc3NlcnRFcXVhbE5pY2VBc3NlcnRpb25FcnJvcigKICAgICAgICAgICAgICAgICAgICBhY3R1YWwsIGV4cGVjdGVkLCBmdW5jLCBhcmdzLCBrd2FyZ3MpCgogICAgICAgIGVsaWYgaXNpbnN0YW5jZShleHBlY3RlZCwgZmxvYXQpIG9yIGlzaW5zdGFuY2UoYWN0dWFsLCBmbG9hdCk6CiAgICAgICAgICAgIGlmIGFicyhleHBlY3RlZCAtIGFjdHVhbCkgPiAxZS00OgogICAgICAgICAgICAgICAgcmFpc2UgQXNzZXJ0RXF1YWxOaWNlQXNzZXJ0aW9uRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgYWN0dWFsLCBleHBlY3RlZCwgZnVuYywgYXJncywga3dhcmdzKQogICAgICAgIGVsaWYgYWN0dWFsICE9IGV4cGVjdGVkOgogICAgICAgICAgICByYWlzZSBBc3NlcnRFcXVhbE5pY2VBc3NlcnRpb25FcnJvcigKICAgICAgICAgICAgICAgIGFjdHVhbCwgZXhwZWN0ZWQsIGZ1bmMsIGFyZ3MsIGt3YXJncykKCiAgICBkZWYgYXNzZXJ0RXF1YWwoc2VsZiwgZmlyc3QsIHNlY29uZCwgbXNnPU5vbmUpOgogICAgICAgICMgU3VwcHJlc3MgZGlmZnMgZm9yIHN0cmluZ3MuCiAgICAgICAgaWYgbXNnIGlzIE5vbmUgYW5kIGlzaW5zdGFuY2UoZmlyc3QsIHN0cikgYW5kIGlzaW5zdGFuY2Uoc2Vjb25kLCBzdHIpOgogICAgICAgICAgICBtc2cgPSAnR290IFwne31cJyBidXQgZXhwZWN0ZWQgXCd7fVwnJy5mb3JtYXQoZmlyc3QsIHNlY29uZCkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdXBlcigpLmFzc2VydEVxdWFsKGZpcnN0LCBzZWNvbmQsIG1zZz1tc2cpCiAgICAgICAgZXhjZXB0IEFzc2VydGlvbkVycm9yIGFzIGVycjoKICAgICAgICAgICAgaWYgbXNnIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBtc2cgPSBlcnIuYXJnc1swXQoKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0RXF1YWxBc3NlcnRpb25FcnJvcihmaXJzdCwgc2Vjb25kLCBtc2cpCgogICAgZGVmIGFzc2VydFRydWUoc2VsZiwgZXhwciwgbXNnPU5vbmUpOgogICAgICAgICMgT3ZlcnJpZGUgc3VwZXIoKS5hc3NlcnRUcnVlKCkgdG8gc3VwcHJlc3MgdGhlIGRlZmF1bHQgJ1ggaXMgbm90IHRydWUnCiAgICAgICAgIyBvdXRwdXQgd2hlbiBtc2cgaXMgbm90IE5vbmUuCiAgICAgICAgaWYgbXNnIGlzIE5vbmU6CiAgICAgICAgICAgIG1zZyA9ICd7fSBpcyBub3QgdHJ1ZScuZm9ybWF0KGV4cHIpCiAgICAgICAgaWYgbm90IGV4cHI6CiAgICAgICAgICAgIHJhaXNlIEFzc2VydGlvbkVycm9yKG1zZykKCiAgICBkZWYgYXNzZXJ0RmFsc2Uoc2VsZiwgZXhwciwgbXNnPU5vbmUpOgogICAgICAgICMgT3ZlcnJpZGUgc3VwZXIoKS5hc3NlcnRGYWxzZSgpIHRvIHN1cHByZXNzIHRoZSBkZWZhdWx0ICdYIGlzIG5vdAogICAgICAgICMgZmFsc2UnIG91dHB1dCB3aGVuIG1zZyBpcyBub3QgTm9uZS4KICAgICAgICBpZiBtc2cgaXMgTm9uZToKICAgICAgICAgICAgbXNnID0gJ3t9IGlzIG5vdCBmYWxzZScuZm9ybWF0KGV4cHIpCiAgICAgICAgaWYgZXhwcjoKICAgICAgICAgICAgcmFpc2UgQXNzZXJ0aW9uRXJyb3IobXNnKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjCiMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBURVNUUyBIRVJFICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMKIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpjb2Rvbl9tYXAgPSB7J1RUVCc6ICdGJywgJ1RUQyc6ICdGJywgJ1RUQSc6ICdMJywgJ1RURyc6ICdMJywgJ1RDVCc6ICdTJywKICAgICAgICAgICAgICAgICAgJ1RDQyc6ICdTJywgJ1RDQSc6ICdTJywgJ1RDRyc6ICdTJywgJ1RBVCc6ICdZJywgJ1RBQyc6ICdZJywKICAgICAgICAgICAgICAgICAgJ1RBQSc6ICcqJywgJ1RBRyc6ICcqJywgJ1RHVCc6ICdDJywgJ1RHQyc6ICdDJywgJ1RHQSc6ICcqJywKICAgICAgICAgICAgICAgICAgJ1RHRyc6ICdXJywgJ0NUVCc6ICdMJywgJ0NUQyc6ICdMJywgJ0NUQSc6ICdMJywgJ0NURyc6ICdMJywKICAgICAgICAgICAgICAgICAgJ0NDVCc6ICdQJywgJ0NDQyc6ICdQJywgJ0NDQSc6ICdQJywgJ0NDRyc6ICdQJywgJ0NBVCc6ICdIJywKICAgICAgICAgICAgICAgICAgJ0NBQyc6ICdIJywgJ0NBQSc6ICdRJywgJ0NBRyc6ICdRJywgJ0NHVCc6ICdSJywgJ0NHQyc6ICdSJywKICAgICAgICAgICAgICAgICAgJ0NHQSc6ICdSJywgJ0NHRyc6ICdSJywgJ0FUVCc6ICdJJywgJ0FUQyc6ICdJJywgJ0FUQSc6ICdJJywKICAgICAgICAgICAgICAgICAgJ0FURyc6ICdNJywgJ0FDVCc6ICdUJywgJ0FDQyc6ICdUJywgJ0FDQSc6ICdUJywgJ0FDRyc6ICdUJywKICAgICAgICAgICAgICAgICAgJ0FBVCc6ICdOJywgJ0FBQyc6ICdOJywgJ0FBQSc6ICdLJywgJ0FBRyc6ICdLJywgJ0FHVCc6ICdTJywKICAgICAgICAgICAgICAgICAgJ0FHQyc6ICdTJywgJ0FHQSc6ICdSJywgJ0FHRyc6ICdSJywgJ0dUVCc6ICdWJywgJ0dUQyc6ICdWJywKICAgICAgICAgICAgICAgICAgJ0dUQSc6ICdWJywgJ0dURyc6ICdWJywgJ0dDVCc6ICdBJywgJ0dDQyc6ICdBJywgJ0dDQSc6ICdBJywKICAgICAgICAgICAgICAgICAgJ0dDRyc6ICdBJywgJ0dBVCc6ICdEJywgJ0dBQyc6ICdEJywgJ0dBQSc6ICdFJywgJ0dBRyc6ICdFJywKICAgICAgICAgICAgICAgICAgJ0dHVCc6ICdHJywgJ0dHQyc6ICdHJywgJ0dHQSc6ICdHJywgJ0dHRyc6ICdHJ30KCmNsYXNzIFRlc3RDb2Rvbk1hcChBbnZQcm9nVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2NvZG9uX21hcF9kZWZpbmVkXzEoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRUcnVlKGhhc2F0dHIocHJvamVjdCwgJ2NvZG9uX21hcCcpLAogICAgICAgICAgICAgICAgICAgICAgICdUaGUgdmFyaWFibGUgYGNvZG9uX21hcGAgaGFzIG5vdCBiZWVuIGRlZmluZWQuJykKCiAgICBkZWYgdGVzdF9jb2Rvbl9tYXBfZGVmaW5lZF8yKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWwocHJvamVjdC5jb2Rvbl9tYXAsIGNvZG9uX21hcCwKICAgICAgICAgICAgICAgICAgICAgICAnSXQgc2VlbXMgeW91IGhhdmUgY2hhbmdlZCB0byBgY29kb25fbWFwYCBpbiB5b3VyIGZpbGUuJykKCgpAdW5pdHRlc3Quc2tpcElmKGZ1bmN0aW9uX25vdF9kZWZpbmVkKHByb2plY3QsICdzcGxpdF9jb2RvbnMnKSwgJ3NwbGl0X2NvZG9ucycpCmNsYXNzIFRlc3RTcGxpdENvZG9ucyhBbnZQcm9nVGVzdENhc2UpOgoKICAgICMgZGVmIHRlc3RfYWFhX3NwbGl0X2NvZG9uc19leGlzdHMoc2VsZik6CiAgICAjICAgICBzZWxmLmFzc2VydEZ1bmN0aW9uRGVmaW5lZChwcm9qZWN0LCAnc3BsaXRfY29kb25zJykKCiAgICBkZWYgdGVzdF9zcGxpdF9jb2RvbnNfMShzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsTmljZShbJ0FBQScsICdUVFQnLCAnQ0NDJywgJ0dHRyddLCBwcm9qZWN0LnNwbGl0X2NvZG9ucywgJ0FBQVRUVENDQ0dHRycpCgogICAgZGVmIHRlc3Rfc3BsaXRfY29kb25zXzIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoWydOTk4nLCAnTk5OJywgJ05OTicsICdOTk4nXSwgcHJvamVjdC5zcGxpdF9jb2RvbnMsICdOTk5OTk5OTk5OTk4nKQoKICAgIGRlZiB0ZXN0X3NwbGl0X2NvZG9uc18zKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxOaWNlKFsnQVRHJ10sIHByb2plY3Quc3BsaXRfY29kb25zLCAnQVRHJykKCiAgICBkZWYgdGVzdF9zcGxpdF9jb2RvbnNfNChzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsTmljZShbXSwgcHJvamVjdC5zcGxpdF9jb2RvbnMsICcnKQoKCkB1bml0dGVzdC5za2lwSWYoZnVuY3Rpb25fbm90X2RlZmluZWQocHJvamVjdCwgJ2NvdW50X2NvZG9ucycpLCAnY291bnRfY29kb25zJykKY2xhc3MgVGVzdENvdW50Q29kb25zKEFudlByb2dUZXN0Q2FzZSk6CgogICAgZGVmIHRlc3RfY291bnRfY29kb25zXzEoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydDVFQnOiAwLCAnQVRHJzogMSwgJ0FDQSc6IDAsICdBQ0cnOiAwLCAnQVRDJzogMCwgJ0FBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBVEEnOiAwLCAnQUdHJzogMCwgJ0NDVCc6IDAsICdBQ1QnOiAwLCAnQUdDJzogMCwgJ0FBRyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBR0EnOiAwLCAnQ0FUJzogMCwgJ0FBVCc6IDAsICdBVFQnOiAwLCAnQ1RHJzogMCwgJ0NUQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDVEMnOiAwLCAnQ0FDJzogMCwgJ0FBQSc6IDAsICdDQ0cnOiAwLCAnQUdUJzogMCwgJ0NDQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDQUEnOiAwLCAnQ0NDJzogMCwgJ1RBVCc6IDAsICdHR1QnOiAwLCAnVEdUJzogMCwgJ0NHQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDQUcnOiAwLCAnVENUJzogMCwgJ0dBVCc6IDAsICdDR0cnOiAwLCAnVFRUJzogMCwgJ1RHQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdHR0cnOiAwLCAnVEFHJzogMCwgJ0dHQSc6IDAsICdUR0cnOiAwLCAnR0dDJzogMCwgJ1RBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUVEMnOiAwLCAnVENHJzogMCwgJ1RUQSc6IDAsICdUVEcnOiAwLCAnVENDJzogMCwgJ0FDQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUQUEnOiAwLCAnR0NBJzogMCwgJ0dUQSc6IDAsICdHQ0MnOiAwLCAnR1RDJzogMCwgJ0dDRyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdHVEcnOiAwLCAnR0FHJzogMCwgJ0dUVCc6IDAsICdHQ1QnOiAwLCAnVEdBJzogMSwgJ0dBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDR1QnOiAwLCAnR0FBJzogMCwgJ1RDQSc6IDAsICdDR0MnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2plY3QuY291bnRfY29kb25zLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0FUR1RHQScpCgoKICAgIGRlZiB0ZXN0X2NvdW50X2NvZG9uc18yKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxOaWNlKHsnQ1RUJzogMCwgJ0FURyc6IDEsICdBQ0EnOiAwLCAnQUNHJzogMCwgJ0FUQyc6IDAsICdBQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQVRBJzogMCwgJ0FHRyc6IDAsICdDQ1QnOiAwLCAnQUNUJzogMCwgJ0FHQyc6IDAsICdBQUcnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQUdBJzogMCwgJ0NBVCc6IDAsICdBQVQnOiAwLCAnQVRUJzogMCwgJ0NURyc6IDAsICdDVEEnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ1RDJzogMCwgJ0NBQyc6IDAsICdBQUEnOiAwLCAnQ0NHJzogMCwgJ0FHVCc6IDAsICdDQ0EnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0FBJzogMCwgJ0NDQyc6IDAsICdUQVQnOiAwLCAnR0dUJzogMCwgJ1RHVCc6IDAsICdDR0EnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0FHJzogMCwgJ1RDVCc6IDAsICdHQVQnOiAwLCAnQ0dHJzogMCwgJ1RUVCc6IDAsICdUR0MnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnR0dHJzogMCwgJ1RBRyc6IDAsICdHR0EnOiAwLCAnVEdHJzogMCwgJ0dHQyc6IDAsICdUQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVFRDJzogMCwgJ1RDRyc6IDAsICdUVEEnOiAwLCAnVFRHJzogMCwgJ1RDQyc6IDQsICdBQ0MnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVEFBJzogMCwgJ0dDQSc6IDAsICdHVEEnOiAwLCAnR0NDJzogMCwgJ0dUQyc6IDAsICdHQ0cnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnR1RHJzogMCwgJ0dBRyc6IDAsICdHVFQnOiAwLCAnR0NUJzogMCwgJ1RHQSc6IDEsICdHQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0dUJzogMCwgJ0dBQSc6IDAsICdUQ0EnOiAwLCAnQ0dDJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0LmNvdW50X2NvZG9ucywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBVEdUQ0NUQ0NUQ0NUQ0NUR0EnKQoKCgoKQHVuaXR0ZXN0LnNraXBJZihmdW5jdGlvbl9ub3RfZGVmaW5lZChwcm9qZWN0LCAnZ3JvdXBfY291bnRzX2J5X2FtaW5vX2FjaWQnKSwgJ2dyb3VwX2NvdW50c19ieV9hbWlub19hY2lkJykKY2xhc3MgVGVzdEdyb3VwQ291bnRzQnlBbWlub0FjaWQoQW52UHJvZ1Rlc3RDYXNlKToKCiAgICBkZWYgdGVzdF9ncm91cF9jb3VudHNfYnlfYW1pbm9fYWNpZF8xKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxOaWNlKHsnQSc6IHsnR0NBJzogMCwgJ0dDQyc6IDAsICdHQ1QnOiAwLCAnR0NHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQyc6IHsnVEdDJzogMCwgJ1RHVCc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0UnOiB7J0dBRyc6IDAsICdHQUEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdEJzogeydHQVQnOiAwLCAnR0FDJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRyc6IHsnR0dUJzogMCwgJ0dHRyc6IDAsICdHR0EnOiAwLCAnR0dDJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRic6IHsnVFRDJzogMCwgJ1RUVCc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0knOiB7J0FUVCc6IDAsICdBVEMnOiAwLCAnQVRBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSCc6IHsnQ0FDJzogMCwgJ0NBVCc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0snOiB7J0FBRyc6IDAsICdBQUEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcqJzogeydUQUcnOiAwLCAnVEdBJzogMSwgJ1RBQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ00nOiB7J0FURyc6IDF9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0wnOiB7J0NUVCc6IDAsICdDVEcnOiAwLCAnQ1RBJzogMCwgJ0NUQyc6IDAsICdUVEEnOiAwLCAnVFRHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTic6IHsnQUFUJzogMCwgJ0FBQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1EnOiB7J0NBQSc6IDAsICdDQUcnOiAwfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1AnOiB7J0NDVCc6IDAsICdDQ0cnOiAwLCAnQ0NBJzogMCwgJ0NDQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1MnOiB7J1RDVCc6IDAsICdBR0MnOiAwLCAnVENHJzogMCwgJ0FHVCc6IDAsICdUQ0MnOiAwLCAnVENBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUic6IHsnQUdHJzogMCwgJ0NHQyc6IDAsICdDR0cnOiAwLCAnQ0dBJzogMCwgJ0FHQSc6IDAsICdDR1QnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUJzogeydBQ0MnOiAwLCAnQUNBJzogMCwgJ0FDRyc6IDAsICdBQ1QnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdXJzogeydUR0cnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdWJzogeydHVEEnOiAwLCAnR1RDJzogMCwgJ0dUVCc6IDAsICdHVEcnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdZJzogeydUQVQnOiAwLCAnVEFDJzogMH19LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5ncm91cF9jb3VudHNfYnlfYW1pbm9fYWNpZCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnQ1RUJzogMCwgJ0FURyc6IDEsICdBQ0EnOiAwLCAnQUNHJzogMCwgJ0FUQyc6IDAsICdBQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQVRBJzogMCwgJ0FHRyc6IDAsICdDQ1QnOiAwLCAnQUNUJzogMCwgJ0FHQyc6IDAsICdBQUcnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQUdBJzogMCwgJ0NBVCc6IDAsICdBQVQnOiAwLCAnQVRUJzogMCwgJ0NURyc6IDAsICdDVEEnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ1RDJzogMCwgJ0NBQyc6IDAsICdBQUEnOiAwLCAnQ0NHJzogMCwgJ0FHVCc6IDAsICdDQ0EnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0FBJzogMCwgJ0NDQyc6IDAsICdUQVQnOiAwLCAnR0dUJzogMCwgJ1RHVCc6IDAsICdDR0EnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0FHJzogMCwgJ1RDVCc6IDAsICdHQVQnOiAwLCAnQ0dHJzogMCwgJ1RUVCc6IDAsICdUR0MnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnR0dHJzogMCwgJ1RBRyc6IDAsICdHR0EnOiAwLCAnVEdHJzogMCwgJ0dHQyc6IDAsICdUQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVFRDJzogMCwgJ1RDRyc6IDAsICdUVEEnOiAwLCAnVFRHJzogMCwgJ1RDQyc6IDAsICdBQ0MnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVEFBJzogMCwgJ0dDQSc6IDAsICdHVEEnOiAwLCAnR0NDJzogMCwgJ0dUQyc6IDAsICdHQ0cnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnR1RHJzogMCwgJ0dBRyc6IDAsICdHVFQnOiAwLCAnR0NUJzogMCwgJ1RHQSc6IDEsICdHQUMnOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ0dUJzogMCwgJ0dBQSc6IDAsICdUQ0EnOiAwLCAnQ0dDJzogMH0pCgoKICAgIGRlZiB0ZXN0X2dyb3VwX2NvdW50c19ieV9hbWlub19hY2lkXzIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydBJzogeydHQ0EnOiAwLCAnR0NDJzogMCwgJ0dDVCc6IDAsICdHQ0cnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDJzogeydUR0MnOiAwLCAnVEdUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRSc6IHsnR0FHJzogMCwgJ0dBQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0QnOiB7J0dBVCc6IDAsICdHQUMnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdHJzogeydHR1QnOiAwLCAnR0dHJzogMCwgJ0dHQSc6IDAsICdHR0MnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdGJzogeydUVEMnOiAwLCAnVFRUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSSc6IHsnQVRUJzogMCwgJ0FUQyc6IDAsICdBVEEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdIJzogeydDQUMnOiAwLCAnQ0FUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSyc6IHsnQUFHJzogMCwgJ0FBQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyonOiB7J1RBRyc6IDAsICdUR0EnOiAxLCAnVEFBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTSc6IHsnQVRHJzogMX0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTCc6IHsnQ1RUJzogMCwgJ0NURyc6IDAsICdDVEEnOiAwLCAnQ1RDJzogMCwgJ1RUQSc6IDAsICdUVEcnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdOJzogeydBQVQnOiAwLCAnQUFDJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUSc6IHsnQ0FBJzogMCwgJ0NBRyc6IDB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUCc6IHsnQ0NUJzogMCwgJ0NDRyc6IDAsICdDQ0EnOiAwLCAnQ0NDJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUyc6IHsnVENUJzogMCwgJ0FHQyc6IDAsICdUQ0cnOiAwLCAnQUdUJzogMCwgJ1RDQyc6IDQsICdUQ0EnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdSJzogeydBR0cnOiAwLCAnQ0dDJzogMCwgJ0NHRyc6IDAsICdDR0EnOiAwLCAnQUdBJzogMCwgJ0NHVCc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1QnOiB7J0FDQyc6IDAsICdBQ0EnOiAwLCAnQUNHJzogMCwgJ0FDVCc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1cnOiB7J1RHRyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1YnOiB7J0dUQSc6IDAsICdHVEMnOiAwLCAnR1RUJzogMCwgJ0dURyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1knOiB7J1RBVCc6IDAsICdUQUMnOiAwfX0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0Lmdyb3VwX2NvdW50c19ieV9hbWlub19hY2lkLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeydDVFQnOiAwLCAnQVRHJzogMSwgJ0FDQSc6IDAsICdBQ0cnOiAwLCAnQVRDJzogMCwgJ0FBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBVEEnOiAwLCAnQUdHJzogMCwgJ0NDVCc6IDAsICdBQ1QnOiAwLCAnQUdDJzogMCwgJ0FBRyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBR0EnOiAwLCAnQ0FUJzogMCwgJ0FBVCc6IDAsICdBVFQnOiAwLCAnQ1RHJzogMCwgJ0NUQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDVEMnOiAwLCAnQ0FDJzogMCwgJ0FBQSc6IDAsICdDQ0cnOiAwLCAnQUdUJzogMCwgJ0NDQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDQUEnOiAwLCAnQ0NDJzogMCwgJ1RBVCc6IDAsICdHR1QnOiAwLCAnVEdUJzogMCwgJ0NHQSc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDQUcnOiAwLCAnVENUJzogMCwgJ0dBVCc6IDAsICdDR0cnOiAwLCAnVFRUJzogMCwgJ1RHQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdHR0cnOiAwLCAnVEFHJzogMCwgJ0dHQSc6IDAsICdUR0cnOiAwLCAnR0dDJzogMCwgJ1RBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUVEMnOiAwLCAnVENHJzogMCwgJ1RUQSc6IDAsICdUVEcnOiAwLCAnVENDJzogNCwgJ0FDQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUQUEnOiAwLCAnR0NBJzogMCwgJ0dUQSc6IDAsICdHQ0MnOiAwLCAnR1RDJzogMCwgJ0dDRyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdHVEcnOiAwLCAnR0FHJzogMCwgJ0dUVCc6IDAsICdHQ1QnOiAwLCAnVEdBJzogMSwgJ0dBQyc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDR1QnOiAwLCAnR0FBJzogMCwgJ1RDQSc6IDAsICdDR0MnOiAwfSkKCgoKQHVuaXR0ZXN0LnNraXBJZihmdW5jdGlvbl9ub3RfZGVmaW5lZChwcm9qZWN0LCAnbm9ybWFsaXplX2NvdW50cycpLCAnbm9ybWFsaXplX2NvdW50cycpCmNsYXNzIFRlc3ROb3JtYWxpemVDb3VudHMoQW52UHJvZ1Rlc3RDYXNlKToKCiAgICAjIGRlZiB0ZXN0X2FhYV9zcGxpdF9jb2RvbnNfZXhpc3RzKHNlbGYpOgogICAgIyAgICAgc2VsZi5hc3NlcnRGdW5jdGlvbkRlZmluZWQocHJvamVjdCwgJ3NwbGl0X2NvZG9ucycpCgogICAgZGVmIHRlc3Rfbm9ybWFsaXplX2NvdW50c18xKHNlbGYpOgogICAgICAgIHNlbGYuYXNzZXJ0RXF1YWxOaWNlKHsnQVRDJzogMC41LCAnQVRBJzogMC4xLCAnQVRUJzogMC40fSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5ub3JtYWxpemVfY291bnRzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7J0FUVCc6IDgsICdBVEMnOiAxMCwgJ0FUQSc6IDJ9KQoKICAgIGRlZiB0ZXN0X25vcm1hbGl6ZV9jb3VudHNfMihzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsTmljZShOb25lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0Lm5vcm1hbGl6ZV9jb3VudHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnQVRUJzogMCwgJ0FUQyc6IDAsICdBVEEnOiAwfSkKCgpAdW5pdHRlc3Quc2tpcElmKGZ1bmN0aW9uX25vdF9kZWZpbmVkKHByb2plY3QsICdub3JtYWxpemVfZ3JvdXBlZF9jb3VudHMnKSwgJ25vcm1hbGl6ZV9ncm91cGVkX2NvdW50cycpCmNsYXNzIFRlc3ROb3JtYWxpemVHcm91cGVkQ291bnRzKEFudlByb2dUZXN0Q2FzZSk6CgogICAgZGVmIHRlc3Rfbm9ybWFsaXplX2dyb3VwZWRfY291bnRzXzEoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydTJzogeydBR1QnOiAwLjAsICdUQ0cnOiAwLjAsICdUQ1QnOiAwLjAsICdUQ0EnOiAxLjAsICdUQ0MnOiAwLjAsICdBR0MnOiAwLjB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyonOiB7J1RBQSc6IDAuMCwgJ1RHQSc6IDEuMCwgJ1RBRyc6IDAuMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTSc6IHsnQVRHJzogMS4wfX0sIHByb2plY3Qubm9ybWFsaXplX2dyb3VwZWRfY291bnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7J0EnOiB7J0dDQSc6IDAsICdHQ0MnOiAwLCAnR0NUJzogMCwgJ0dDRyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0MnOiB7J1RHQyc6IDAsICdUR1QnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFJzogeydHQUcnOiAwLCAnR0FBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRCc6IHsnR0FUJzogMCwgJ0dBQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0cnOiB7J0dHVCc6IDAsICdHR0cnOiAwLCAnR0dBJzogMCwgJ0dHQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0YnOiB7J1RUQyc6IDAsICdUVFQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJJzogeydBVFQnOiAwLCAnQVRDJzogMCwgJ0FUQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0gnOiB7J0NBQyc6IDAsICdDQVQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdLJzogeydBQUcnOiAwLCAnQUFBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnKic6IHsnVEFHJzogMCwgJ1RHQSc6IDEsICdUQUEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdNJzogeydBVEcnOiAxfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMJzogeydDVFQnOiAwLCAnQ1RHJzogMCwgJ0NUQSc6IDAsICdDVEMnOiAwLCAnVFRBJzogMCwgJ1RURyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ04nOiB7J0FBVCc6IDAsICdBQUMnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdRJzogeydDQUEnOiAwLCAnQ0FHJzogMH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQJzogeydDQ1QnOiAwLCAnQ0NHJzogMCwgJ0NDQSc6IDAsICdDQ0MnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTJzogeydUQ1QnOiAwLCAnQUdDJzogMCwgJ1RDRyc6IDAsICdBR1QnOiAwLCAnVENDJzogMCwgJ1RDQSc6IDF9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1InOiB7J0FHRyc6IDAsICdDR0MnOiAwLCAnQ0dHJzogMCwgJ0NHQSc6IDAsICdBR0EnOiAwLCAnQ0dUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVCc6IHsnQUNDJzogMCwgJ0FDQSc6IDAsICdBQ0cnOiAwLCAnQUNUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVyc6IHsnVEdHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVic6IHsnR1RBJzogMCwgJ0dUQyc6IDAsICdHVFQnOiAwLCAnR1RHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWSc6IHsnVEFUJzogMCwgJ1RBQyc6IDB9fSkKCgogICAgZGVmIHRlc3Rfbm9ybWFsaXplX2dyb3VwZWRfY291bnRzXzIoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydTJzogeydBR1QnOiAwLjAsICdUQ0cnOiAxLjAsICdUQ1QnOiAwLjAsICdUQ0EnOiAwLjAsICdUQ0MnOiAwLjAsICdBR0MnOiAwLjB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyonOiB7J1RBQSc6IDAuMCwgJ1RHQSc6IDEuMCwgJ1RBRyc6IDAuMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTSc6IHsnQVRHJzogMS4wfX0sIHByb2plY3Qubm9ybWFsaXplX2dyb3VwZWRfY291bnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7J0EnOiB7J0dDQSc6IDAsICdHQ0MnOiAwLCAnR0NUJzogMCwgJ0dDRyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0MnOiB7J1RHQyc6IDAsICdUR1QnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFJzogeydHQUcnOiAwLCAnR0FBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRCc6IHsnR0FUJzogMCwgJ0dBQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0cnOiB7J0dHVCc6IDAsICdHR0cnOiAwLCAnR0dBJzogMCwgJ0dHQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0YnOiB7J1RUQyc6IDAsICdUVFQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJJzogeydBVFQnOiAwLCAnQVRDJzogMCwgJ0FUQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0gnOiB7J0NBQyc6IDAsICdDQVQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdLJzogeydBQUcnOiAwLCAnQUFBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnKic6IHsnVEFHJzogMCwgJ1RHQSc6IDEsICdUQUEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdNJzogeydBVEcnOiAxfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMJzogeydDVFQnOiAwLCAnQ1RHJzogMCwgJ0NUQSc6IDAsICdDVEMnOiAwLCAnVFRBJzogMCwgJ1RURyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ04nOiB7J0FBVCc6IDAsICdBQUMnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdRJzogeydDQUEnOiAwLCAnQ0FHJzogMH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQJzogeydDQ1QnOiAwLCAnQ0NHJzogMCwgJ0NDQSc6IDAsICdDQ0MnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTJzogeydUQ1QnOiAwLCAnQUdDJzogMCwgJ1RDRyc6IDcsICdBR1QnOiAwLCAnVENDJzogMCwgJ1RDQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1InOiB7J0FHRyc6IDAsICdDR0MnOiAwLCAnQ0dHJzogMCwgJ0NHQSc6IDAsICdBR0EnOiAwLCAnQ0dUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVCc6IHsnQUNDJzogMCwgJ0FDQSc6IDAsICdBQ0cnOiAwLCAnQUNUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVyc6IHsnVEdHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVic6IHsnR1RBJzogMCwgJ0dUQyc6IDAsICdHVFQnOiAwLCAnR1RHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWSc6IHsnVEFUJzogMCwgJ1RBQyc6IDB9fSkKCgogICAgZGVmIHRlc3Rfbm9ybWFsaXplX2dyb3VwZWRfY291bnRzXzMoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydTJzogeydBR1QnOiAwLjAsICdUQ0cnOiAwLjUsICdUQ1QnOiAwLjUsICdUQ0EnOiAwLjAsICdUQ0MnOiAwLjAsICdBR0MnOiAwLjB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyonOiB7J1RBQSc6IDAuMCwgJ1RHQSc6IDEuMCwgJ1RBRyc6IDAuMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTSc6IHsnQVRHJzogMS4wfX0sIHByb2plY3Qubm9ybWFsaXplX2dyb3VwZWRfY291bnRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7J0EnOiB7J0dDQSc6IDAsICdHQ0MnOiAwLCAnR0NUJzogMCwgJ0dDRyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0MnOiB7J1RHQyc6IDAsICdUR1QnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFJzogeydHQUcnOiAwLCAnR0FBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRCc6IHsnR0FUJzogMCwgJ0dBQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0cnOiB7J0dHVCc6IDAsICdHR0cnOiAwLCAnR0dBJzogMCwgJ0dHQyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0YnOiB7J1RUQyc6IDAsICdUVFQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdJJzogeydBVFQnOiAwLCAnQVRDJzogMCwgJ0FUQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0gnOiB7J0NBQyc6IDAsICdDQVQnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdLJzogeydBQUcnOiAwLCAnQUFBJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnKic6IHsnVEFHJzogMCwgJ1RHQSc6IDEsICdUQUEnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdNJzogeydBVEcnOiAxfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMJzogeydDVFQnOiAwLCAnQ1RHJzogMCwgJ0NUQSc6IDAsICdDVEMnOiAwLCAnVFRBJzogMCwgJ1RURyc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ04nOiB7J0FBVCc6IDAsICdBQUMnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdRJzogeydDQUEnOiAwLCAnQ0FHJzogMH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQJzogeydDQ1QnOiAwLCAnQ0NHJzogMCwgJ0NDQSc6IDAsICdDQ0MnOiAwfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTJzogeydUQ1QnOiA3LCAnQUdDJzogMCwgJ1RDRyc6IDcsICdBR1QnOiAwLCAnVENDJzogMCwgJ1RDQSc6IDB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1InOiB7J0FHRyc6IDAsICdDR0MnOiAwLCAnQ0dHJzogMCwgJ0NHQSc6IDAsICdBR0EnOiAwLCAnQ0dUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVCc6IHsnQUNDJzogMCwgJ0FDQSc6IDAsICdBQ0cnOiAwLCAnQUNUJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVyc6IHsnVEdHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVic6IHsnR1RBJzogMCwgJ0dUQyc6IDAsICdHVFQnOiAwLCAnR1RHJzogMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnWSc6IHsnVEFUJzogMCwgJ1RBQyc6IDB9fSkKCgoKQHVuaXR0ZXN0LnNraXBJZihmdW5jdGlvbl9ub3RfZGVmaW5lZChwcm9qZWN0LCAnY29kb25fdXNhZ2UnKSwgJ2NvZG9uX3VzYWdlJykKY2xhc3MgVGVzdENvZG9uQmlhcyhBbnZQcm9nVGVzdENhc2UpOgoKICAgIGRlZiB0ZXN0X2NvZG9uX3VzYWdlXzEoc2VsZik6CiAgICAgICAgc2VsZi5hc3NlcnRFcXVhbE5pY2UoeydNJzogeydBVEcnOiAxLjB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnKic6IHsnVEFBJzogMC4wLCAnVEFHJzogMC4wLCAnVEdBJzogMS4wfX0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0LmNvZG9uX3VzYWdlLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0FUR1RHQScpCgogICAgZGVmIHRlc3RfY29kb25fdXNhZ2VfMihzZWxmKToKICAgICAgICBzZWxmLmFzc2VydEVxdWFsTmljZSh7J1AnOiB7J0NDRyc6IDAuNSwgJ0NDVCc6IDAuMCwgJ0NDQSc6IDAuNSwgJ0NDQyc6IDAuMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnRCc6IHsnR0FUJzogMS4wLCAnR0FDJzogMC4wfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMJzogeydDVEMnOiAwLjIsICdUVEcnOiAwLjAsICdDVFQnOiAwLjIsICdDVEcnOiAwLjAsICdUVEEnOiAwLjYsICdDVEEnOiAwLjB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ00nOiB7J0FURyc6IDEuMH0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnSyc6IHsnQUFBJzogMS4wLCAnQUFHJzogMC4wfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDJzogeydUR0MnOiAxLjAsICdUR1QnOiAwLjB9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyonOiB7J1RBQSc6IDAuMCwgJ1RBRyc6IDAuMCwgJ1RHQSc6IDEuMH19LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvamVjdC5jb2Rvbl91c2FnZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBVEdUR0NHQVRDQ0FBQUFUVEFDQ0dDVFRUVEFUVEFDVENUR0EnKQoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICAjIGlmIEdSQURFX01PREU6CiAgICAjICAgIHVuaXR0ZXN0Lm1haW4oZmFpbGZhc3Q9RmFsc2UsIHRlc3RSdW5uZXI9QW52UHJvZ1Rlc3RSdW5uZXIpCiAgICAjIGVsc2U6CiAgICAjICAgIHVuaXR0ZXN0Lm1haW4oZmFpbGZhc3Q9VHJ1ZSwgdGVzdFJ1bm5lcj1BbnZQcm9nVGVzdFJ1bm5lcikKICAgIGNhc2VzID0gc3VpdGVGYWN0b3J5KCpjYXNlRmFjdG9yeSgpKQogICAgaWYgR1JBREVfTU9ERToKICAgICAgIGZhaWxmYXN0PUZhbHNlCiAgICBlbHNlOgogICAgICAgZmFpbGZhc3Q9VHJ1ZQogICAgcnVubmVyID0gQW52UHJvZ1Rlc3RSdW5uZXIoZmFpbGZhc3Q9ZmFpbGZhc3QpCiAgICB0ZXN0X3Jlc3VsdCA9IHJ1bm5lci5ydW4oY2FzZXMpCiAgICBzeXMuZXhpdChpbnQobm90IHRlc3RfcmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkp').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'test_codonbiasproject.py'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-light downloadthis  " id="dnldts23588"><i class="bi bi-download"></i> test_codonbiasproject.py </button></a> <a href="#dnldts7568" onclick="fetch('data:text/plain;base64,QVRHVEFUQ0FBQVRUR0dBVENBVFRUR1RUR0FBQVRHQUFBQUFBQ0NUQ0FUR0NUVEdUR1RBQVRUQUFBR0FBQUNUR0dUQUFBQUFHR0NUQUFUQ0FBVEdHQUFHR1RBQ1RHQUdBR1RBR0dBR0NUR0FUQVRUQUFBQVRUQ0FHVEdUQUNUQUFDVEdUQ0FHQ0FUR1RHQVRUQVRHQVRHQUdUQ0dUVEFUR0FUVFRUR0FHQ0dBQUFBVFRBQUFBQUFBR1RBQ1RHQ0FBQ0NBVEdBCkFUR0FBR0FHR0FUVEdUQUdHQUdBQUFUVEFUR0FHQUNUQUdBVEFBQVRBVENUQUFBR0dUQVRDR0NHQ0NUVEFUVEFBQUNHVENHVFRDQUdUQUdDQUFBQUdBQUdUVEdDR0dBVEFBR0dHQUNHQUFUVEFBQUdUVEFBVEdHR0FUQUNUVEdDVEFBQUFHVFRDQUFDR0FBVEFUQUFBQUNUQUFBVEdBVENBQ0FUVEdBQUFUVEFHVFRUVEdHQUFBVEFBQVRUQUNUR0FDQUdUQUFHQUdUQ0FUVEdBQUFUQUFBQUdBVEFHVEFDQUFBQUFBQUdBQUdBVEdDVENUVEFBR0FUR1RBVEdBR0FUQUFUQ0FHVEdBQUFDQUFHR0FUQUFDQVRUQUFBVEdBQUdBQUdDQ1RBRwpBVEdBQUFBVENHQ1RHVFRUVFRHQ1RUQ1RHR1RBQVRHR1RUQ0NBQUNUVFRDQUdHVENBVEFHQ0FHQUdDQUdUVFRDQ0FHVFRBR1RUVFRHVENUVFRUQ0FHQVRDQVRDR1RHQVRHQ0NUQVRHVFRUVEFHQUdDR1RHQ1RDQUdBQVRUVEFHQ0NBVFRDQ0FBR0NUVENHQ1RUVFRHQUFDVENBQUdHQUdUVFRHQUdBQVRBQUdHVEdHQ1RUQUNHQUdDQUFHQ0NBVENHVFRHQVRUVEdUVEdHQUNBQUFDQUNHQUdBVFRHQUNUVEFHVENUR1RDVEdHQ0FHR0NUQVRBVEdBQUdBVFRHVFRHR0FHQUFBQ0NUVEFDVENUVEdHQ0NUQVRHQUdBR0dDR1RBVFRBVENBQVRBVFRDQUNDQ0FHQ0NUQUNDVEdDQ1RHQUFUVFRDQ0FHR1RHQ0NDQUNHR1RBVENHQUdHQVRHQ1RUR0dHQUFHQ1RHR1RHVFRHQUNDQUdUQ1RHR0NHVEdBQ0NBVENDQUNUR0dHVFRHQUNUQ1RHR1RHVEdHQVRBQ0NHR1RDQUdHVENBVENDQUFDQUFHVEdDR0NHVEdDQ0FDR0NDVEFHQ0FHQUNHQVRBR0NDVEFHQUFBR0NUVFRHQUFBQ0NDR1RBVENDQVRHQUFBQ0NHQUFUQVRDQUFDVENUQUNDQ0FHQ1RHVENUVEFHQVRBR0NUVEdHR0FHVEdHQUdBR0dBQUFHVEFBVENUQUcKQVRHQUFBQUNUQ0NBQVRUQVRUVENUQVRUQVRDQVRHR0dDVENDQUFBVENUR0FDVEdHR0NBQUNDQVRHQ0FBQUFBQUNHR0NUR0FBR1RUQ1RBR0FDQUFDVFRUR0dDQVRUR0NUVEFDR0FHQUFHQUFBR1RDR1RDVENUR0NDQ0FDQ0dUQUNHQ0NBR0FDQ1RDQVRHVFRDQUFHQ0FUR0NUR0FHR0FBR0NBQ0dUR0dUQ0dUR0dDQVRDQUFBQVRDQVRDQVRDR0NBR0dBR0NBR0dUR0dHR0NBR0NUQ0FDVFRHQ0NUR0dUQVRHR1RHR0NBR0NUQUFBQUNBQUNHQ1RHQ0NUR1RUQVRDR0dUR1RHQ0NUR1RDQUFBVENBQ0dUR0NDQ1RUVENBR0dUVFRHR0FUVENHQ1RBVEFUVENDQVRUR1RHQ0FHQVRHQ0NUR0dDR0dUR1RHQ0NUR1RHR0NBQUNDQVRHR0NUQVRDR0dBR0FBR0NHR0dBR0NHQUNUQUFDR0NUR0NDQ1RHQUNBR0NDQ1RDQ0dUQVRDQ1RDVENUQVRDR0FHR0FDQ0FBQUFUQ1RHR0NUR0FUR0NHQ1RBR0NUQ0FUVFRDQ0FUR0FHR0FBQ0FBR0dBQUFBQVRDR0NBR0FHR0FHVENBQUdUR0dUR0FBQ1RDQVRUVEFBCkFUR0FBQUFBQUdUQVRHVFRUVEdUQ1RHVENUR0dHVEFBVEFUVFRHVENHQUFHQ0NDQ0FUR0dDVEdBR1RUVEdUQUFUR0FBR1RDQUFUQUdUQVRDQUFHVEdBVEdUVEFUR0FUR0FUQUdBQUFHVENHVEdDVEFDVFRDVEdBVFRHR0dBR0NBVEdHQUFBQ0NDVEFUVENBQ1RDQUdHVEFDQUNBR1RDQ0FUQVRUQUFBQUFDVFRBQ0NBQUFUVEFBVFRBVEdBVEFUQUFDVEFBQVRHQ1RDQ0FBR0NBR0FUQUFDVEFUQUFDVEdBVFRUVEFBQ0FDQ1RUVEdBQ1RBVEFUVEFUVEdHVEFUR0dBVEFHQ0dBVEFBVEdUR0FBQUFBVENUQ0FBQUdBR0FUR1RDR0NBQUNBVENBQVRHR0dBQ1RDVEFBQUFUQ1RBQ0NUR1RUVEFHQUdBQUdHR0dHVEdUVENDVEdBVENDVFRHR1RBQ0FDVEFBQ0dBVFRUVEdBQUdBQUFDQ1RBQ0NBQVRUQUdUVEFHQUFBQUdHQVRHQ0NBR0dBVFRHR0NUVFRDVENHVFRUQUFUR0FHVEFBQUdBR1RBVFRHQQo=').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'sample_orfs.txt'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-light downloadthis  " id="dnldts7568"><i class="bi bi-download"></i> sample_orfs.txt </button></a></p>
<p><a href="https://munch-group.org/bioinformatics/supplementary/project_files">https://munch-group.org/bioinformatics/supplementary/project_files</a></p>
<ul>
<li><code>sample_orfs.txt</code> contains open reading frame sequences you can work on.</li>
<li><code>codonbiasproject.py</code> is an empty file where you must write your code.</li>
<li><code>test_codonbiasproject.py</code> is the test program that lets you test the code you write in <code>codonbiasproject.py</code>.</li>
</ul>
<p>Now open each file in <em>VScode</em> and have a look at what is in <code>sample_orfs.txt</code>. (Do <em>not</em> change it in any way and do not save it after viewing. If VScode asks you if you want to save it before closing, say <em>no</em>.) How many sequences are there in each file?</p>
<p>As in the translation project, you will need a data structure that pairs each codon to the amino acid it encodes. This is an obvious use of a dictionary and at the top of <code>codonbiasproject.py</code> I have defined such a dictionary you can use. Defining it outside the functions means that it is visible inside all your functions (unless you define <em>another</em> variable called <code>codon_map</code> inside a function). Defining variables globally like this sometimes make sense if some value can be considered a <em>constant</em> in your program and is <em>never</em> changed.</p>
<blockquote class="blockquote">
<p>It is normally very bad programming style to access variables outside functions in this way because it may have all kinds of unexpected side effects across function calls. So make it a rule for yourself that code <em>inside</em> a function should never to access variables <em>outside</em> the function. The reason we define <code>codon_map</code> globally in this project is to help you understand that when Python cannot find a variable inside a function, it looks outside the function to find it. In this project, functions will find <code>codon_map</code> in this way. However, as I already said, you should <em>never</em> do this yourself. The chance that you make an unexpected mistake is overwhelming.</p>
</blockquote>
<p>The project is split into four parts:</p>
<ol type="1">
<li>Read an open reading frame (ORF) into your script and count the codons.</li>
<li>Group the codon counts by the amino acids the codons encode.</li>
<li>Convert counts to frequencies.</li>
<li>Build the data structure representing the codon bias information.</li>
</ol>
<section id="read-an-open-reading-frame-and-count-its-codons" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="read-an-open-reading-frame-and-count-its-codons">Read an open reading frame and count its codons</h2>
<section id="read-orfs-from-a-file" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="read-orfs-from-a-file">Read ORFs from a file</h3>
<p>You can use this code to read the ORFs into your script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">'sample_orfs.txt'</span>, <span class="st">'r'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>orf_list <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> line.strip()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    orf_list.append(seq)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Try to print the list to see it. Then pick out the first ORF in the list so you can use that to test your code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>test_orf <span class="op">=</span> orf_list[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="split-the-orf-into-codons" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="split-the-orf-into-codons">Split the ORF into codons</h3>
<p>You need a function that splits the ORF into codons. This one you have already implemented in the exercise about translating DNA â€“ and if, not here it is in my version to get you started.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_codons(orf):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    codon_list <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(orf)<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        codon_list.append(orf[i:i<span class="op">+</span><span class="dv">3</span>])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> codon_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Before you go on, make sure you understand/remember how this function works and what it returns.</p>
</section>
<section id="count-codons-in-an-orf" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="count-codons-in-an-orf">Count codons in an ORF</h3>
<p>Now you need to count the number of times each codon occurs in the ORF.</p>
<p><em>Write a function</em>, <code>count_codons</code>, that take one argument:</p>
<ol type="1">
<li>A string, which represents the open reading frame.</li>
</ol>
<p>The function must return:</p>
<ul>
<li>A dictionary where keys are strings representing codons and associated values are integers representing the number of times each codon occurs in the ORF given as argument.</li>
</ul>
<p>Example usage:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>count_codons(<span class="st">"ATGTCATCATGA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>should return:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'CTT'</span>: <span class="dv">0</span>, <span class="st">'ATG'</span>: <span class="dv">1</span>, <span class="st">'ACA'</span>: <span class="dv">0</span>, <span class="st">'ACG'</span>: <span class="dv">0</span>, <span class="st">'ATC'</span>: <span class="dv">0</span>, <span class="st">'AAC'</span>: <span class="dv">0</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'ATA'</span>: <span class="dv">0</span>, <span class="st">'AGG'</span>: <span class="dv">0</span>, <span class="st">'CCT'</span>: <span class="dv">0</span>, <span class="st">'ACT'</span>: <span class="dv">0</span>, <span class="st">'AGC'</span>: <span class="dv">0</span>, <span class="st">'AAG'</span>: <span class="dv">0</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'AGA'</span>: <span class="dv">0</span>, <span class="st">'CAT'</span>: <span class="dv">0</span>, <span class="st">'AAT'</span>: <span class="dv">0</span>, <span class="st">'ATT'</span>: <span class="dv">0</span>, <span class="st">'CTG'</span>: <span class="dv">0</span>, <span class="st">'CTA'</span>: <span class="dv">0</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'CTC'</span>: <span class="dv">0</span>, <span class="st">'CAC'</span>: <span class="dv">0</span>, <span class="st">'AAA'</span>: <span class="dv">0</span>, <span class="st">'CCG'</span>: <span class="dv">0</span>, <span class="st">'AGT'</span>: <span class="dv">0</span>, <span class="st">'CCA'</span>: <span class="dv">0</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'CAA'</span>: <span class="dv">0</span>, <span class="st">'CCC'</span>: <span class="dv">0</span>, <span class="st">'TAT'</span>: <span class="dv">0</span>, <span class="st">'GGT'</span>: <span class="dv">0</span>, <span class="st">'TGT'</span>: <span class="dv">0</span>, <span class="st">'CGA'</span>: <span class="dv">0</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'CAG'</span>: <span class="dv">0</span>, <span class="st">'TCT'</span>: <span class="dv">0</span>, <span class="st">'GAT'</span>: <span class="dv">0</span>, <span class="st">'CGG'</span>: <span class="dv">0</span>, <span class="st">'TTT'</span>: <span class="dv">0</span>, <span class="st">'TGC'</span>: <span class="dv">0</span>, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'GGG'</span>: <span class="dv">0</span>, <span class="st">'TAG'</span>: <span class="dv">0</span>, <span class="st">'GGA'</span>: <span class="dv">0</span>, <span class="st">'TGG'</span>: <span class="dv">0</span>, <span class="st">'GGC'</span>: <span class="dv">0</span>, <span class="st">'TAC'</span>: <span class="dv">0</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'TTC'</span>: <span class="dv">0</span>, <span class="st">'TCG'</span>: <span class="dv">0</span>, <span class="st">'TTA'</span>: <span class="dv">0</span>, <span class="st">'TTG'</span>: <span class="dv">0</span>, <span class="st">'TCC'</span>: <span class="dv">0</span>, <span class="st">'ACC'</span>: <span class="dv">0</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'TAA'</span>: <span class="dv">0</span>, <span class="st">'GCA'</span>: <span class="dv">0</span>, <span class="st">'GTA'</span>: <span class="dv">0</span>, <span class="st">'GCC'</span>: <span class="dv">0</span>, <span class="st">'GTC'</span>: <span class="dv">0</span>, <span class="st">'GCG'</span>: <span class="dv">0</span>, </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'GTG'</span>: <span class="dv">0</span>, <span class="st">'GAG'</span>: <span class="dv">0</span>, <span class="st">'GTT'</span>: <span class="dv">0</span>, <span class="st">'GCT'</span>: <span class="dv">0</span>, <span class="st">'TGA'</span>: <span class="dv">1</span>, <span class="st">'GAC'</span>: <span class="dv">0</span>, </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'CGT'</span>: <span class="dv">0</span>, <span class="st">'GAA'</span>: <span class="dv">0</span>, <span class="st">'TCA'</span>: <span class="dv">2</span>, <span class="st">'CGC'</span>: <span class="dv">0</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>â€“ though not necessarily with key-value pairs in that order.</p>
<p>In the function, you should use the <code>split_codons</code> function to split the ORF into a list of codons. Then create an empty dictionary that you can populate with counts. You want <em>all</em> the possible codons to be in your dictionary. That way, the codons you do <em>not</em> find in your ORF will have a count of <code>0</code>. In this case, such absence is also valuable information. To achieve this you must start by filling the dictionary with a key for each codon and give each a count of <code>0</code>. You can do that by iterating over the keys in the dictionary that maps codons to amino acids. Then you must iterate over all the codons in the list of codons produced by the <code>split_codons</code> function and add counts to the dictionary as you go.</p>
</section>
</section>
<section id="group-codon-counts-by-amino-acid" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="group-codon-counts-by-amino-acid">Group codon counts by amino acid</h2>
<p>Having counted how many times each codon appears in the ORF, you need to group the counted codons by the amino acid they encode.</p>
<p><em>Write a function</em>, <code>group_counts_by_amino_acid</code>, which takes one argument:</p>
<ol type="1">
<li>A dictionary, as that returned by <code>count_codons</code>.</li>
</ol>
<p>The function must return:</p>
<ul>
<li>A dictionary of dictionaries, which pairs each amino acid with a dictionary with counts of how many times each codon is used to encode that amino acid in the ORF.</li>
</ul>
<p>Example usage: Assuming <code>counts</code> is the dictionary returned by <code>count_codons</code> as in the previous example.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>grouped_counts <span class="op">=</span> group_counts_by_amino_acid(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>then <code>group_counts_by_amino_acid</code> should return:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'A'</span>: {<span class="st">'GCA'</span>: <span class="dv">0</span>, <span class="st">'GCC'</span>: <span class="dv">0</span>, <span class="st">'GCT'</span>: <span class="dv">0</span>, <span class="st">'GCG'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'C'</span>: {<span class="st">'TGC'</span>: <span class="dv">0</span>, <span class="st">'TGT'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'E'</span>: {<span class="st">'GAG'</span>: <span class="dv">0</span>, <span class="st">'GAA'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'D'</span>: {<span class="st">'GAT'</span>: <span class="dv">0</span>, <span class="st">'GAC'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'G'</span>: {<span class="st">'GGT'</span>: <span class="dv">0</span>, <span class="st">'GGG'</span>: <span class="dv">0</span>, <span class="st">'GGA'</span>: <span class="dv">0</span>, <span class="st">'GGC'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'F'</span>: {<span class="st">'TTC'</span>: <span class="dv">0</span>, <span class="st">'TTT'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'I'</span>: {<span class="st">'ATT'</span>: <span class="dv">0</span>, <span class="st">'ATC'</span>: <span class="dv">0</span>, <span class="st">'ATA'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'H'</span>: {<span class="st">'CAC'</span>: <span class="dv">0</span>, <span class="st">'CAT'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'K'</span>: {<span class="st">'AAG'</span>: <span class="dv">0</span>, <span class="st">'AAA'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'*'</span>: {<span class="st">'TAG'</span>: <span class="dv">0</span>, <span class="st">'TGA'</span>: <span class="dv">1</span>, <span class="st">'TAA'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'M'</span>: {<span class="st">'ATG'</span>: <span class="dv">1</span>}, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a> <span class="st">'L'</span>: {<span class="st">'CTT'</span>: <span class="dv">0</span>, <span class="st">'CTG'</span>: <span class="dv">0</span>, <span class="st">'CTA'</span>: <span class="dv">0</span>, <span class="st">'CTC'</span>: <span class="dv">0</span>, <span class="st">'TTA'</span>: <span class="dv">0</span>, <span class="st">'TTG'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a> <span class="st">'N'</span>: {<span class="st">'AAT'</span>: <span class="dv">0</span>, <span class="st">'AAC'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a> <span class="st">'Q'</span>: {<span class="st">'CAA'</span>: <span class="dv">0</span>, <span class="st">'CAG'</span>: <span class="dv">0</span>},</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a> <span class="st">'P'</span>: {<span class="st">'CCT'</span>: <span class="dv">0</span>, <span class="st">'CCG'</span>: <span class="dv">0</span>, <span class="st">'CCA'</span>: <span class="dv">0</span>, <span class="st">'CCC'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a> <span class="st">'S'</span>: {<span class="st">'TCT'</span>: <span class="dv">0</span>, <span class="st">'AGC'</span>: <span class="dv">0</span>, <span class="st">'TCG'</span>: <span class="dv">0</span>, <span class="st">'AGT'</span>: <span class="dv">0</span>, <span class="st">'TCC'</span>: <span class="dv">0</span>, <span class="st">'TCA'</span>: <span class="dv">2</span>}, </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a> <span class="st">'R'</span>: {<span class="st">'AGG'</span>: <span class="dv">0</span>, <span class="st">'CGC'</span>: <span class="dv">0</span>, <span class="st">'CGG'</span>: <span class="dv">0</span>, <span class="st">'CGA'</span>: <span class="dv">0</span>, <span class="st">'AGA'</span>: <span class="dv">0</span>, <span class="st">'CGT'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a> <span class="st">'T'</span>: {<span class="st">'ACC'</span>: <span class="dv">0</span>, <span class="st">'ACA'</span>: <span class="dv">0</span>, <span class="st">'ACG'</span>: <span class="dv">0</span>, <span class="st">'ACT'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a> <span class="st">'W'</span>: {<span class="st">'TGG'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a> <span class="st">'V'</span>: {<span class="st">'GTA'</span>: <span class="dv">0</span>, <span class="st">'GTC'</span>: <span class="dv">0</span>, <span class="st">'GTT'</span>: <span class="dv">0</span>, <span class="st">'GTG'</span>: <span class="dv">0</span>}, </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a> <span class="st">'Y'</span>: {<span class="st">'TAT'</span>: <span class="dv">0</span>, <span class="st">'TAC'</span>: <span class="dv">0</span>}}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>â€“ though not necessarily with key-value pairs in that order.</p>
<p>So if we pretend the resulting dictionary of dictionaries is called <code>d</code>, then <code>d['S']</code> will be a dictionary where keys are codons encoding the â€˜Sâ€™ amino acid and the values are the counts of those codons. That means that you can access a particular count like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d[<span class="st">'S'</span>][<span class="st">'TCA'</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the above example, this count is <code>2</code>. So the task is really just to distribute counts given as the first argument into groups for each amino acid. Depending on what you call your variables it could look something like this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>grouped_counts[acid][codon] <span class="op">=</span> codon_counts[codon]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Your function should begin by defining an empty dictionary to add to. Then use a for-loop to run through all codon/amino-acid pairs and populate your dictionary of dictionaries.</p>
</section>
<section id="turn-counts-into-frequencies" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="turn-counts-into-frequencies">Turn counts into frequencies</h2>
<p>Now you know how many times each codon represents a certain amino acid, but we would like to know with which <em>frequency</em> a certain codon represents an amino acid. So you need to normalize the counts so they become frequencies. You do that by dividing each codon count by the total number of codons encoding the same amino acid. We split the solution to this problem in two. We first write a helper function that turns codon counts for <em>one</em> amino acid into frequencies.</p>
<p><em>Write a function</em>, <code>normalize_counts</code>, which takes one argument:</p>
<ol type="1">
<li>A dictionary, where keys are strings representing codons and values are integers representing the counts of these codons.</li>
</ol>
<p>The function must return:</p>
<ul>
<li>A dictionary, where keys are strings representing codons and values are floats representing the frequency at which each codon appear. That is, the count of that codon divided by the total of all codon counts in the dictionary. The frequencies for codons that encode the same amino acid must of sum to one. That means that in cases where the total count is zero, the function must return <code>None</code>.</li>
</ul>
<p>Example usage:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>normalize_counts({<span class="st">'ATT'</span>: <span class="dv">8</span>, <span class="st">'ATC'</span>: <span class="dv">10</span>, <span class="st">'ATA'</span>: <span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>should return:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'ATC'</span>: <span class="fl">0.5</span>, <span class="st">'ATA'</span>: <span class="fl">0.1</span>, <span class="st">'ATT'</span>: <span class="fl">0.4</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>â€“ though not necessarily with key-value pairs in that order.</p>
<p>Now you have solved part of the task, what remains is to now use that function to normalise the codon counts of <em>each</em> amino acid in your grouped counts:</p>
<p><em>Write a function</em>, <code>normalize_grouped_counts</code>, which takes one argument:</p>
<ol type="1">
<li>A dictionary of dictionaries, as that returned by <code>group_counts_by_amino_acid</code>.</li>
</ol>
<p>The function must return:</p>
<ul>
<li>A new dictionary of dictionaries where the values of the inner dictionaries are frequencies instead of counts as in the example in the introduction. You should not include amino acids for which there are no counted codons.</li>
</ul>
<p>Example usage: Assuming <code>gr_counts</code> is the dictionary of dictionaries returned by <code>grouped_group_counts_by_amino_acid</code> in the example above.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>normalize_grouped_counts(gr_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>should return:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>{<span class="st">'*'</span>: {<span class="st">'TAA'</span>: <span class="fl">0.0</span>, <span class="st">'TGA'</span>: <span class="fl">1.0</span>, <span class="st">'TAG'</span>: <span class="fl">0.0</span>}, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">'M'</span>: {<span class="st">'ATG'</span>: <span class="fl">1.0</span>}, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">'S'</span>: {<span class="st">'AGC'</span>: <span class="fl">0.0</span>, <span class="st">'TCG'</span>: <span class="fl">0.0</span>, <span class="st">'TCC'</span>: <span class="fl">0.0</span>, <span class="st">'TCT'</span>: <span class="fl">0.0</span>, <span class="st">'AGT'</span>: <span class="fl">0.0</span>, <span class="st">'TCA'</span>: <span class="fl">1.0</span>}}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>â€“ though not necessarily with key-value pairs in that order.</p>
<p>Here is some help to get you started:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_grouped_counts(grouped_counts):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    grouped_freqs <span class="op">=</span> {}</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> aa <span class="kw">in</span> grouped_counts:</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        counts <span class="op">=</span> grouped_counts[aa]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Amino acids with no codon counts should <em>not</em> be part of the data structure. Remember that in this case <code>normalize_counts</code> returns <code>None</code>, so you can simply test if the return value from <code>normalize_counts</code> is <code>None</code></p>
</section>
<section id="compute-the-codon-usage" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="compute-the-codon-usage">Compute the codon usage</h2>
<p>Now all that remains is to tie together the functions you have written in a final function that generates your big data structure from an ORF:</p>
<p>Write a function, <code>codon_usage</code>, which takes one argument:</p>
<ol type="1">
<li>A string, which is an ORF.</li>
</ol>
<p>The function must return:</p>
<ul>
<li>A dictionary of dictionaries, same as that returned by <code>normalize_grouped_counts</code>.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/project/alignment_project.html" class="pagination-link" aria-label="Pairwise alignment">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Pairwise alignment</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/project/hiv_project.html" class="pagination-link" aria-label="HIV sub-groups">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">HIV sub-groups</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>