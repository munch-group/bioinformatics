<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>49&nbsp; Models of DNA Evolution – Bioinformatics and Programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/bioinformatics/phylogenetics.html" rel="next">
<link href="../../chapters/project/seqdist_project/index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7348364bef02e149b83741bff427fbde.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7265a01e67a7770ed9b564cd1d2c99b1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/preface.html">Bioinformatics</a></li><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/models_of_dna_evolution.html"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Models of DNA Evolution</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Content</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Exam information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../curriculum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Curriculum</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Learning Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/before_you_begin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Before you begin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/writing_a_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing a program</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dealing_with_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dealing with values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/the_order_of_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The order of events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/course_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Course tools</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/controlling_behavior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Controlling behavior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/organizing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Organizing code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/python_values_are_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Values are objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Lists of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dictionaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pairs of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/gluing_values_in_sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grouping values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/iteration_over_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Iterating values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/working_with_data_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Structuring data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/unleash_your_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recursion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/testing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Testing your code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/your_own_types_of_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Your Own Types of Objects: Python Classes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/using_code_from_other_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Code in other files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/on_the_shoulders_of_giants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Giant’s shoulders</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/appendix_bsf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Appendix: PyMol for BSF</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bioinformatics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/association.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Genome-Wide Association Studies: From Statistical Foundations to Clinical Applications</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/gwas_databases/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">GWAS candidates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/database_searching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Sequence Database Searching and BLAST</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/translation_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Translating ORFs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/hidden_markov_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Hidden Markov Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/new_hmm_exercise/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Membrane proteins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/orf_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Finding genes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/neural_networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/folding_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Primer analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/assembly_and_mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Genome Sequencing, Assembly, and Read Mapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/assembly_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Genome assembly</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/pairwise_global_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Pairwise Global Sequence Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/pairwise_local_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Pairwise global alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/multiple_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multiple Sequence Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/alignment_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Pairwise alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/ccr5_pwalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">CCR5-delta32</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/protein_substitution_matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Protein Substitution Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/database_searching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Sequence Database Searching and BLAST</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/mrsa_blast_multalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">MRSA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/hiv_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">HIV sub-groups</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/multiple_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multiple Sequence Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Clustering of sequences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/seqdist_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sequence trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/models_of_dna_evolution.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Models of DNA Evolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/phylogenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Phylogenetics: Tree-Based Analysis of Evolutionary Relationships</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/aardwark_seqdist/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Aardvark?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/orf_finding/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Plasmid ORFs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Supplementary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/project_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/recordings2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture recordings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/slides2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/bioinformatics_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Databases and resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exam info</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/trouble_shooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trouble shooting</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-why-model-dna-evolution" id="toc-introduction-why-model-dna-evolution" class="nav-link active" data-scroll-target="#introduction-why-model-dna-evolution"><span class="header-section-number">49.1</span> Introduction: Why Model DNA Evolution?</a></li>
  <li><a href="#the-fundamental-challenge-multiple-substitutions" id="toc-the-fundamental-challenge-multiple-substitutions" class="nav-link" data-scroll-target="#the-fundamental-challenge-multiple-substitutions"><span class="header-section-number">49.2</span> The Fundamental Challenge: Multiple Substitutions</a></li>
  <li><a href="#a-model-of-dna-evolution" id="toc-a-model-of-dna-evolution" class="nav-link" data-scroll-target="#a-model-of-dna-evolution"><span class="header-section-number">49.3</span> A model of DNA evolution</a></li>
  <li><a href="#the-jukes-cantor-model-simplicity-and-symmetry" id="toc-the-jukes-cantor-model-simplicity-and-symmetry" class="nav-link" data-scroll-target="#the-jukes-cantor-model-simplicity-and-symmetry"><span class="header-section-number">49.4</span> The Jukes-Cantor Model: Simplicity and Symmetry</a>
  <ul class="collapse">
  <li><a href="#model-assumptions-and-structure" id="toc-model-assumptions-and-structure" class="nav-link" data-scroll-target="#model-assumptions-and-structure"><span class="header-section-number">49.4.1</span> Model Assumptions and Structure</a></li>
  <li><a href="#deriving-transition-probabilities" id="toc-deriving-transition-probabilities" class="nav-link" data-scroll-target="#deriving-transition-probabilities"><span class="header-section-number">49.4.2</span> Deriving Transition Probabilities</a></li>
  <li><a href="#worked-example-computing-transition-probabilities" id="toc-worked-example-computing-transition-probabilities" class="nav-link" data-scroll-target="#worked-example-computing-transition-probabilities"><span class="header-section-number">49.4.3</span> Worked Example: Computing Transition Probabilities</a></li>
  <li><a href="#two-sequence-divergence" id="toc-two-sequence-divergence" class="nav-link" data-scroll-target="#two-sequence-divergence"><span class="header-section-number">49.4.4</span> Two-Sequence Divergence</a></li>
  <li><a href="#distance-correction-formula" id="toc-distance-correction-formula" class="nav-link" data-scroll-target="#distance-correction-formula"><span class="header-section-number">49.4.5</span> Distance Correction Formula</a></li>
  <li><a href="#numerical-example-distance-correction" id="toc-numerical-example-distance-correction" class="nav-link" data-scroll-target="#numerical-example-distance-correction"><span class="header-section-number">49.4.6</span> Numerical Example: Distance Correction</a></li>
  <li><a href="#saturation-and-model-limitations" id="toc-saturation-and-model-limitations" class="nav-link" data-scroll-target="#saturation-and-model-limitations"><span class="header-section-number">49.4.7</span> Saturation and Model Limitations</a></li>
  <li><a href="#properties-and-insights" id="toc-properties-and-insights" class="nav-link" data-scroll-target="#properties-and-insights"><span class="header-section-number">49.4.8</span> Properties and Insights</a></li>
  </ul></li>
  <li><a href="#the-kimura-two-parameter-model-transitions-and-transversions" id="toc-the-kimura-two-parameter-model-transitions-and-transversions" class="nav-link" data-scroll-target="#the-kimura-two-parameter-model-transitions-and-transversions"><span class="header-section-number">49.5</span> The Kimura Two-Parameter Model: Transitions and Transversions</a></li>
  <li><a href="#tamuras-tre-parameter-model" id="toc-tamuras-tre-parameter-model" class="nav-link" data-scroll-target="#tamuras-tre-parameter-model"><span class="header-section-number">50</span> Tamuras tre-parameter model</a>
  <ul class="collapse">
  <li><a href="#the-felsenstein-81-model-unequal-base-frequencies" id="toc-the-felsenstein-81-model-unequal-base-frequencies" class="nav-link" data-scroll-target="#the-felsenstein-81-model-unequal-base-frequencies"><span class="header-section-number">50.1</span> The Felsenstein 81 Model: Unequal Base Frequencies</a></li>
  <li><a href="#the-hky85-model-combining-biological-realism" id="toc-the-hky85-model-combining-biological-realism" class="nav-link" data-scroll-target="#the-hky85-model-combining-biological-realism"><span class="header-section-number">50.2</span> The HKY85 Model: Combining Biological Realism</a></li>
  <li><a href="#the-general-time-reversible-model-maximum-flexibility" id="toc-the-general-time-reversible-model-maximum-flexibility" class="nav-link" data-scroll-target="#the-general-time-reversible-model-maximum-flexibility"><span class="header-section-number">50.3</span> The General Time Reversible Model: Maximum Flexibility</a></li>
  <li><a href="#rate-heterogeneity-the-gamma-distribution" id="toc-rate-heterogeneity-the-gamma-distribution" class="nav-link" data-scroll-target="#rate-heterogeneity-the-gamma-distribution"><span class="header-section-number">50.4</span> Rate Heterogeneity: The Gamma Distribution</a></li>
  <li><a href="#invariant-sites-accounting-for-functional-constraints" id="toc-invariant-sites-accounting-for-functional-constraints" class="nav-link" data-scroll-target="#invariant-sites-accounting-for-functional-constraints"><span class="header-section-number">50.5</span> Invariant Sites: Accounting for Functional Constraints</a></li>
  <li><a href="#codon-models-the-genetic-codes-influence" id="toc-codon-models-the-genetic-codes-influence" class="nav-link" data-scroll-target="#codon-models-the-genetic-codes-influence"><span class="header-section-number">50.6</span> Codon Models: The Genetic Code’s Influence</a></li>
  <li><a href="#context-dependent-evolution-beyond-independence" id="toc-context-dependent-evolution-beyond-independence" class="nav-link" data-scroll-target="#context-dependent-evolution-beyond-independence"><span class="header-section-number">50.7</span> Context-Dependent Evolution: Beyond Independence</a></li>
  <li><a href="#model-selection-choosing-appropriate-complexity" id="toc-model-selection-choosing-appropriate-complexity" class="nav-link" data-scroll-target="#model-selection-choosing-appropriate-complexity"><span class="header-section-number">50.8</span> Model Selection: Choosing Appropriate Complexity</a></li>
  <li><a href="#practical-applications-from-theory-to-practice" id="toc-practical-applications-from-theory-to-practice" class="nav-link" data-scroll-target="#practical-applications-from-theory-to-practice"><span class="header-section-number">50.9</span> Practical Applications: From Theory to Practice</a></li>
  <li><a href="#limitations-and-future-directions" id="toc-limitations-and-future-directions" class="nav-link" data-scroll-target="#limitations-and-future-directions"><span class="header-section-number">50.10</span> Limitations and Future Directions</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">50.11</span> Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/preface.html">Bioinformatics</a></li><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/models_of_dna_evolution.html"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Models of DNA Evolution</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Models of DNA Evolution</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction-why-model-dna-evolution" class="level2" data-number="49.1">
<h2 data-number="49.1" class="anchored" data-anchor-id="introduction-why-model-dna-evolution"><span class="header-section-number">49.1</span> Introduction: Why Model DNA Evolution?</h2>
<p>The study of molecular evolution requires mathematical frameworks to understand how DNA sequences change over time. When we observe two DNA sequences from different species, we see differences that have accumulated through evolutionary history. However, the observed differences represent only the net result of a complex process involving multiple substitutions, back-mutations, and parallel changes occurring over millions of years. Models of DNA evolution provide the mathematical machinery to infer evolutionary relationships, estimate divergence times, and understand the mechanisms driving genetic change.</p>
<p>Consider two homologous DNA sequences that diverged from a common ancestor. The simple count of differences between them underestimates the true number of substitutions that occurred because some positions may have experienced multiple changes. A position that appears identical in both sequences might have undergone substitution followed by reversion to the original state. Similarly, convergent evolution might cause independent substitutions to the same nucleotide. Models of DNA evolution allow us to account for these hidden substitutions and provide more accurate estimates of evolutionary distances.</p>
<p>The importance of evolutionary models extends far beyond theoretical interest. These models form the foundation for phylogenetic reconstruction, enabling us to infer the tree of life from molecular data. They allow us to date evolutionary events, identify sites under selection, and understand patterns of molecular evolution across genomes. In practical applications, evolutionary models help track viral evolution, predict drug resistance mutations, and identify functionally important genomic regions through comparative analysis.</p>
</section>
<section id="the-fundamental-challenge-multiple-substitutions" class="level2" data-number="49.2">
<h2 data-number="49.2" class="anchored" data-anchor-id="the-fundamental-challenge-multiple-substitutions"><span class="header-section-number">49.2</span> The Fundamental Challenge: Multiple Substitutions</h2>
<p>The central challenge in modeling DNA evolution lies in accounting for multiple substitutions at the same site. When sequences diverge over long evolutionary periods, the probability increases that any given position experiences more than one substitution. This phenomenon, known as multiple hits or homoplasy, causes the observed sequence divergence to plateau even as evolutionary time continues to increase.</p>
<p>To illustrate this concept, imagine tracking a single nucleotide position over evolutionary time. Starting with adenine (A), it might mutate to guanine (G), then to thymine (T), and finally back to adenine. An observer comparing only the initial and final states would see no change, missing the three substitutions that actually occurred. This saturation effect becomes increasingly important as sequences diverge, making simple similarity measures inadequate for estimating evolutionary distances.</p>
<p>The mathematical framework for handling multiple substitutions involves continuous-time Markov chains. These models treat nucleotide substitution as a stochastic process where the probability of change depends only on the current state, not on the sequence’s history. The Markov property—memorylessness—simplifies the mathematics while capturing the essential features of the substitution process. The models specify instantaneous rates of change between nucleotides, from which we can derive the probabilities of observing particular nucleotide pairs after any amount of evolutionary time.</p>
</section>
<section id="a-model-of-dna-evolution" class="level2" data-number="49.3">
<h2 data-number="49.3" class="anchored" data-anchor-id="a-model-of-dna-evolution"><span class="header-section-number">49.3</span> A model of DNA evolution</h2>
<p>We need a model that decribes the evolution of DNA. If the base at some position in a DNA sequence is <span class="math inline">\(y \in {A, T, C, G}\)</span>, we would like to know the probability that it is <span class="math inline">\(x \in {A, T, C, G}\)</span> after some time bas passed. This is a complicated task, so let’s break it into simpler steps.</p>
<p>To model how the base at some DNA position changes over time, we need a way to represent the probability that the base is either a <span class="math inline">\(A\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(G\)</span>, or <span class="math inline">\(C\)</span> at some point in time <span class="math inline">\(t\)</span>. We write those four probabilities as <span class="math inline">\(p_A(t)\)</span>, <span class="math inline">\(p_T(t)\)</span>, <span class="math inline">\(p_G(t)\)</span>, and <span class="math inline">\(p_C(t)\)</span>. We also need the probabilities that one base changes into another in a tiny span of time <span class="math inline">\(\Delta t\)</span>. We call these substitution rates and write the rate of change from base <span class="math inline">\(x\)</span> into base <span class="math inline">\(y\)</span> as <span class="math inline">\(\mu_{xy}\)</span>.</p>
<p>Let’s for the sake of argument pretend that we know those probabilities. Then the model DNA evolution we need is one that uses those probabilities to compute, say, <span class="math inline">\(p_A(t+\Delta t)\)</span>, the probability that our base is <span class="math inline">\(A\)</span> after some tiny bit of extra time <span class="math inline">\(\Delta t\)</span>:</p>
<p><span class="math display">\[
p_A(t+\Delta t) = p_A(t) - p_A(t)\, \mu_{\bullet A} \Delta t + \sum_{x \neq A} p_x(t) \, \mu_{xA} \Delta t
\]</span></p>
<p>where <span class="math inline">\(\mu_{\bullet A} = \sum_{x \neq A} \mu_{Ax}\)</span> is the total probability that a <span class="math inline">\(T\)</span>, <span class="math inline">\(G\)</span>, <span class="math inline">\(C\)</span> mutates into an <span class="math inline">\(A\)</span>.</p>
<p>The formula has three terms:</p>
<ol type="1">
<li>The probability that the base was <span class="math inline">\(A\)</span> at time <span class="math inline">\(t\)</span>: <span class="math inline">\(p_A(t)\)</span></li>
<li>The probability that the base was <span class="math inline">\(A\)</span> at time <span class="math inline">\(t\)</span>, but changed into <em>another</em> base after <span class="math inline">\(\Delta t\)</span>: <span class="math inline">\(p_A(t)\, \mu_{\bullet A} \Delta t\)</span></li>
<li>The probability that the base was <em>not</em> <span class="math inline">\(A\)</span> but changed <em>into</em> <span class="math inline">\(A\)</span> after <span class="math inline">\(\sum_{x \neq A} p_x(t) \, \mu_{xA} \Delta t\)</span></li>
</ol>
<p>We can write this equation for each base and merge them into a single equation: <span class="math display">\[
\mathbf{p}(t + \Delta t) = \mathbf{p}(t) + \mathbf{p}(t)Q\Delta t
\]</span></p>
<p>where <span class="math display">\[
\mathbf{p}(t) = (p_A(t),\ p_C(t),\ p_G(t),\ p_T(t))
\]</span> is a vector of the four probabilities and <span class="math inline">\(Q\)</span> is a matrix of all the substitution rates:</p>
<p><span class="math display">\[
Q = \begin{pmatrix}
-\mu_{\bullet A} &amp; \mu_{AG} &amp; \mu_{AC} &amp; \mu_{AT} \\
\mu_{GA} &amp; -\mu_{\bullet G} &amp; \mu_{GC} &amp; \mu_{GT} \\
\mu_{CA} &amp; \mu_{CG} &amp; -\mu_{\bullet C} &amp;\mu_{CT} \\
\mu_{TA} &amp; \mu_{TG} &amp; \mu_{TC} &amp; -\mu_{\bullet T}
\end{pmatrix}
\]</span></p>
</section>
<section id="the-jukes-cantor-model-simplicity-and-symmetry" class="level2" data-number="49.4">
<h2 data-number="49.4" class="anchored" data-anchor-id="the-jukes-cantor-model-simplicity-and-symmetry"><span class="header-section-number">49.4</span> The Jukes-Cantor Model: Simplicity and Symmetry</h2>
<p>The Jukes-Cantor (JC69) model, proposed in 1969, represents the simplest mathematical description of DNA evolution. This model assumes that all substitutions occur at the same rate and that all nucleotides have equal equilibrium frequencies. Despite its simplicity, or perhaps because of it, the JC69 model provides fundamental insights into the relationship between observed differences and actual evolutionary distances.</p>
<section id="model-assumptions-and-structure" class="level3" data-number="49.4.1">
<h3 data-number="49.4.1" class="anchored" data-anchor-id="model-assumptions-and-structure"><span class="header-section-number">49.4.1</span> Model Assumptions and Structure</h3>
<p>The JC69 model makes several simplifying assumptions: 1. All nucleotides (A, C, G, T) have equal equilibrium frequencies (πA = πC = πG = πT = 0.25) 2. All substitutions occur at the same rate α 3. The substitution process is time-reversible 4. Sites evolve independently 5. The substitution rate is constant over time (molecular clock)</p>
<p>Under the JC69 model, each nucleotide has an equal probability of mutating to any of the three other nucleotides.</p>
<hr>
<p><span class="math display">\[
\alpha = \frac{1}{4} \times \mu
\]</span></p>
<p><span class="math display">\[
Q = \begin{pmatrix}
-3\alpha &amp; \alpha &amp; \alpha &amp; \alpha \\
  \alpha &amp; -3\alpha &amp; \alpha &amp; \alpha \\
  \alpha &amp; \alpha &amp; -3\alpha &amp; \alpha \\
  \alpha &amp; \alpha &amp; \alpha &amp; -3\alpha
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
Q = \begin{pmatrix}
-\frac{3\mu}{4} &amp; \frac{\mu}{4} &amp; \frac{\mu}{4} &amp; \frac{\mu}{4} \\
\frac{\mu}{4} &amp; -\frac{3\mu}{4} &amp; \frac{\mu}{4} &amp; \frac{\mu}{4} \\
\frac{\mu}{4} &amp; \frac{\mu}{4} &amp; -\frac{3\mu}{4} &amp; \frac{\mu}{4} \\
\frac{\mu}{4} &amp; \frac{\mu}{4} &amp; \frac{\mu}{4} &amp; -\frac{3\mu}{4} \\
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
P(t) = \exp(tQ)
\]</span></p>
<p><span class="math display">\[
P = \begin{pmatrix}
\frac{1}{4}+\frac{3}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} \\
\frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}+\frac{3}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} \\
\frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}+\frac{3}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} \\
\frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \frac{1}{4}+\frac{3}{4}e^{-\mu t} \\
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
\nu = \bigg(\frac{\mu}{4} + \frac{\mu}{4} + \frac{\mu}{4}\bigg)t \implies t\mu = \frac{4}{3}\nu
\]</span></p>
<p>Measuing time in actual mutations, <span class="math inline">\(\nu\)</span>, we get</p>
<p><span class="math display">\[
P_{ij} = \begin{cases}
    \frac{1}{4}+\frac{3}{4}e^{-\mu t} &amp; \text{if} &amp; i = j \\
    \frac{1}{4}-\frac{1}{4}e^{-\mu t} &amp; \text{if} &amp; i \neq j
\end{cases}
\]</span></p>
<p>We can estimate the total observed substitution rate, <span class="math inline">\(p\)</span>, as the fraction of base positions that mutated between two sequences:</p>
<p><span class="math display">\[
p = 3\times \bigg(\frac{1}{4} - \frac{1}{4} e^{-4\nu/3} \bigg)= \frac{3}{4} - \frac{3}{4} e^{-4\nu/3}
\]</span> —</p>
<p>Now, if we isolate <span class="math inline">\(\nu\)</span>, we get the formula for the Jukes-Cantor correction:</p>
<p><span class="math display">\[
\nu = -\frac{3}{4} \ln(1-\frac{4}{3}p)
\]</span></p>
<p>If we denote the substitution rate as α, then the rate matrix Q describing instantaneous rates of change is:</p>
<p><span class="math display">\[
Q = \begin{pmatrix}
-3\alpha &amp; \alpha &amp; \alpha &amp; \alpha \\
\alpha &amp; -3\alpha &amp; \alpha &amp; \alpha \\
\alpha &amp; \alpha &amp; -3\alpha &amp; \alpha \\
\alpha &amp; \alpha &amp; \alpha &amp; -3\alpha
\end{pmatrix}
\]</span></p>
<p>The diagonal elements ensure that each row sums to zero, maintaining the property of a rate matrix. The negative diagonal elements represent the rate of leaving each state, while off-diagonal elements represent rates of transition to other states.</p>
</section>
<section id="deriving-transition-probabilities" class="level3" data-number="49.4.2">
<h3 data-number="49.4.2" class="anchored" data-anchor-id="deriving-transition-probabilities"><span class="header-section-number">49.4.2</span> Deriving Transition Probabilities</h3>
<p>The transition probability matrix P(t), giving the probability that nucleotide i changes to nucleotide j over time t, can be derived by exponentiating the rate matrix:</p>
<p><span class="math display">\[
P(t) = e^{Qt}
\]</span></p>
<p>To solve this, we use the eigenvalue decomposition of Q. The rate matrix Q can be written as:</p>
<p><span class="math display">\[
Q = \alpha \begin{pmatrix}
-3 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; -3 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; -3 &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; -3
\end{pmatrix}
\]</span></p>
<p>This matrix has two distinct eigenvalues: - λ₁ = 0 (with multiplicity 1) - λ₂ = -4α (with multiplicity 3)</p>
<p>The eigenvector for λ₁ = 0 is (1, 1, 1, 1)ᵀ, representing the equilibrium distribution. The three eigenvectors for λ₂ = -4α span the space orthogonal to the equilibrium.</p>
<p>Using spectral decomposition, we obtain the transition probability matrix:</p>
<p><span class="math display">\[P(t) = \frac{1}{4}\mathbf{1}\mathbf{1}^T + e^{-4\alpha t}\left(I - \frac{1}{4}\mathbf{1}\mathbf{1}^T\right)\]</span></p>
<p>where 𝟙 is a column vector of ones and I is the identity matrix. This yields the closed-form solutions:</p>
<p><span class="math display">\[P_{ii}(t) = \frac{1}{4} + \frac{3}{4}e^{-4\alpha t}\]</span> <span class="math display">\[P_{ij}(t) = \frac{1}{4} - \frac{1}{4}e^{-4\alpha t} \text{ for } i \neq j\]</span></p>
</section>
<section id="worked-example-computing-transition-probabilities" class="level3" data-number="49.4.3">
<h3 data-number="49.4.3" class="anchored" data-anchor-id="worked-example-computing-transition-probabilities"><span class="header-section-number">49.4.3</span> Worked Example: Computing Transition Probabilities</h3>
<p>Let’s work through a concrete example. Suppose α = 0.01 substitutions per site per million years, and we want to know the probabilities after t = 10 million years.</p>
<p>First, calculate the exponent: <span class="math display">\[-4\alpha t = -4 \times 0.01 \times 10 = -0.4\]</span></p>
<p>Then: <span class="math display">\[e^{-0.4} \approx 0.6703\]</span></p>
<p>The probability that a nucleotide remains unchanged: <span class="math display">\[P_{ii}(10) = \frac{1}{4} + \frac{3}{4} \times 0.6703 = 0.25 + 0.5027 = 0.7527\]</span></p>
<p>The probability that a nucleotide changes to any specific other nucleotide: <span class="math display">\[P_{ij}(10) = \frac{1}{4} - \frac{1}{4} \times 0.6703 = 0.25 - 0.1676 = 0.0824\]</span></p>
<p>We can verify our calculation: <span class="math display">\[P_{ii} + 3 \times P_{ij} = 0.7527 + 3 \times 0.0824 = 0.7527 + 0.2472 \approx 1.0\]</span></p>
<p>This means that after 10 million years, there’s approximately a 75% chance a nucleotide remains unchanged and about 8% chance it changes to any specific other nucleotide.</p>
</section>
<section id="two-sequence-divergence" class="level3" data-number="49.4.4">
<h3 data-number="49.4.4" class="anchored" data-anchor-id="two-sequence-divergence"><span class="header-section-number">49.4.4</span> Two-Sequence Divergence</h3>
<p>When comparing two sequences that diverged from a common ancestor, we need to consider evolution along both branches. If each branch has evolved for time t, the total evolutionary time is 2t.</p>
<p>For a single site, the probability that both sequences have the same nucleotide is:</p>
<p><span class="math display">\[P_{same} = \sum_{i=A,C,G,T} \pi_i \left[\sum_{j=A,C,G,T} P_{ij}(t) \cdot P_{ij}(t)\right]\]</span></p>
<p>Given the symmetry of the JC69 model:</p>
<p><span class="math display">\[P_{same} = \frac{1}{4} \times 4 \times \left[P_{ii}^2(t) + 3P_{ij}^2(t)\right]\]</span></p>
<p>Substituting our expressions:</p>
<p><span class="math display">\[P_{same} = \left(\frac{1}{4} + \frac{3}{4}e^{-4\alpha t}\right)^2 + 3\left(\frac{1}{4} - \frac{1}{4}e^{-4\alpha t}\right)^2\]</span></p>
<p>After algebraic simplification:</p>
<p><span class="math display">\[P_{same} = \frac{1}{4} + \frac{3}{4}e^{-8\alpha t}\]</span></p>
<p>Therefore, the probability that sites differ is:</p>
<p><span class="math display">\[p = 1 - P_{same} = \frac{3}{4}(1 - e^{-8\alpha t})\]</span></p>
</section>
<section id="distance-correction-formula" class="level3" data-number="49.4.5">
<h3 data-number="49.4.5" class="anchored" data-anchor-id="distance-correction-formula"><span class="header-section-number">49.4.5</span> Distance Correction Formula</h3>
<p>The observed proportion of differences p underestimates the actual number of substitutions due to multiple hits. To correct for this, we solve for the evolutionary distance d = 2αt:</p>
<p>From: <span class="math display">\[p = \frac{3}{4}(1 - e^{-\frac{4d}{3}})\]</span></p>
<p>Solving for d: <span class="math display">\[1 - \frac{4p}{3} = e^{-\frac{4d}{3}}\]</span></p>
<p>Taking the natural logarithm: <span class="math display">\[\ln\left(1 - \frac{4p}{3}\right) = -\frac{4d}{3}\]</span></p>
<p>Therefore: <span class="math display">\[d = -\frac{3}{4}\ln\left(1 - \frac{4p}{3}\right)\]</span></p>
<p>This is the Jukes-Cantor distance correction formula, which estimates the expected number of substitutions per site from the observed proportion of differences.</p>
</section>
<section id="numerical-example-distance-correction" class="level3" data-number="49.4.6">
<h3 data-number="49.4.6" class="anchored" data-anchor-id="numerical-example-distance-correction"><span class="header-section-number">49.4.6</span> Numerical Example: Distance Correction</h3>
<p>Consider two sequences with the following alignment:</p>
<pre><code>Sequence 1: ATCGATCGATCGATCGATCG (20 nucleotides)
Sequence 2: ATCGTTCCATCGAACGATGG (20 nucleotides)
Differences:     *  *      * *    ** (6 differences)</code></pre>
<p>The observed proportion of differences: <span class="math display">\[p = \frac{6}{20} = 0.30\]</span></p>
<p>Applying the JC69 correction: <span class="math display">\[d = -\frac{3}{4}\ln\left(1 - \frac{4 \times 0.30}{3}\right) = -\frac{3}{4}\ln(1 - 0.40) = -\frac{3}{4}\ln(0.60)\]</span></p>
<p><span class="math display">\[d = -\frac{3}{4} \times (-0.5108) = 0.3831\]</span></p>
<p>So while we observe 30% differences, the estimated number of substitutions per site is 0.383, or 38.3%. This 28% increase (from 0.30 to 0.383) accounts for multiple substitutions at the same sites.</p>
</section>
<section id="saturation-and-model-limitations" class="level3" data-number="49.4.7">
<h3 data-number="49.4.7" class="anchored" data-anchor-id="saturation-and-model-limitations"><span class="header-section-number">49.4.7</span> Saturation and Model Limitations</h3>
<p>As sequences diverge, the observed differences plateau while actual substitutions continue to accumulate. The JC69 model predicts:</p>
<ul>
<li>When d = 0.1: p ≈ 0.097 (minimal correction needed)</li>
<li>When d = 0.5: p ≈ 0.447 (moderate correction)</li>
<li>When d = 1.0: p ≈ 0.681 (substantial correction)</li>
<li>When d = 2.0: p ≈ 0.747 (near saturation)</li>
<li>As d → ∞: p → 0.75 (complete saturation)</li>
</ul>
<p>The correction formula becomes undefined when p ≥ 0.75, as ln(1 - 4p/3) is undefined for p ≥ 0.75. This represents complete saturation—sequences are no more similar than random.</p>
</section>
<section id="properties-and-insights" class="level3" data-number="49.4.8">
<h3 data-number="49.4.8" class="anchored" data-anchor-id="properties-and-insights"><span class="header-section-number">49.4.8</span> Properties and Insights</h3>
<p>The JC69 model reveals several fundamental properties of neutral evolution:</p>
<ol type="1">
<li><strong>Exponential decay</strong>: The probability of identity decreases exponentially with time</li>
<li><strong>Equilibrium convergence</strong>: All sequences converge to 25% of each nucleotide</li>
<li><strong>Reversibility</strong>: P(i→j in time t) × πᵢ = P(j→i in time t) × πⱼ</li>
<li><strong>Saturation</strong>: Observable differences plateau at 75% as time increases</li>
<li><strong>Multiple hits</strong>: The correction factor increases dramatically with divergence</li>
</ol>
<p>These properties make the JC69 model a valuable baseline for understanding molecular evolution, even though its assumptions are oversimplified for real sequences.</p>
</section>
</section>
<section id="the-kimura-two-parameter-model-transitions-and-transversions" class="level2" data-number="49.5">
<h2 data-number="49.5" class="anchored" data-anchor-id="the-kimura-two-parameter-model-transitions-and-transversions"><span class="header-section-number">49.5</span> The Kimura Two-Parameter Model: Transitions and Transversions</h2>
<hr>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/mutation_diagram.png" class="img-fluid figure-img"></p>
<figcaption>Mutation diagram</figcaption>
</figure>
</div>
<p><span class="math display">\[
Q = \begin{pmatrix}
-2\beta-\alpha &amp; \beta &amp; \alpha &amp; \beta \\
  \beta &amp; -2\beta-\alpha &amp; \beta &amp; \alpha \\
  \alpha &amp; \beta &amp; -2\beta-\alpha &amp; \beta \\
  \beta &amp; \alpha &amp; \beta &amp; -2\beta-\alpha
\end{pmatrix}
\]</span></p>
<p><span class="math inline">\(\alpha\)</span>: transition rate. <span class="math inline">\(\beta\)</span>: transversion rate.</p>
<p><span class="math display">\[
d_{K2P} = - \frac{1}{2} \ln \big( 1 - 2P - Q\big) - \frac{1}{4} \ln \big( 2Q\big)
\]</span></p>
<p><span class="math inline">\(P\)</span> is the fraction of transitions and <span class="math inline">\(Q\)</span> is the fraction of transversions.</p>
<hr>
<p>Empirical observations reveal that not all substitutions occur with equal frequency. Transitions (purine to purine or pyrimidine to pyrimidine changes) typically occur more frequently than transversions (purine to pyrimidine or vice versa). The Kimura two-parameter (K80) model, introduced in 1980, incorporates this biological reality while maintaining mathematical tractability.</p>
<p>The K80 model distinguishes between transition rate α and transversion rate β, typically with α &gt; β. The rate matrix becomes:</p>
<p><span class="math display">\[
Q = \begin{pmatrix}
-(\alpha + 2\beta) &amp; \beta &amp; \alpha &amp; \beta \\
\beta &amp; -(\alpha + 2\beta) &amp; \beta &amp; \alpha \\
\alpha &amp; \beta &amp; -(\alpha + 2\beta) &amp; \beta \\
\beta &amp; \alpha &amp; \beta &amp; -(\alpha + 2\beta)
\end{pmatrix}
\]</span></p>
<p>This structure reflects the chemical basis of mutations. Transitions involve substitutions between chemically similar bases and often result from spontaneous deamination or tautomeric shifts. Transversions require more dramatic chemical changes and occur less frequently. The transition/transversion ratio (κ = α/β) typically ranges from 2 to 10 in nuclear DNA, though it can be higher in mitochondrial sequences.</p>
<p>The transition probability functions for the K80 model are:</p>
<p><span class="math display">\[
P_{ii}(t) = \frac{1}{4} + \frac{1}{4}e^{-4\beta t} + \frac{1}{2}e^{-2(\alpha + \beta)t}
\]</span></p>
<p><span class="math display">\[
_{ij}^{ts}(t) = \frac{1}{4} + \frac{1}{4}e^{-4\beta t} - \frac{1}{2}e^{-2(\alpha + \beta)t}
\]</span></p>
<p>(transitions)</p>
<p><span class="math display">\[
P_{ij}^{tv}(t) = \frac{1}{4} - \frac{1}{4}e^{-4\beta t}
\]</span></p>
<p>(transversions)</p>
<p>These equations reveal how the model captures both fast (transitions) and slow (transversions) evolutionary processes. The presence of two exponential terms reflects the two-parameter nature of the model, with different decay rates for different types of substitutions.</p>
<p>To estimate evolutionary distances under the K80 model, we need to observe both the proportion of transitional differences (S) and transversional differences (V):</p>
<p><span class="math display">\[
d = -\frac{1}{2}\ln(1 - 2S - V) - \frac{1}{4}\ln(1 - 2V)
\]</span></p>
<p>This formula shows how the model uses additional information about substitution types to provide more accurate distance estimates than the JC69 model.</p>
</section>
<section id="tamuras-tre-parameter-model" class="level1" data-number="50">
<h1 data-number="50"><span class="header-section-number">50</span> Tamuras tre-parameter model</h1>
<p><span class="math display">\[
K_{ab} = -C\ln \bigg(1-\frac{S}{C}-V\bigg) - \frac{1}{2}\bigg(1-C\bigg) \ln \bigg(1-2V\bigg)
\]</span></p>
<p><span class="math display">\[
C = \text{GC}_{s1} + \text{GC}_{s2} - 2 \times \text{GC}_{s1} \times \text{GC}_{s2}
\]</span></p>
<section id="the-felsenstein-81-model-unequal-base-frequencies" class="level2" data-number="50.1">
<h2 data-number="50.1" class="anchored" data-anchor-id="the-felsenstein-81-model-unequal-base-frequencies"><span class="header-section-number">50.1</span> The Felsenstein 81 Model: Unequal Base Frequencies</h2>
<p>Real DNA sequences rarely exhibit equal frequencies of all four nucleotides. The Felsenstein 81 (F81) model addresses this limitation by allowing unequal equilibrium base frequencies while maintaining equal rates for all substitution types. This model recognizes that compositional biases—such as high GC content in certain genomes—affect substitution patterns.</p>
<p>In the F81 model, the rate of substitution from nucleotide i to nucleotide j is proportional to the equilibrium frequency of j (denoted πⱼ). The rate matrix is:</p>
<p><span class="math display">\[Q_{ij} = \begin{cases}
\beta\pi_j &amp; \text{if } i \neq j \\
-\beta(1 - \pi_i) &amp; \text{if } i = j
\end{cases}\]</span></p>
<p>This formulation ensures that the substitution process maintains the specified equilibrium frequencies. The model captures the idea that mutations to common nucleotides occur more frequently than mutations to rare nucleotides, reflecting the underlying mutational processes or selective constraints maintaining compositional biases.</p>
<p>The transition probabilities for the F81 model are:</p>
<p><span class="math display">\[P_{ij}(t) = \begin{cases}
\pi_j + (\delta_{ij} - \pi_j)e^{-\beta t} &amp; \text{general form} \\
\pi_j + (1 - \pi_j)e^{-\beta t} &amp; \text{if } i = j \\
\pi_j(1 - e^{-\beta t}) &amp; \text{if } i \neq j
\end{cases}\]</span></p>
<p>where δᵢⱼ is the Kronecker delta (1 if i=j, 0 otherwise). These equations show how sequences evolve toward equilibrium frequencies, with the rate of approach governed by the parameter β.</p>
<p>The F81 model provides insights into how compositional constraints shape molecular evolution. In GC-rich genomes, for example, AT→GC substitutions occur more frequently than GC→AT substitutions, maintaining the compositional bias. This model forms the basis for more complex models that combine unequal base frequencies with other biological features.</p>
</section>
<section id="the-hky85-model-combining-biological-realism" class="level2" data-number="50.2">
<h2 data-number="50.2" class="anchored" data-anchor-id="the-hky85-model-combining-biological-realism"><span class="header-section-number">50.2</span> The HKY85 Model: Combining Biological Realism</h2>
<p>The Hasegawa-Kishino-Yano (HKY85) model represents a synthesis of the K80 and F81 models, incorporating both transition/transversion bias and unequal base frequencies. This model, proposed in 1985, strikes a balance between biological realism and computational tractability, making it one of the most widely used models in phylogenetic analysis.</p>
<p>The HKY85 rate matrix combines the features of its predecessors:</p>
<p><span class="math display">\[Q_{ij} = \begin{cases}
\beta\pi_j &amp; \text{for transversions} \\
\beta\kappa\pi_j &amp; \text{for transitions} \\
-\sum_{k \neq i} Q_{ik} &amp; \text{for } i = j
\end{cases}\]</span></p>
<p>where κ represents the transition/transversion rate ratio. This formulation captures two major features of molecular evolution: the chemical basis of mutations (through κ) and compositional constraints (through π).</p>
<p>The eigenvalue decomposition of the HKY85 rate matrix reveals its mathematical structure. While the general transition probabilities lack simple closed-form expressions, they can be computed efficiently using matrix exponentiation methods. The model has four distinct eigenvalues, reflecting its increased complexity compared to simpler models.</p>
<p>Distance estimation under HKY85 requires numerical methods rather than analytical solutions. Maximum likelihood estimation provides optimal estimates of both evolutionary distances and model parameters (κ and base frequencies). The likelihood function incorporates information from all sites, weighting the contribution of each pattern of nucleotides according to its probability under the model.</p>
<p>The HKY85 model’s success stems from its ability to capture essential features of molecular evolution without excessive parameterization. It accounts for approximately 85% of the variation in substitution patterns observed in real sequences while remaining computationally feasible for large datasets.</p>
</section>
<section id="the-general-time-reversible-model-maximum-flexibility" class="level2" data-number="50.3">
<h2 data-number="50.3" class="anchored" data-anchor-id="the-general-time-reversible-model-maximum-flexibility"><span class="header-section-number">50.3</span> The General Time Reversible Model: Maximum Flexibility</h2>
<p>The General Time Reversible (GTR) model represents the most general neutral model of DNA evolution with time reversibility. This model allows all six pairs of nucleotide substitutions to have different rates while maintaining the mathematical property of time reversibility—essential for most phylogenetic methods.</p>
<p>The GTR rate matrix has the form:</p>
<p><span class="math display">\[Q_{ij} = \begin{cases}
r_{ij}\pi_j &amp; \text{if } i \neq j \\
-\sum_{k \neq i} Q_{ik} &amp; \text{if } i = j
\end{cases}\]</span></p>
<p>where rᵢⱼ represents the exchangeability parameter between nucleotides i and j (with rᵢⱼ = rⱼᵢ for reversibility), and πⱼ is the equilibrium frequency of nucleotide j. The model has 8 free parameters: 5 exchangeability parameters (the sixth is fixed for identifiability) and 3 base frequencies (the fourth is determined by the constraint that frequencies sum to 1).</p>
<p>Time reversibility means that the probability of observing sequence S₁ at time 0 and S₂ at time t equals the probability of observing S₂ at time 0 and S₁ at time t:</p>
<p><span class="math display">\[\pi_i P_{ij}(t) = \pi_j P_{ji}(t)\]</span></p>
<p>This property, while biologically questionable (evolution has direction), proves mathematically convenient and appears to have little practical impact on phylogenetic inference for most datasets.</p>
<p>The GTR model encompasses all previously discussed models as special cases: - JC69: all rᵢⱼ = 1, all πᵢ = 0.25 - K80: all πᵢ = 0.25, transitions share one rate, transversions another - F81: all rᵢⱼ = 1, πᵢ estimated from data - HKY85: transitions share one rate, transversions another, πᵢ estimated</p>
<p>This hierarchy of models allows researchers to select appropriate complexity levels through statistical model selection procedures. The Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC) can identify whether additional parameters significantly improve model fit.</p>
</section>
<section id="rate-heterogeneity-the-gamma-distribution" class="level2" data-number="50.4">
<h2 data-number="50.4" class="anchored" data-anchor-id="rate-heterogeneity-the-gamma-distribution"><span class="header-section-number">50.4</span> Rate Heterogeneity: The Gamma Distribution</h2>
<p>Real sequences exhibit substantial variation in substitution rates across sites. Some positions evolve rapidly due to weak functional constraints, while others remain nearly invariant due to strong purifying selection. Ignoring rate heterogeneity leads to underestimation of evolutionary distances and incorrect phylogenetic inference.</p>
<p>The gamma distribution provides a flexible framework for modeling rate heterogeneity. If rates across sites follow a gamma distribution with shape parameter α, the probability density function is:</p>
<p><span class="math display">\[f(r) = \frac{\alpha^\alpha}{\Gamma(\alpha)} r^{\alpha-1} e^{-\alpha r}\]</span></p>
<p>The shape parameter α determines the extent of rate variation: - α &lt; 1: L-shaped distribution with many slowly evolving sites - α = 1: exponential distribution - α &gt; 1: bell-shaped distribution - α → ∞: no rate variation (all sites evolve at the same rate)</p>
<p>Empirical studies typically find α values between 0.1 and 2, indicating substantial rate heterogeneity in most sequences. Low α values (high heterogeneity) are characteristic of functional sequences with many conserved positions.</p>
<p>The continuous gamma distribution is often approximated using discrete categories for computational efficiency. Yang’s discrete gamma model divides sites into k categories (typically 4-8) with equal probabilities, choosing rates to preserve the mean and variance of the continuous distribution. The likelihood calculation then involves summing over all possible rate categories for each site:</p>
<p><span class="math display">\[L = \prod_{i=1}^n \sum_{j=1}^k \frac{1}{k} P(D_i | r_j)\]</span></p>
<p>where Dᵢ represents the data at site i and rⱼ is the rate for category j.</p>
</section>
<section id="invariant-sites-accounting-for-functional-constraints" class="level2" data-number="50.5">
<h2 data-number="50.5" class="anchored" data-anchor-id="invariant-sites-accounting-for-functional-constraints"><span class="header-section-number">50.5</span> Invariant Sites: Accounting for Functional Constraints</h2>
<p>Some positions in functional sequences cannot tolerate any substitutions without losing essential function. These invariant sites violate the assumptions of standard models, which predict that all sites should eventually vary given sufficient time. The proportion of invariant sites (pᵢₙᵥ) can be substantial in coding sequences, particularly at first and second codon positions.</p>
<p>The I+G model combines invariant sites with gamma-distributed rates for variable sites:</p>
<p><span class="math display">\[L = p_{inv} L_{inv} + (1 - p_{inv}) L_{\Gamma}\]</span></p>
<p>where Lᵢₙᵥ is the likelihood of observing no change and L_Γ is the likelihood under the gamma model. This formulation recognizes two classes of conservation: absolute constraint (invariant sites) and strong but not absolute constraint (slowly evolving variable sites).</p>
<p>Parameter estimation in I+G models requires care to avoid identifiability problems. As the gamma shape parameter approaches zero, the gamma distribution places increasing weight on slowly evolving sites, potentially confounding with truly invariant sites. Maximum likelihood estimation must navigate this parameter correlation carefully.</p>
</section>
<section id="codon-models-the-genetic-codes-influence" class="level2" data-number="50.6">
<h2 data-number="50.6" class="anchored" data-anchor-id="codon-models-the-genetic-codes-influence"><span class="header-section-number">50.6</span> Codon Models: The Genetic Code’s Influence</h2>
<p>When analyzing protein-coding sequences, nucleotide substitution models ignore the genetic code’s structure. Codon models explicitly incorporate the relationship between DNA changes and amino acid replacements, providing more biologically realistic descriptions of coding sequence evolution.</p>
<p>The Muse-Gaut and Goldman-Yang models represent two major approaches to codon modeling. Both distinguish between synonymous substitutions (not changing the amino acid) and non-synonymous substitutions (changing the amino acid), but differ in their parameterization.</p>
<p>The Goldman-Yang model parameterizes rates as:</p>
<p><span class="math display">\[q_{ij} \propto \begin{cases}
\pi_j &amp; \text{for synonymous transversions} \\
\kappa\pi_j &amp; \text{for synonymous transitions} \\
\omega\pi_j &amp; \text{for non-synonymous transversions} \\
\omega\kappa\pi_j &amp; \text{for non-synonymous transitions} \\
0 &amp; \text{for multiple nucleotide changes}
\end{cases}\]</span></p>
<p>where ω = dN/dS represents the ratio of non-synonymous to synonymous substitution rates. This ratio provides information about selection: - ω &lt; 1: purifying selection (most amino acid changes are deleterious) - ω = 1: neutral evolution - ω &gt; 1: positive selection (amino acid changes are advantageous)</p>
<p>Codon models can detect positive selection even when it affects only a small proportion of sites, making them powerful tools for identifying functionally important regions and adaptive evolution.</p>
</section>
<section id="context-dependent-evolution-beyond-independence" class="level2" data-number="50.7">
<h2 data-number="50.7" class="anchored" data-anchor-id="context-dependent-evolution-beyond-independence"><span class="header-section-number">50.7</span> Context-Dependent Evolution: Beyond Independence</h2>
<p>Standard models assume that sites evolve independently, but real sequences exhibit context-dependent substitution patterns. The most striking example is the CpG dinucleotide in vertebrate genomes. Methylated cytosines in CpG contexts spontaneously deaminate to thymine at elevated rates, causing CpG depletion except in unmethylated CpG islands.</p>
<p>Context-dependent models explicitly incorporate neighbor effects:</p>
<p><span class="math display">\[Q_{ij|context} = f(i, j, \text{neighboring bases})\]</span></p>
<p>These models can capture: - CpG effects: elevated C→T rates in CpG contexts - Codon position effects: different rates at three codon positions - RNA structure: compensatory substitutions maintaining base pairs - Protein structure: correlated changes maintaining interactions</p>
<p>While context-dependent models provide more realistic descriptions of sequence evolution, they require substantially more parameters and computational resources. The trade-off between model realism and practical applicability remains an active area of research.</p>
</section>
<section id="model-selection-choosing-appropriate-complexity" class="level2" data-number="50.8">
<h2 data-number="50.8" class="anchored" data-anchor-id="model-selection-choosing-appropriate-complexity"><span class="header-section-number">50.8</span> Model Selection: Choosing Appropriate Complexity</h2>
<p>With numerous models available, selecting appropriate complexity for specific datasets becomes crucial. Overly simple models miss important evolutionary features, while overly complex models overfit data and provide unreliable estimates.</p>
<p>Statistical model selection uses information criteria balancing fit and complexity:</p>
<p><strong>Akaike Information Criterion (AIC):</strong> <span class="math display">\[AIC = -2\ln L + 2k\]</span></p>
<p><strong>Bayesian Information Criterion (BIC):</strong> <span class="math display">\[BIC = -2\ln L + k\ln n\]</span></p>
<p>where L is the maximum likelihood, k is the number of parameters, and n is the sample size. Lower values indicate better models, with penalties for additional parameters preventing overfitting.</p>
<p>Likelihood ratio tests provide statistical assessment when models are nested: <span class="math display">\[LRT = 2(\ln L_{complex} - \ln L_{simple})\]</span></p>
<p>Under the null hypothesis (simple model adequate), LRT follows a chi-square distribution with degrees of freedom equal to the parameter difference.</p>
<p>Hierarchical likelihood ratio tests can systematically evaluate model features: 1. Test base frequency equality (JC69 vs F81) 2. Test transition/transversion equality (F81 vs HKY85) 3. Test rate homogeneity (HKY85 vs HKY85+G) 4. Test for invariant sites (HKY85+G vs HKY85+I+G)</p>
<p>This systematic approach identifies necessary model features while avoiding unnecessary complexity.</p>
</section>
<section id="practical-applications-from-theory-to-practice" class="level2" data-number="50.9">
<h2 data-number="50.9" class="anchored" data-anchor-id="practical-applications-from-theory-to-practice"><span class="header-section-number">50.9</span> Practical Applications: From Theory to Practice</h2>
<p>Evolutionary models enable diverse applications in biology and medicine:</p>
<p><strong>Phylogenetic Reconstruction:</strong> Models provide the statistical framework for inferring evolutionary relationships. Maximum likelihood and Bayesian methods use substitution models to evaluate alternative trees, identifying those best explaining observed sequences. Accurate models are essential for resolving difficult phylogenetic questions, such as rapid radiations or ancient divergences.</p>
<p><strong>Molecular Dating:</strong> By relating sequence divergence to time, models enable estimation of divergence times. The molecular clock hypothesis—constant substitution rates over time—provides the simplest framework, though relaxed clock models accommodate rate variation among lineages. Calibration using fossil evidence or geological events converts genetic distances to absolute times.</p>
<p><strong>Positive Selection Detection:</strong> Codon models identify genes and sites under positive selection by comparing non-synonymous and synonymous substitution rates. This approach has revealed adaptive evolution in immune system genes, reproductive proteins, and host-pathogen interactions. Site-specific models can pinpoint individual amino acids under selection, guiding functional studies.</p>
<p><strong>Ancestral Sequence Reconstruction:</strong> Models enable probabilistic reconstruction of ancestral sequences at internal tree nodes. This approach has been used to resurrect ancient proteins, study evolutionary trajectories, and understand the origins of novel functions. The accuracy of reconstruction depends critically on model appropriateness.</p>
<p><strong>Epidemiological Tracking:</strong> Fast-evolving viruses like influenza and HIV require sophisticated models accounting for rapid evolution and strong selection. Real-time phylogenetics tracks viral spread, identifies transmission chains, and predicts future evolution. Model-based analyses inform public health decisions and vaccine design.</p>
</section>
<section id="limitations-and-future-directions" class="level2" data-number="50.10">
<h2 data-number="50.10" class="anchored" data-anchor-id="limitations-and-future-directions"><span class="header-section-number">50.10</span> Limitations and Future Directions</h2>
<p>Despite their utility, current models have important limitations:</p>
<p><strong>Stationarity Assumption:</strong> Most models assume constant nucleotide frequencies over time, but compositional evolution occurs in many lineages. Non-stationary models allowing frequency changes are computationally challenging but necessary for some datasets.</p>
<p><strong>Site Independence:</strong> The assumption that sites evolve independently ignores structural and functional constraints creating correlated evolution. Incorporating dependency requires exponentially more parameters, limiting practical applications.</p>
<p><strong>Selection Modeling:</strong> Most models assume neutral evolution or simple selection schemes. Real selection varies across sites, through time, and among lineages in complex ways not captured by current models.</p>
<p><strong>Insertion-Deletion Evolution:</strong> Standard substitution models ignore insertions and deletions (indels), though these contribute substantially to sequence divergence. Integrated models of substitution and indel evolution remain computationally challenging.</p>
<p>Future developments will likely focus on: - Machine learning approaches to model selection and parameter estimation - Integration of structural and functional information - Improved computational methods for complex models - Models tailored to specific biological questions - Real-time phylogenetics for pathogen surveillance</p>
</section>
<section id="conclusion" class="level2" data-number="50.11">
<h2 data-number="50.11" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">50.11</span> Conclusion</h2>
<p>Models of DNA evolution provide the mathematical foundation for understanding how genetic sequences change over time. From the simple elegance of the Jukes-Cantor model to the biological realism of context-dependent models, this framework enables us to extract evolutionary information from sequence data.</p>
<p>The progression from simple to complex models reflects our growing understanding of molecular evolution’s intricacies. Each model captures different aspects of the substitution process: equal rates (JC69), transition/transversion bias (K80), compositional constraints (F81), combined features (HKY85, GTR), rate heterogeneity (gamma), functional constraints (invariant sites), and the genetic code (codon models).</p>
<p>Model selection remains crucial for balancing biological realism with statistical reliability. Overly simple models miss important evolutionary features, while overly complex models overfit limited data. Information criteria and likelihood ratio tests guide appropriate model choice for specific datasets and questions.</p>
<p>The practical impact of evolutionary models extends throughout biology and medicine. They enable phylogenetic reconstruction, molecular dating, selection detection, ancestral reconstruction, and epidemiological tracking. As sequencing technologies generate ever-larger datasets and computational methods advance, evolutionary models will continue evolving to meet new challenges.</p>
<p>Understanding these models—their assumptions, strengths, and limitations—is essential for anyone working with molecular sequence data. They transform raw sequence comparisons into evolutionary insights, revealing the historical processes that shaped the diversity of life. As we develop more sophisticated models capturing additional biological realism, we deepen our understanding of molecular evolution and enhance our ability to use genomic data for practical applications.</p>
<p>The future of evolutionary modeling lies in integrating multiple data types, incorporating structural and functional constraints, and developing computationally efficient methods for increasingly complex models. These advances will enable more accurate phylogenetic inference, better understanding of adaptive evolution, and improved predictions for medical and biotechnological applications. The mathematical frameworks developed for modeling DNA evolution will continue to evolve, driven by biological discoveries and computational innovations, maintaining their central role in understanding life’s molecular history.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/project/seqdist_project/index.html" class="pagination-link" aria-label="Sequence trees">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sequence trees</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/bioinformatics/phylogenetics.html" class="pagination-link" aria-label="Phylogenetics: Tree-Based Analysis of Evolutionary Relationships">
        <span class="nav-page-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Phylogenetics: Tree-Based Analysis of Evolutionary Relationships</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>