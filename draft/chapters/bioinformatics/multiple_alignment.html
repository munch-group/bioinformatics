<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>38&nbsp; Multiple Alignment – Bioinformatics and Programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/project/alignment_project/index.html" rel="next">
<link href="../../chapters/bioinformatics/pairwise_alignment.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-20f424e7bd2e25dfd45129c9906c9df5.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7b6dd81834b739ce5ef7482f5ddde1ad.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/preface.html">Bioinformatics</a></li><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/multiple_alignment.html"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multiple Alignment</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Content</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Exam information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../curriculum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Curriculum</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Learning Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/before_you_begin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Before you begin</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/writing_a_program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Writing a program</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dealing_with_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Dealing with values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/the_order_of_events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The order of events</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/course_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Course tools</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/controlling_behavior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Controlling behavior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/organizing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Organizing code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/python_values_are_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Values are objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Lists of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/dictionaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pairs of things</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/gluing_values_in_sequence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grouping values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/iteration_over_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Iterating values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/working_with_data_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Structuring data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/unleash_your_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Recursion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/testing_your_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Testing your code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/your_own_types_of_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Your Own Objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/using_code_from_other_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Code in other files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/on_the_shoulders_of_giants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Giant’s shoulders</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/python/appendix_bsf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Appendix: PyMol for BSF</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Bioinformatics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/association.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Genetic Association</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/gwas_databases/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">GWAS candidates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/database_searching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Database Searching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/translation_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Translating ORFs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/hidden_markov_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Hidden Markov Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/new_hmm_exercise/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Membrane proteins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/orf_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Finding genes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/neural_networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/folding_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Primer analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/assembly_and_mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Genome Sequencing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/assembly_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Genome assembly</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/pairwise_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Pairwise Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/multiple_alignment.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multiple Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/alignment_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Pairwise alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/ccr5_pwalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">CCR5-delta32</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/protein_substitution_matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Scoring Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/database_searching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Database Searching</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/mrsa_blast_multalign/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">MRSA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/hiv_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">HIV sub-groups</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/multiple_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multiple Alignment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Clustering of sequences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/project/seqdist_project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Sequence trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/models_of_dna_evolution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Models of DNA Evolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bioinformatics/phylogenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Phylogenetics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/aardwark_seqdist/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Aardvark?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/web/orf_finding/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Plasmid ORFs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Supplementary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/project_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/recordings2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture recordings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/slides2024.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../supplementary/bioinformatics_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Databases and resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exam info</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/trouble_shooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trouble shooting</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-the-fundamental-challenge" id="toc-introduction-the-fundamental-challenge" class="nav-link active" data-scroll-target="#introduction-the-fundamental-challenge">Introduction: The Fundamental Challenge</a></li>
  <li><a href="#the-computational-complexity-problem" id="toc-the-computational-complexity-problem" class="nav-link" data-scroll-target="#the-computational-complexity-problem">The Computational Complexity Problem</a>
  <ul class="collapse">
  <li><a href="#theoretical-foundations" id="toc-theoretical-foundations" class="nav-link" data-scroll-target="#theoretical-foundations">Theoretical Foundations</a></li>
  <li><a href="#np-completeness" id="toc-np-completeness" class="nav-link" data-scroll-target="#np-completeness">NP-Completeness</a></li>
  <li><a href="#scoring-functions-and-objective-complexity" id="toc-scoring-functions-and-objective-complexity" class="nav-link" data-scroll-target="#scoring-functions-and-objective-complexity">Scoring Functions and Objective Complexity</a></li>
  </ul></li>
  <li><a href="#progressive-alignment-the-dominant-paradigm" id="toc-progressive-alignment-the-dominant-paradigm" class="nav-link" data-scroll-target="#progressive-alignment-the-dominant-paradigm">Progressive Alignment: The Dominant Paradigm</a>
  <ul class="collapse">
  <li><a href="#the-progressive-strategy" id="toc-the-progressive-strategy" class="nav-link" data-scroll-target="#the-progressive-strategy">The Progressive Strategy</a></li>
  <li><a href="#mathematical-framework" id="toc-mathematical-framework" class="nav-link" data-scroll-target="#mathematical-framework">Mathematical Framework</a></li>
  <li><a href="#advantages-of-progressive-alignment" id="toc-advantages-of-progressive-alignment" class="nav-link" data-scroll-target="#advantages-of-progressive-alignment">Advantages of Progressive Alignment</a></li>
  </ul></li>
  <li><a href="#the-greedy-nature-and-its-shortcomings" id="toc-the-greedy-nature-and-its-shortcomings" class="nav-link" data-scroll-target="#the-greedy-nature-and-its-shortcomings">The Greedy Nature and Its Shortcomings</a>
  <ul class="collapse">
  <li><a href="#the-fundamental-limitation" id="toc-the-fundamental-limitation" class="nav-link" data-scroll-target="#the-fundamental-limitation">The Fundamental Limitation</a></li>
  <li><a href="#error-propagation" id="toc-error-propagation" class="nav-link" data-scroll-target="#error-propagation">Error Propagation</a></li>
  <li><a href="#the-indel-problem" id="toc-the-indel-problem" class="nav-link" data-scroll-target="#the-indel-problem">The Indel Problem</a></li>
  <li><a href="#mathematical-analysis-of-error-accumulation" id="toc-mathematical-analysis-of-error-accumulation" class="nav-link" data-scroll-target="#mathematical-analysis-of-error-accumulation">Mathematical Analysis of Error Accumulation</a></li>
  </ul></li>
  <li><a href="#popular-heuristic-multiple-alignment-tools" id="toc-popular-heuristic-multiple-alignment-tools" class="nav-link" data-scroll-target="#popular-heuristic-multiple-alignment-tools">Popular Heuristic Multiple Alignment Tools</a>
  <ul class="collapse">
  <li><a href="#clustalw-and-clustal-omega" id="toc-clustalw-and-clustal-omega" class="nav-link" data-scroll-target="#clustalw-and-clustal-omega">ClustalW and Clustal Omega</a></li>
  <li><a href="#muscle" id="toc-muscle" class="nav-link" data-scroll-target="#muscle">MUSCLE</a></li>
  <li><a href="#mafft" id="toc-mafft" class="nav-link" data-scroll-target="#mafft">MAFFT</a></li>
  <li><a href="#t-coffee-and-consistency-based-methods" id="toc-t-coffee-and-consistency-based-methods" class="nav-link" data-scroll-target="#t-coffee-and-consistency-based-methods">T-Coffee and Consistency-Based Methods</a></li>
  <li><a href="#prank-and-phylogeny-aware-methods" id="toc-prank-and-phylogeny-aware-methods" class="nav-link" data-scroll-target="#prank-and-phylogeny-aware-methods">PRANK and Phylogeny-Aware Methods</a></li>
  </ul></li>
  <li><a href="#advanced-methodologies-and-algorithmic-innovations" id="toc-advanced-methodologies-and-algorithmic-innovations" class="nav-link" data-scroll-target="#advanced-methodologies-and-algorithmic-innovations">Advanced Methodologies and Algorithmic Innovations</a>
  <ul class="collapse">
  <li><a href="#iterative-refinement-strategies" id="toc-iterative-refinement-strategies" class="nav-link" data-scroll-target="#iterative-refinement-strategies">Iterative Refinement Strategies</a></li>
  <li><a href="#hidden-markov-models-and-statistical-approaches" id="toc-hidden-markov-models-and-statistical-approaches" class="nav-link" data-scroll-target="#hidden-markov-models-and-statistical-approaches">Hidden Markov Models and Statistical Approaches</a></li>
  <li><a href="#consensus-and-meta-methods" id="toc-consensus-and-meta-methods" class="nav-link" data-scroll-target="#consensus-and-meta-methods">Consensus and Meta-Methods</a></li>
  <li><a href="#structure-based-and-domain-aware-alignment" id="toc-structure-based-and-domain-aware-alignment" class="nav-link" data-scroll-target="#structure-based-and-domain-aware-alignment">Structure-Based and Domain-Aware Alignment</a></li>
  </ul></li>
  <li><a href="#computational-optimizations-and-scalability" id="toc-computational-optimizations-and-scalability" class="nav-link" data-scroll-target="#computational-optimizations-and-scalability">Computational Optimizations and Scalability</a>
  <ul class="collapse">
  <li><a href="#algorithmic-improvements" id="toc-algorithmic-improvements" class="nav-link" data-scroll-target="#algorithmic-improvements">Algorithmic Improvements</a></li>
  <li><a href="#parallelization-strategies" id="toc-parallelization-strategies" class="nav-link" data-scroll-target="#parallelization-strategies">Parallelization Strategies</a></li>
  <li><a href="#memory-efficient-implementations" id="toc-memory-efficient-implementations" class="nav-link" data-scroll-target="#memory-efficient-implementations">Memory-Efficient Implementations</a></li>
  </ul></li>
  <li><a href="#validation-quality-assessment-and-best-practices" id="toc-validation-quality-assessment-and-best-practices" class="nav-link" data-scroll-target="#validation-quality-assessment-and-best-practices">Validation, Quality Assessment, and Best Practices</a>
  <ul class="collapse">
  <li><a href="#alignment-quality-metrics" id="toc-alignment-quality-metrics" class="nav-link" data-scroll-target="#alignment-quality-metrics">Alignment Quality Metrics</a></li>
  <li><a href="#benchmark-datasets-and-validation" id="toc-benchmark-datasets-and-validation" class="nav-link" data-scroll-target="#benchmark-datasets-and-validation">Benchmark Datasets and Validation</a></li>
  <li><a href="#best-practices-and-recommendations" id="toc-best-practices-and-recommendations" class="nav-link" data-scroll-target="#best-practices-and-recommendations">Best Practices and Recommendations</a></li>
  </ul></li>
  <li><a href="#future-directions-and-emerging-challenges" id="toc-future-directions-and-emerging-challenges" class="nav-link" data-scroll-target="#future-directions-and-emerging-challenges">Future Directions and Emerging Challenges</a>
  <ul class="collapse">
  <li><a href="#machine-learning-and-deep-learning-approaches" id="toc-machine-learning-and-deep-learning-approaches" class="nav-link" data-scroll-target="#machine-learning-and-deep-learning-approaches">Machine Learning and Deep Learning Approaches</a></li>
  <li><a href="#integration-with-structural-prediction" id="toc-integration-with-structural-prediction" class="nav-link" data-scroll-target="#integration-with-structural-prediction">Integration with Structural Prediction</a></li>
  <li><a href="#handling-big-data-and-genomic-scales" id="toc-handling-big-data-and-genomic-scales" class="nav-link" data-scroll-target="#handling-big-data-and-genomic-scales">Handling Big Data and Genomic Scales</a></li>
  <li><a href="#specialized-applications" id="toc-specialized-applications" class="nav-link" data-scroll-target="#specialized-applications">Specialized Applications</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/preface.html">Bioinformatics</a></li><li class="breadcrumb-item"><a href="../../chapters/bioinformatics/multiple_alignment.html"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multiple Alignment</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multiple Alignment</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>ClustalW is the 10th most cited scientific paper - not just in bioinformatics but in all of science!</p>
</blockquote>
<section id="introduction-the-fundamental-challenge" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="introduction-the-fundamental-challenge">Introduction: The Fundamental Challenge</h2>
<p>Multiple sequence alignment (MSA) represents one of the most fundamental and challenging problems in computational biology. While aligning two sequences is computationally tractable, the extension to multiple sequences introduces profound computational and biological complexities that have engaged researchers for decades. The importance of MSA cannot be overstated: it forms the foundation for phylogenetic analysis, protein structure prediction, identification of conserved regions, and understanding evolutionary relationships among organisms.</p>
<p>The biological motivation for multiple alignment stems from the observation that sequences related by evolution share common ancestry and often preserve functionally important regions. These conserved regions, whether coding for critical protein domains or regulatory elements, appear as columns of similar or identical residues in a properly constructed alignment. By aligning multiple related sequences simultaneously, we can identify these conserved patterns that might be obscured in pairwise comparisons, reveal evolutionary relationships, and make functional predictions about unknown sequences.</p>
<p>Consider the challenge: given a set of DNA or protein sequences that share evolutionary history but have diverged through substitutions, insertions, and deletions, we must arrange them in a matrix where each row represents a sequence and columns represent homologous positions. The alignment must optimize some scoring function that reflects biological reality while handling sequences of different lengths, managing gaps that represent insertion/deletion events, and maintaining computational feasibility even as the number of sequences grows.</p>
<p>The computational complexity of this problem escalates dramatically with the number of sequences. While dynamic programming provides an exact solution for pairwise alignment in O(n²) time for sequences of length n, the extension to k sequences requires O(nᵏ) time and space—quickly becoming intractable even for modest numbers of sequences. This exponential growth has driven the development of numerous heuristic approaches that trade optimality guarantees for computational feasibility, each with its own strengths, weaknesses, and underlying assumptions about sequence evolution.</p>
</section>
<section id="the-computational-complexity-problem" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="the-computational-complexity-problem">The Computational Complexity Problem</h2>
<section id="theoretical-foundations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="theoretical-foundations">Theoretical Foundations</h3>
<p>The multiple sequence alignment problem can be formally defined as follows: given k sequences S₁, S₂, …, Sₖ over an alphabet Σ (typically 4 nucleotides or 20 amino acids), find an alignment that maximizes a scoring function. An alignment extends each sequence by inserting gaps (-) such that all resulting sequences have the same length, and the score is typically the sum of all pairwise scores (sum-of-pairs) or the score relative to a consensus sequence.</p>
<p>The exact solution using dynamic programming extends the Needleman-Wunsch algorithm to k dimensions. For k sequences of length n, we construct a k-dimensional matrix where each cell (i₁, i₂, …, iₖ) represents the optimal alignment of prefixes S₁[1..i₁], S₂[1..i₂], …, Sₖ[1..iₖ]. Each cell must consider 2ᵏ - 1 possible predecessors (corresponding to all possible combinations of gap/residue for each sequence, excluding the all-gap case), leading to the time complexity:</p>
<p><span class="math display">\[T(n,k) = O(2^k \cdot n^k)\]</span></p>
<p>The space complexity is similarly prohibitive:</p>
<p><span class="math display">\[S(n,k) = O(n^k)\]</span></p>
<p>For just 10 sequences of length 100, this would require 10²⁰ cells—far beyond the capacity of any conceivable computer. Even with optimizations like linear space algorithms that reduce space complexity to O(kn²), the time complexity remains exponential in the number of sequences.</p>
</section>
<section id="np-completeness" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="np-completeness">NP-Completeness</h3>
<p>Wang and Jiang proved in 1994 that multiple sequence alignment under the sum-of-pairs (SP) scoring scheme is NP-complete. This means that unless P = NP, no polynomial-time algorithm exists for finding optimal multiple alignments. The proof involves a reduction from the shortest common supersequence problem, itself known to be NP-complete.</p>
<p>The NP-completeness of MSA has profound implications. It means that as we add more sequences to our alignment problem, the computational difficulty doesn’t just increase—it increases exponentially. This theoretical barrier has shaped the entire field of multiple alignment, driving researchers to develop increasingly sophisticated heuristics rather than pursuing exact solutions.</p>
<p>Even seemingly simple variations of the problem remain computationally hard. The star alignment problem (aligning all sequences to a central sequence), the tree alignment problem (aligning sequences according to a phylogenetic tree), and the consensus alignment problem all belong to the class of NP-hard problems. This universality of computational difficulty suggests that the complexity is inherent to the biological problem itself, not merely an artifact of our mathematical formulation.</p>
</section>
<section id="scoring-functions-and-objective-complexity" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="scoring-functions-and-objective-complexity">Scoring Functions and Objective Complexity</h3>
<p>The choice of scoring function adds another layer of complexity to the MSA problem. The most common approaches include:</p>
<p><strong>Sum-of-Pairs (SP) Score</strong>: The total score is the sum of scores for all pairwise alignments within the multiple alignment. For k sequences, this involves k(k-1)/2 pairwise comparisons. While intuitive, the SP score treats all sequence pairs equally, ignoring evolutionary relationships. It also suffers from the problem of overcounting: a single evolutionary event (like an insertion) gets penalized multiple times in all affected pairwise comparisons.</p>
<p><strong>Tree-Based Scores</strong>: These scores weight sequence comparisons according to a phylogenetic tree, giving more importance to distant evolutionary relationships. While biologically more realistic, tree-based scoring requires knowing or estimating the phylogenetic tree, adding another computational challenge.</p>
<p><strong>Consensus Scores</strong>: The alignment is scored against a consensus sequence representing the “average” or most likely ancestral sequence. This approach can be more efficient computationally but may not capture all evolutionary information.</p>
<p><strong>Information-Theoretic Scores</strong>: These measure the information content or entropy of alignment columns, favoring alignments that create highly conserved columns. While elegant theoretically, these scores can be difficult to optimize and may not always correspond to biological reality.</p>
<p>Each scoring scheme embodies different assumptions about sequence evolution and conservation, and no single approach is optimal for all situations. This multiplicity of objective functions further complicates the already challenging optimization problem.</p>
</section>
</section>
<section id="progressive-alignment-the-dominant-paradigm" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="progressive-alignment-the-dominant-paradigm">Progressive Alignment: The Dominant Paradigm</h2>
<section id="the-progressive-strategy" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-progressive-strategy">The Progressive Strategy</h3>
<p>Progressive alignment, introduced by Feng and Doolittle in 1987 and popularized by programs like ClustalW, has become the dominant approach for multiple sequence alignment due to its reasonable balance between speed and accuracy. The strategy builds a multiple alignment incrementally by first aligning the most similar sequences and progressively adding more distant sequences or groups of sequences.</p>
<p>The progressive approach typically follows these steps:</p>
<ol type="1">
<li><p><strong>Calculate pairwise distances</strong>: Compute similarity scores between all pairs of sequences, usually using rapid pairwise alignment or k-mer based methods.</p></li>
<li><p><strong>Construct a guide tree</strong>: Build a phylogenetic tree (usually using UPGMA or neighbor-joining) that represents the evolutionary relationships among sequences.</p></li>
<li><p><strong>Progressive alignment</strong>: Starting from the leaves of the tree, align sequences or groups following the branching order, working toward the root.</p></li>
</ol>
<p>The key insight is that closely related sequences are easier to align accurately, and these initial alignments can guide the incorporation of more distant sequences. By following the evolutionary hierarchy, progressive alignment attempts to preserve the most reliable homology relationships first.</p>
</section>
<section id="mathematical-framework" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mathematical-framework">Mathematical Framework</h3>
<p>The progressive alignment score can be formulated recursively. Let A(X) represent an alignment of sequence set X, and S(A₁, A₂) represent the score of aligning two alignments. For a tree T with children nodes c₁ and c₂ of node v:</p>
<p><span class="math display">\[Score(v) = Score(c_1) + Score(c_2) + S(A(c_1), A(c_2))\]</span></p>
<p>The alignment at each internal node combines the alignments of its children using a profile-to-profile alignment algorithm. A profile represents the frequency of each residue (or gap) at each position in an alignment:</p>
<p><span class="math display">\[P_{ij} = \frac{count(residue_j \text{ at position } i)}{number \text{ of sequences}}\]</span></p>
<p>Profile alignment extends pairwise alignment by scoring position pairs using the weighted sum of all possible residue pair scores:</p>
<p><span class="math display">\[S(P_1[i], P_2[j]) = \sum_{a \in \Sigma} \sum_{b \in \Sigma} P_1[i][a] \cdot P_2[j][b] \cdot s(a,b)\]</span></p>
<p>where s(a,b) is the substitution score between residues a and b.</p>
</section>
<section id="advantages-of-progressive-alignment" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="advantages-of-progressive-alignment">Advantages of Progressive Alignment</h3>
<p>Progressive alignment offers several compelling advantages that explain its widespread adoption:</p>
<p><strong>Computational Efficiency</strong>: The time complexity is approximately O(k²n²) for k sequences of length n—polynomial rather than exponential. This makes it feasible to align hundreds or even thousands of sequences on standard computers.</p>
<p><strong>Biological Intuition</strong>: The approach mirrors the evolutionary process, first grouping closely related sequences that share recent common ancestry. This biological grounding often leads to meaningful alignments even when the mathematical optimum might be biologically incorrect.</p>
<p><strong>Scalability</strong>: Progressive methods can handle large datasets that would be impossible for exact algorithms. Modern implementations can align thousands of sequences in reasonable time.</p>
<p><strong>Flexibility</strong>: The framework accommodates various scoring schemes, gap penalties, and substitution matrices. It can be adapted for DNA, protein, or even RNA structural alignments.</p>
</section>
</section>
<section id="the-greedy-nature-and-its-shortcomings" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="the-greedy-nature-and-its-shortcomings">The Greedy Nature and Its Shortcomings</h2>
<section id="the-fundamental-limitation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-fundamental-limitation">The Fundamental Limitation</h3>
<p>Progressive alignment is inherently a greedy algorithm—it makes locally optimal choices at each step without the ability to reconsider previous decisions. Once two sequences or groups are aligned, their relative positioning is fixed for all subsequent steps. This “once a gap, always a gap” principle means that errors introduced early in the process propagate and potentially amplify as more sequences are added.</p>
<p>Consider a simple example: suppose sequences A and B are aligned first, introducing a gap in sequence A at position 10. When sequence C is added later, it might align better if the gap in A were at position 11, but this adjustment is impossible within the progressive framework. The alignment of A and B is frozen, forcing C to accommodate their potentially suboptimal arrangement.</p>
</section>
<section id="error-propagation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="error-propagation">Error Propagation</h3>
<p>The progressive strategy’s greatest weakness is its susceptibility to error propagation. Mistakes made in early alignment stages cannot be corrected later, and these errors tend to accumulate and magnify as the alignment grows. Several factors contribute to this problem:</p>
<p><strong>Incorrect Guide Tree</strong>: The initial phylogenetic tree is based on rough pairwise distances, often computed using fast but approximate methods. If this tree incorrectly groups sequences, the entire alignment follows this flawed evolutionary hypothesis. For instance, if two divergent sequences happen to share a rare similarity and are incorrectly grouped as close relatives, their alignment will be fixed early and force all other sequences to accommodate this error.</p>
<p><strong>Local Minima</strong>: The greedy approach can easily become trapped in local minima—alignments that cannot be improved by small modifications but are far from the global optimum. Unlike optimization algorithms that can escape local minima through techniques like simulated annealing or genetic algorithms, progressive alignment has no mechanism for backtracking or exploring alternative alignment paths.</p>
<p><strong>Distance Effects</strong>: Sequences added later in the progressive process must align to increasingly large and rigid profiles. Distant sequences, added near the root of the tree, have the least flexibility in their placement, even though these are precisely the sequences where alignment uncertainty is highest.</p>
</section>
<section id="the-indel-problem" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="the-indel-problem">The Indel Problem</h3>
<p>One of the most serious issues with progressive alignment is its tendency to accumulate and retain insertions and deletions (indels). This problem manifests in several ways:</p>
<p><strong>Gap Attraction</strong>: Once a gap is introduced in an alignment, it tends to attract additional gaps in subsequently added sequences. This occurs because aligning a residue with an existing gap column often scores better than creating a new gap elsewhere. The result is an artificial clustering of gaps that may not reflect the true evolutionary history of insertions and deletions.</p>
<p><strong>Gap Persistence</strong>: Gaps introduced early in the progressive process cannot be removed or repositioned, even if later sequences suggest a different gap placement would be more parsimonious. This rigidity leads to alignments with more gaps than necessary, reducing both accuracy and interpretability.</p>
<p><strong>Inconsistent Gap Penalties</strong>: When aligning profiles, the effective gap penalty differs from that used in the initial pairwise alignments. A gap in a profile represents gaps in multiple sequences, but profile alignment methods typically don’t fully account for this multiplicity. This inconsistency can lead to either excessive gap introduction or inappropriate gap extension.</p>
<p><strong>Terminal Gap Ambiguity</strong>: Progressive methods often struggle with terminal gaps (gaps at sequence ends). Different treatment of terminal gaps during pairwise alignment versus profile alignment can create inconsistent gap patterns that don’t reflect biological reality.</p>
</section>
<section id="mathematical-analysis-of-error-accumulation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mathematical-analysis-of-error-accumulation">Mathematical Analysis of Error Accumulation</h3>
<p>The error accumulation in progressive alignment can be modeled mathematically. Let ε be the probability of making an alignment error at each node of the guide tree. For a balanced binary tree with k sequences, the tree height is log₂(k). The probability of at least one error in the path from leaf to root is:</p>
<p><span class="math display">\[P(error) = 1 - (1 - \varepsilon)^{\log_2(k)}\]</span></p>
<p>For small ε, this approximates to:</p>
<p><span class="math display">\[P(error) \approx \varepsilon \cdot \log_2(k)\]</span></p>
<p>This logarithmic growth of error probability with sequence number might seem modest, but it represents a lower bound. In practice, errors compound because each misalignment affects the profile used for subsequent alignments. If we consider error propagation where each error increases the probability of future errors by a factor α &gt; 1, the error growth becomes:</p>
<p><span class="math display">\[P(error) \approx 1 - e^{-\varepsilon \cdot \alpha^{\log_2(k)}}\]</span></p>
<p>This shows potential for rapid error accumulation, especially when aligning divergent sequences where ε is substantial.</p>
</section>
</section>
<section id="popular-heuristic-multiple-alignment-tools" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="popular-heuristic-multiple-alignment-tools">Popular Heuristic Multiple Alignment Tools</h2>
<section id="clustalw-and-clustal-omega" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="clustalw-and-clustal-omega">ClustalW and Clustal Omega</h3>
<p>ClustalW, published by Thompson, Higgins, and Gibson in 1994, became the most widely used multiple alignment program in bioinformatics history. Its success stems from several key innovations:</p>
<p><strong>Position-Specific Gap Penalties</strong>: ClustalW adjusts gap penalties based on local sequence characteristics. Gaps are discouraged in hydrophobic regions (likely to be buried in protein cores) and within secondary structures, while being more permissive in hydrophilic loops. The gap opening penalty at position i is modified by:</p>
<p><span class="math display">\[GOP_i = GOP \times (1 + |log(N_i/N_{avg})|) \times SS_i \times HF_i\]</span></p>
<p>where N_i is the number of sequences with a gap at position i, SS_i is a secondary structure factor, and HF_i is a hydrophobicity factor.</p>
<p><strong>Sequence Weighting</strong>: To correct for uneven sampling of sequence space, ClustalW weights sequences based on their uniqueness. Sequences from densely sampled clades receive lower weights, preventing them from dominating the alignment. The weight for sequence i is:</p>
<p><span class="math display">\[W_i = \sum_{j \in path\_to\_root} \frac{1}{n_j}\]</span></p>
<p>where n_j is the number of branches at node j.</p>
<p><strong>Dynamic Selection of Substitution Matrix</strong>: The program selects different substitution matrices based on sequence similarity. For closely related sequences, it uses matrices optimized for high identity (like BLOSUM80), while switching to matrices for distant relationships (like BLOSUM45) for divergent sequences.</p>
<p>Clustal Omega, released in 2011, represents a complete reimplementation designed for the genomic era. It replaces the O(k²) guide tree construction with an O(k log k) algorithm using mBed embeddings, enabling alignment of hundreds of thousands of sequences. The program also uses HMM-based profile-profile alignment for improved accuracy.</p>
</section>
<section id="muscle" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="muscle">MUSCLE</h3>
<p>MUSCLE (Multiple Sequence Comparison by Log-Expectation), developed by Robert Edgar in 2004, introduced an iterative refinement approach that addresses some limitations of purely progressive methods:</p>
<p><strong>Three-Stage Strategy</strong>: 1. Draft progressive alignment using k-mer distances 2. Improved progressive alignment using distances from the draft alignment 3. Iterative refinement by subdividing and realigning</p>
<p><strong>Tree-Dependent Partitioning</strong>: MUSCLE cuts the guide tree into two subtrees, realigns the resulting profiles, and accepts the new alignment if it improves the score. This process iterates through different tree edges:</p>
<p><span class="math display">\[Score_{new} = \sum_{i,j} w_{ij} \cdot SP(seq_i, seq_j)_{new}\]</span></p>
<p>where w_ij weights pairs based on their tree distance.</p>
<p><strong>Log-Expectation Scores</strong>: MUSCLE uses log-expectation scores that account for evolutionary distance:</p>
<p><span class="math display">\[LE = log(\sum_{a,b} p_a \cdot p_b \cdot e^{s(a,b)/\lambda})\]</span></p>
<p>This scoring better handles distantly related sequences compared to traditional sum-of-pairs scores.</p>
</section>
<section id="mafft" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mafft">MAFFT</h3>
<p>MAFFT (Multiple Alignment using Fast Fourier Transform) by Katoh et al.&nbsp;(2002) offers multiple alignment strategies with different speed-accuracy trade-offs:</p>
<p><strong>FFT for Rapid Homology Detection</strong>: MAFFT converts amino acid sequences to numeric vectors based on volume and polarity, then uses FFT to rapidly identify homologous regions:</p>
<p><span class="math display">\[correlation(i) = FFT^{-1}[FFT(v_1) \times \overline{FFT(v_2)}]\]</span></p>
<p>This approach is approximately 100 times faster than dynamic programming for identifying similar segments.</p>
<p><strong>Consistency-Based Refinement</strong>: The G-INS-i and L-INS-i methods incorporate consistency information from all pairwise alignments. If residue a from sequence x aligns with residue b from sequence y, and b aligns with residue c from sequence z, then a and c should be aligned. This is formulated as:</p>
<p><span class="math display">\[C(a,c) = \sum_{b} P(a \sim b) \cdot P(b \sim c)\]</span></p>
<p>where P denotes alignment probability.</p>
<p><strong>Structural Information Integration</strong>: MAFFT can incorporate structural alignments when available, using them to anchor the sequence alignment and improve accuracy in structurally conserved regions.</p>
</section>
<section id="t-coffee-and-consistency-based-methods" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="t-coffee-and-consistency-based-methods">T-Coffee and Consistency-Based Methods</h3>
<p>T-Coffee (Tree-based Consistency Objective Function for alignment Evaluation) by Notredame et al.&nbsp;(2000) pioneered the consistency-based approach to multiple alignment:</p>
<p><strong>Primary Library Construction</strong>: T-Coffee builds a library of pairwise alignments using both global (ClustalW) and local (LALIGN) methods. Each aligned residue pair receives a weight based on sequence identity:</p>
<p><span class="math display">\[w(a_i, b_j) = \frac{identity(A,B)}{100} \times 100\]</span></p>
<p><strong>Library Extension</strong>: The crucial innovation is extending the library through consistency:</p>
<p><span class="math display">\[w'(a_i, b_j) = w(a_i, b_j) + \sum_{k \neq i,j} min(w(a_i, c_k), w(c_k, b_j))\]</span></p>
<p>This triplet approach ensures that alignments consistent across multiple sequences receive higher weights.</p>
<p><strong>Progressive Alignment with Extended Library</strong>: The final alignment uses progressive alignment but scores positions using the extended library weights rather than a substitution matrix.</p>
</section>
<section id="prank-and-phylogeny-aware-methods" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="prank-and-phylogeny-aware-methods">PRANK and Phylogeny-Aware Methods</h3>
<p>PRANK (Probabilistic Alignment Kit) by Löytynoja and Goldman (2005) explicitly models insertions and deletions in an evolutionary framework:</p>
<p><strong>Phylogenetic Placement of Indels</strong>: PRANK distinguishes between insertions and deletions by considering the phylogenetic tree. A gap pattern is evaluated for its evolutionary parsimony:</p>
<p><span class="math display">\[P(gap\_pattern | tree) = \prod_{branches} P(indel\_events\_on\_branch)\]</span></p>
<p><strong>Avoiding False Homology</strong>: Traditional aligners tend to align non-homologous sequence by inserting gaps elsewhere. PRANK maintains permanent gaps for true deletions, preventing incorrect alignment of inserted sequences with non-homologous regions.</p>
<p><strong>Character Distinction</strong>: The algorithm treats insertions and deletions as distinct evolutionary events, not just generic gaps. This distinction is crucial for accurate phylogenetic inference and evolutionary rate estimation.</p>
</section>
</section>
<section id="advanced-methodologies-and-algorithmic-innovations" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="advanced-methodologies-and-algorithmic-innovations">Advanced Methodologies and Algorithmic Innovations</h2>
<section id="iterative-refinement-strategies" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="iterative-refinement-strategies">Iterative Refinement Strategies</h3>
<p>Iterative refinement attempts to escape the local minima inherent to progressive alignment. These methods repeatedly modify an existing alignment to improve its score:</p>
<p><strong>Barton-Sternberg Algorithm</strong>: One of the earliest refinement methods, it removes each sequence from the alignment and realigns it to the profile of remaining sequences. If the new alignment scores better, it’s accepted:</p>
<p><span class="math display">\[\Delta Score = Score(align(seq_i, profile_{-i})) - Score(original)\]</span></p>
<p><strong>Genetic Algorithms</strong>: Some tools use evolutionary computation to explore alignment space. SAGA (Sequence Alignment by Genetic Algorithm) represents alignments as individuals in a population, using crossover and mutation operators: - Crossover: Exchange aligned blocks between alignments - Mutation: Shift gaps, merge adjacent gaps, or split gap regions - Selection: Retain alignments with better scores</p>
<p>The population evolves toward better alignments, potentially escaping local minima that trap greedy methods.</p>
<p><strong>Simulated Annealing</strong>: This approach accepts worse alignments with probability:</p>
<p><span class="math display">\[P(accept) = e^{-\Delta Score / T}\]</span></p>
<p>where T is a temperature parameter that decreases over time. Early iterations explore broadly, while later iterations converge to a local optimum.</p>
</section>
<section id="hidden-markov-models-and-statistical-approaches" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="hidden-markov-models-and-statistical-approaches">Hidden Markov Models and Statistical Approaches</h3>
<p>Profile Hidden Markov Models (HMMs) provide a probabilistic framework for multiple alignment:</p>
<p><strong>Model Structure</strong>: A profile HMM consists of: - Match states (M): Emit residues according to position-specific distributions - Insert states (I): Model insertions relative to the consensus - Delete states (D): Silent states representing deletions</p>
<p><strong>Parameter Estimation</strong>: Given unaligned sequences, the Baum-Welch algorithm estimates:</p>
<p><span class="math display">\[\theta^{(t+1)} = \arg\max_\theta \sum_i P(seq_i | \theta^{(t)}) \log P(seq_i | \theta)\]</span></p>
<p><strong>Alignment via Viterbi</strong>: Once trained, the Viterbi algorithm finds the most probable alignment:</p>
<p><span class="math display">\[\pi^* = \arg\max_\pi P(\pi | seq, \theta)\]</span></p>
<p>HMM-based methods like HMMER naturally handle position-specific scoring and provide probabilistic measures of alignment confidence.</p>
</section>
<section id="consensus-and-meta-methods" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="consensus-and-meta-methods">Consensus and Meta-Methods</h3>
<p>Meta-methods combine multiple alignments to leverage the strengths of different approaches:</p>
<p><strong>M-Coffee</strong>: Extends T-Coffee by combining alignments from multiple programs:</p>
<p><span class="math display">\[w_{combined}(a_i, b_j) = \sum_{method} \alpha_{method} \cdot w_{method}(a_i, b_j)\]</span></p>
<p>where α weights reflect method reliability.</p>
<p><strong>MergeAlign</strong>: Uses a graph-based approach where each alignment contributes edges to a consistency graph. The final alignment maximizes edge weights while maintaining transitivity.</p>
<p><strong>Column Score Comparison</strong>: Some methods identify reliably aligned columns by comparing alignments:</p>
<p><span class="math display">\[Confidence(column_i) = \frac{|\{alignments\_with\_same\_column\}|}{total\_alignments}\]</span></p>
<p>Only high-confidence columns are retained in the consensus.</p>
</section>
<section id="structure-based-and-domain-aware-alignment" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="structure-based-and-domain-aware-alignment">Structure-Based and Domain-Aware Alignment</h3>
<p>When structural information is available, it can dramatically improve alignment accuracy:</p>
<p><strong>3D-Coffee</strong>: Incorporates structural alignments using programs like SAP or MUSTANG. Structure-based scores override sequence-based scores in structurally conserved regions:</p>
<p><span class="math display">\[Score_{combined} = \beta \cdot Score_{structure} + (1-\beta) \cdot Score_{sequence}\]</span></p>
<p>where β reflects confidence in structural alignment.</p>
<p><strong>Domain Architecture</strong>: Programs like PRALINE recognize domain boundaries and align domains independently: 1. Identify domains using databases like Pfam 2. Align domains separately 3. Assemble full alignment respecting domain boundaries</p>
<p>This approach prevents incorrect alignment across domain boundaries, a common source of errors in traditional methods.</p>
</section>
</section>
<section id="computational-optimizations-and-scalability" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="computational-optimizations-and-scalability">Computational Optimizations and Scalability</h2>
<section id="algorithmic-improvements" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="algorithmic-improvements">Algorithmic Improvements</h3>
<p>Modern alignment programs employ numerous optimizations to handle large-scale data:</p>
<p><strong>Banded Dynamic Programming</strong>: For similar sequences, limit computation to a diagonal band:</p>
<p><span class="math display">\[|i - j| \leq bandwidth\]</span></p>
<p>This reduces complexity from O(n²) to O(n × bandwidth).</p>
<p><strong>Anchor Points</strong>: Identify highly conserved regions as anchors, then align between anchors: 1. Find exact matches or high-scoring segment pairs 2. Chain anchors consistently 3. Align regions between anchors</p>
<p>This divide-and-conquer approach significantly reduces computation for long sequences.</p>
<p><strong>Sparse Dynamic Programming</strong>: Store only cells that might contribute to the optimal path, reducing memory from O(n²) to O(n) in favorable cases.</p>
</section>
<section id="parallelization-strategies" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="parallelization-strategies">Parallelization Strategies</h3>
<p>Multiple alignment is amenable to various parallelization approaches:</p>
<p><strong>Pairwise Distance Calculation</strong>: Computing k(k-1)/2 pairwise distances is embarrassingly parallel:</p>
<pre><code>parallel_for each pair (i,j):
    distance[i][j] = compute_distance(seq[i], seq[j])</code></pre>
<p><strong>Guide Tree Parallelization</strong>: Different subtrees can be aligned independently:</p>
<pre><code>parallel_for each subtree:
    align_subtree(node)
wait_for_children()
merge_alignments()</code></pre>
<p><strong>Profile-Profile Alignment</strong>: Dynamic programming cells along anti-diagonals can be computed in parallel:</p>
<p><span class="math display">\[cell[i][j] = f(cell[i-1][j], cell[i][j-1], cell[i-1][j-1])\]</span></p>
<p>Modern tools like Clustal Omega and MAFFT exploit multi-core architectures and SIMD instructions for substantial speedups.</p>
</section>
<section id="memory-efficient-implementations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="memory-efficient-implementations">Memory-Efficient Implementations</h3>
<p>Large-scale alignments require careful memory management:</p>
<p><strong>Linear Space Alignment</strong>: Using Hirschberg’s algorithm, compute alignments in O(n) space by recursively dividing the problem: 1. Find midpoint of optimal path 2. Recursively align two subproblems 3. Concatenate results</p>
<p><strong>Compressed Profiles</strong>: Store profiles using reduced alphabets or clustering similar residues:</p>
<p><span class="math display">\[P_{compressed}[i] = cluster(P_{original}[i])\]</span></p>
<p><strong>External Memory Algorithms</strong>: For massive datasets, use disk-based storage with careful I/O optimization: - B-tree indices for sequence access - Memory-mapped files for profiles - Compressed sequence representation</p>
</section>
</section>
<section id="validation-quality-assessment-and-best-practices" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="validation-quality-assessment-and-best-practices">Validation, Quality Assessment, and Best Practices</h2>
<section id="alignment-quality-metrics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="alignment-quality-metrics">Alignment Quality Metrics</h3>
<p>Assessing alignment quality without knowing the true alignment is challenging but crucial:</p>
<p><strong>Column Confidence Scores</strong>: Programs like TCS (Transitive Consistency Score) measure how consistently a column is aligned across different methods:</p>
<p><span class="math display">\[TCS(column) = \frac{\sum_{triplets} consistency(triplet)}{total\_triplets}\]</span></p>
<p><strong>Sum-of-Pairs Score</strong>: The total score of all pairwise alignments within the MSA:</p>
<p><span class="math display">\[SP = \sum_{i&lt;j} score(seq_i, seq_j)\]</span></p>
<p>While easy to compute, SP scores can be misleading for divergent sequences.</p>
<p><strong>Information Content</strong>: Measures conservation using Shannon entropy:</p>
<p><span class="math display">\[IC(column) = 2 - H(column) = 2 + \sum_{a} p_a \log_2(p_a)\]</span></p>
<p>High information content indicates strong conservation.</p>
<p><strong>Normed Discrepancy</strong>: Compares an alignment to a reference or expected distribution:</p>
<p><span class="math display">\[ND = \frac{|observed - expected|}{expected}\]</span></p>
</section>
<section id="benchmark-datasets-and-validation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="benchmark-datasets-and-validation">Benchmark Datasets and Validation</h3>
<p>Several benchmark databases enable objective comparison of alignment methods:</p>
<p><strong>BAliBASE</strong>: Manually curated structural alignments covering various alignment challenges: - RV11: Equidistant sequences with &lt;20% identity - RV12: Families with &gt;35% identity - RV20: Families with large insertions - RV30: Subgroups with &lt;25% between-group identity - RV40: Sequences with large terminal extensions - RV50: Sequences with internal insertions</p>
<p><strong>PREFAB</strong>: Large-scale benchmark with 1,932 alignments based on structural pairs.</p>
<p><strong>OXBench</strong>: Focuses on challenging cases with low sequence identity.</p>
<p>Performance metrics include: - Sum-of-pairs score (SPS): Fraction of correctly aligned residue pairs - Column score (CS): Fraction of correctly aligned columns - Total column score (TCS): Considers partial column correctness</p>
</section>
<section id="best-practices-and-recommendations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="best-practices-and-recommendations">Best Practices and Recommendations</h3>
<p><strong>Sequence Selection</strong>: - Remove redundant sequences (&gt;90% identity) to avoid bias - Include sequences across the full taxonomic range - Ensure sufficient sequence diversity for meaningful patterns - Check for frameshifts and sequencing errors</p>
<p><strong>Method Selection</strong>: - For &lt;50 sequences with high similarity: ClustalW or MUSCLE - For large datasets (&gt;1000 sequences): Clustal Omega or MAFFT (FFT-NS-2) - For high accuracy with &lt;200 sequences: MAFFT (L-INS-i) or T-Coffee - For phylogeny-aware alignment: PRANK or PAGAN - When structure is available: 3D-Coffee or Expresso</p>
<p><strong>Parameter Optimization</strong>: - Test different gap penalties for your sequence family - Consider secondary structure and solvent accessibility - Adjust substitution matrices based on sequence divergence - Use iterative refinement for improved accuracy</p>
<p><strong>Quality Control</strong>: - Visually inspect alignments for obvious errors - Check for excessive gaps or fragmented alignments - Compare results from multiple methods - Use consistency-based confidence scores - Validate against structural data when available</p>
</section>
</section>
<section id="future-directions-and-emerging-challenges" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="future-directions-and-emerging-challenges">Future Directions and Emerging Challenges</h2>
<section id="machine-learning-and-deep-learning-approaches" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="machine-learning-and-deep-learning-approaches">Machine Learning and Deep Learning Approaches</h3>
<p>Recent advances in deep learning are beginning to impact multiple sequence alignment:</p>
<p><strong>Neural Network Scoring Functions</strong>: Deep networks can learn complex scoring functions from large databases of verified alignments:</p>
<p><span class="math display">\[Score_{NN} = f_{neural}(sequence\_features, structural\_features)\]</span></p>
<p>These learned functions can capture patterns that escape traditional substitution matrices.</p>
<p><strong>Attention Mechanisms</strong>: Transformer architectures, successful in language modeling, show promise for capturing long-range dependencies in sequences:</p>
<p><span class="math display">\[Attention(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}})V\]</span></p>
<p>This could better model coevolution and functional constraints.</p>
<p><strong>Reinforcement Learning</strong>: Treating alignment as a sequential decision problem, RL agents can learn optimal alignment strategies:</p>
<p><span class="math display">\[\pi^*(s) = \arg\max_a Q^*(s,a)\]</span></p>
<p>where states represent partial alignments and actions are alignment operations.</p>
</section>
<section id="integration-with-structural-prediction" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="integration-with-structural-prediction">Integration with Structural Prediction</h3>
<p>The AlphaFold revolution in protein structure prediction creates new opportunities:</p>
<p><strong>Structure-Guided Alignment</strong>: Use predicted structures to inform sequence alignment: 1. Predict structures for all sequences 2. Perform structural superposition 3. Derive sequence alignment from structural alignment</p>
<p><strong>Coevolution and Contact Prediction</strong>: MSAs reveal coevolving positions that are often in physical contact:</p>
<p><span class="math display">\[MI(i,j) = \sum_{a,b} P(a_i, b_j) \log\frac{P(a_i, b_j)}{P(a_i)P(b_j)}\]</span></p>
<p>These signals can both improve alignment and predict structure.</p>
</section>
<section id="handling-big-data-and-genomic-scales" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="handling-big-data-and-genomic-scales">Handling Big Data and Genomic Scales</h3>
<p>The explosion of sequencing data presents new challenges:</p>
<p><strong>Streaming Algorithms</strong>: Process sequences as they arrive without storing entire datasets:</p>
<pre><code>for each new_sequence:
    find_best_position(new_sequence, current_alignment)
    update_alignment_incrementally()</code></pre>
<p><strong>Approximate Methods</strong>: Trade exact solutions for scalability: - Locality-sensitive hashing for similar sequence detection - Sketching algorithms for distance estimation - Sampling-based approaches for large families</p>
<p><strong>Cloud and Distributed Computing</strong>: Leverage cloud infrastructure for massive alignments: - MapReduce for pairwise distance calculation - Distributed graph algorithms for guide tree construction - Federated learning for privacy-preserving alignment</p>
</section>
<section id="specialized-applications" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="specialized-applications">Specialized Applications</h3>
<p>Multiple alignment continues to evolve for specific biological problems:</p>
<p><strong>Viral Quasispecies</strong>: Align highly similar sequences with rare variations: - Distinguish true variants from sequencing errors - Track evolution within hosts - Identify drug resistance mutations</p>
<p><strong>Metagenomics</strong>: Align sequences from multiple organisms: - Handle varying abundance levels - Separate strain-level variations - Account for horizontal gene transfer</p>
<p><strong>Long-Read Alignment</strong>: Adapt methods for third-generation sequencing: - Handle higher error rates - Exploit long-range information - Integrate with genome assembly</p>
<p><strong>RNA Structure</strong>: Incorporate secondary structure into alignment: - Simultaneous alignment and folding - Covariation analysis for structure prediction - Pseudoknot-aware alignment</p>
</section>
</section>
<section id="conclusion" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Multiple sequence alignment remains a central challenge in computational biology, embodying the tension between biological complexity and computational tractability. The NP-completeness of the problem ensures that exact solutions remain out of reach for all but the smallest datasets, making heuristic approaches not just practical alternatives but essential tools.</p>
<p>The dominance of progressive alignment, despite its well-understood limitations, reflects a pragmatic balance between speed, accuracy, and biological intuition. The greedy nature of these algorithms, while theoretically suboptimal, often produces biologically meaningful results by following evolutionary relationships. However, the tendency to accumulate and retain errors, particularly in gap placement, remains a significant challenge that no current method fully resolves.</p>
<p>The proliferation of alignment methods—from the venerable ClustalW to modern tools like MAFFT and T-Coffee—reflects the diversity of biological problems and the impossibility of a one-size-fits-all solution. Each method embodies different trade-offs between speed and accuracy, different assumptions about sequence evolution, and different strategies for handling the fundamental challenges of multiple alignment.</p>
<p>Looking forward, the field stands at an exciting juncture. The integration of machine learning approaches promises to capture complex patterns that escape current methods. The availability of predicted structures for most proteins opens new avenues for structure-guided alignment. The continued explosion of sequence data demands ever more efficient algorithms while maintaining or improving accuracy.</p>
<p>Yet fundamental challenges remain. The treatment of insertions and deletions, the handling of repetitive and low-complexity regions, the alignment of highly divergent sequences, and the integration of various types of biological information all present ongoing research opportunities. The multiple sequence alignment problem, far from being solved, continues to evolve with our understanding of molecular evolution and our computational capabilities.</p>
<p>The story of multiple sequence alignment is ultimately one of creative compromise—between optimal and feasible, between general and specific, between automated and manual. As we continue to push the boundaries of what’s computationally possible and biologically meaningful, multiple sequence alignment will remain at the heart of comparative genomics, structural biology, and our understanding of molecular evolution. The next generation of methods will need to balance ever-increasing data scales with the need for accurate, interpretable alignments that capture the complex evolutionary relationships among sequences.</p>
<p>The continuing citation success of tools like ClustalW, decades after their publication, testament not just to their utility but to the fundamental importance of multiple sequence alignment in modern biology. As we enter an era of population-scale genomics and routine structural prediction, the ancient problem of arranging sequences to reveal their evolutionary relationships remains as relevant and challenging as ever.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../chapters/bioinformatics/pairwise_alignment.html" class="pagination-link" aria-label="Pairwise Alignment">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Pairwise Alignment</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/project/alignment_project/index.html" class="pagination-link" aria-label="Pairwise alignment">
        <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Pairwise alignment</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>